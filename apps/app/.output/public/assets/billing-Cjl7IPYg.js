import{r as a,s as R,f as x,n as C,h as m,i as b,j as l}from"./main-DJAnHGiT.js";import{fW as _,fX as y}from"./button-BDX-2Pnw.js";import{Q as v}from"./queryObserver-BnkVCiPn.js";var d=a.createContext(!1),q=()=>a.useContext(d);d.Provider;function M(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Q=a.createContext(M()),T=()=>a.useContext(Q),w=(e,s)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(s.isReset()||(e.retryOnMount=!1))},I=e=>{a.useEffect(()=>{e.clearReset()},[e])},N=({result:e,errorResetBoundary:s,throwOnError:u,query:t,suspense:n})=>e.isError&&!s.isReset()&&!e.isFetching&&t&&(n&&e.data===void 0||R(u,[e.error,t])),O=e=>{if(e.suspense){const u=n=>n==="static"?n:Math.max(n??1e3,1e3),t=e.staleTime;e.staleTime=typeof t=="function"?(...n)=>u(t(...n)):u(t),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},j=(e,s)=>e.isLoading&&e.isFetching&&!s,B=(e,s)=>e?.suspense&&s.isPending,g=(e,s,u)=>s.fetchOptimistic(e).catch(()=>{u.clearReset()});function P(e,s,u){const t=q(),n=T(),o=x(),r=o.defaultQueryOptions(e);o.getDefaultOptions().queries?._experimental_beforeQuery?.(r),r._optimisticResults=t?"isRestoring":"optimistic",O(r),w(r,n),I(n);const E=!o.getQueryCache().get(r.queryHash),[i]=a.useState(()=>new s(o,r)),c=i.getOptimisticResult(r),f=!t&&e.subscribed!==!1;if(a.useSyncExternalStore(a.useCallback(h=>{const S=f?i.subscribe(C.batchCalls(h)):m;return i.updateResult(),S},[i,f]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),a.useEffect(()=>{i.setOptions(r)},[r,i]),B(r,c))throw g(r,i,n);if(N({result:c,errorResetBoundary:n,throwOnError:r.throwOnError,query:o.getQueryCache().get(r.queryHash),suspense:r.suspense}))throw c.error;return o.getDefaultOptions().queries?._experimental_afterQuery?.(r,c),r.experimental_prefetchInRender&&!b&&j(c,t)&&(E?g(r,i,n):o.getQueryCache().get(r.queryHash)?.promise)?.catch(m).finally(()=>{i.updateResult()}),r.notifyOnChangeProps?c:i.trackResult(c)}function p(e,s){return P(e,v)}function U(){const e=p({queryKey:["benefits"],queryFn:async()=>{const{data:t}=await y.customer.benefits.list({query:{page:1,limit:10}});return t}}),s=p({queryKey:["orders"],queryFn:async()=>{const{data:t}=await y.customer.orders.list({query:{page:1,limit:10,productBillingType:"one_time"}});return t}}),u=p({queryKey:["subscriptions"],queryFn:async()=>{const{data:t}=await y.customer.subscriptions.list({query:{page:1,limit:10,active:!0}});return t}});return l.jsxs("div",{children:[l.jsx("h1",{children:"Billing"}),l.jsx("pre",{children:JSON.stringify(e.data,null,2)}),l.jsx("pre",{children:JSON.stringify(s.data,null,2)}),l.jsx("pre",{children:JSON.stringify(u.data,null,2)}),l.jsx(_,{onClick:()=>y.checkout({slug:"pro"}),children:"Checkout"})]})}export{U as component};
