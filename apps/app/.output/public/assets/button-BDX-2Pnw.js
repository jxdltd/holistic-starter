import{r as fe,j as Ft}from"./main-DJAnHGiT.js";var Zc=Object.defineProperty,jc=Object.defineProperties,Vc=Object.getOwnPropertyDescriptors,ro=Object.getOwnPropertySymbols,Mc=Object.prototype.hasOwnProperty,Fc=Object.prototype.propertyIsEnumerable,no=(e,t,r)=>t in e?Zc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Te=(e,t)=>{for(var r in t||(t={}))Mc.call(t,r)&&no(e,r,t[r]);if(ro)for(var r of ro(t))Fc.call(t,r)&&no(e,r,t[r]);return e},Pe=(e,t)=>jc(e,Vc(t)),Bc=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},qc=async(e,t)=>{var r,n,o,s,i,a;let c=t||{};const u={onRequest:[t?.onRequest],onResponse:[t?.onResponse],onSuccess:[t?.onSuccess],onError:[t?.onError],onRetry:[t?.onRetry]};if(!t||!t?.plugins)return{url:e,options:c,hooks:u};for(const l of t?.plugins||[]){if(l.init){const d=await((r=l.init)==null?void 0:r.call(l,e.toString(),t));c=d.options||c,e=d.url}u.onRequest.push((n=l.hooks)==null?void 0:n.onRequest),u.onResponse.push((o=l.hooks)==null?void 0:o.onResponse),u.onSuccess.push((s=l.hooks)==null?void 0:s.onSuccess),u.onError.push((i=l.hooks)==null?void 0:i.onError),u.onRetry.push((a=l.hooks)==null?void 0:a.onRetry)}return{url:e,options:c,hooks:u}},oo=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},Kc=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}};function Wc(e){if(typeof e=="number")return new oo({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new oo(e);case"exponential":return new Kc(e);default:throw new Error("Invalid retry strategy")}}var Hc=async e=>{const t={},r=async n=>typeof n=="function"?await n():n;if(e?.auth){if(e.auth.type==="Bearer"){const n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if(e.auth.type==="Basic"){const n=r(e.auth.username),o=r(e.auth.password);if(!n||!o)return t;t.authorization=`Basic ${btoa(`${n}:${o}`)}`}else if(e.auth.type==="Custom"){const n=r(e.auth.value);if(!n)return t;t.authorization=`${r(e.auth.prefix)} ${n}`}}return t},Jc=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Gc(e){const t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";const n=t.split(";").shift()||"";return Jc.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}function Qc(e){try{return JSON.parse(e),!0}catch{return!1}}function Yo(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function so(e){try{return JSON.parse(e)}catch{return e}}function io(e){return typeof e=="function"}function Yc(e){if(e?.customFetchImpl)return e.customFetchImpl;if(typeof globalThis<"u"&&io(globalThis.fetch))return globalThis.fetch;if(typeof window<"u"&&io(window.fetch))return window.fetch;throw new Error("No fetch implementation found")}async function Xc(e){const t=new Headers(e?.headers),r=await Hc(e);for(const[n,o]of Object.entries(r||{}))t.set(n,o);if(!t.has("content-type")){const n=eu(e?.body);n&&t.set("content-type",n)}return t}function eu(e){return Yo(e)?"application/json":null}function tu(e){if(!e?.body)return null;const t=new Headers(e?.headers);if(Yo(e.body)&&!t.has("content-type")){for(const[r,n]of Object.entries(e?.body))n instanceof Date&&(e.body[r]=n.toISOString());return JSON.stringify(e.body)}return e.body}function ru(e,t){var r;if(t?.method)return t.method.toUpperCase();if(e.startsWith("@")){const n=(r=e.split("@")[1])==null?void 0:r.split("/")[0];return es.includes(n)?n.toUpperCase():t?.body?"POST":"GET"}return t?.body?"POST":"GET"}function nu(e,t){let r;return!e?.signal&&e?.timeout&&(r=setTimeout(()=>t?.abort(),e?.timeout)),{abortTimeout:r,clearTimeout:()=>{r&&clearTimeout(r)}}}var ou=class Xo extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,Xo.prototype)}};async function pr(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new ou(r.issues);return r.value}var es=["get","post","put","patch","delete"],su=e=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(t,r){var n,o,s,i;const a=((o=(n=e.plugins)==null?void 0:n.find(c=>{var u;return(u=c.schema)!=null&&u.config?t.startsWith(c.schema.config.baseURL||"")||t.startsWith(c.schema.config.prefix||""):!1}))==null?void 0:o.schema)||e.schema;if(a){let c=t;(s=a.config)!=null&&s.prefix&&c.startsWith(a.config.prefix)&&(c=c.replace(a.config.prefix,""),a.config.baseURL&&(t=t.replace(a.config.prefix,a.config.baseURL))),(i=a.config)!=null&&i.baseURL&&c.startsWith(a.config.baseURL)&&(c=c.replace(a.config.baseURL,""));const u=a.schema[c];if(u){let l=Pe(Te({},r),{method:u.method,output:u.output});return r?.disableValidation||(l=Pe(Te({},l),{body:u.input?await pr(u.input,r?.body):r?.body,params:u.params?await pr(u.params,r?.params):r?.params,query:u.query?await pr(u.query,r?.query):r?.query})),{url:t,options:l}}}return{url:t,options:r}}}),iu=e=>{async function t(r,n){const o=Pe(Te(Te({},e),n),{plugins:[...e?.plugins||[],su(e||{})]});if(e?.catchAllError)try{return await N(r,o)}catch(s){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:s}}}return await N(r,o)}return t};function au(e,t){let{baseURL:r,params:n,query:o}=t||{query:{},params:{},baseURL:""},s=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){const d=e.toString().split("@")[1].split("/")[0];es.includes(d)&&(e=e.replace(`@${d}/`,"/"))}s.endsWith("/")||(s+="/");let[i,a]=e.replace(s,"").split("?");const c=new URLSearchParams(a);for(const[d,f]of Object.entries(o||{}))f!=null&&c.set(d,String(f));if(n)if(Array.isArray(n)){const d=i.split("/").filter(f=>f.startsWith(":"));for(const[f,h]of d.entries()){const m=n[f];i=i.replace(h,m)}}else for(const[d,f]of Object.entries(n))i=i.replace(`:${d}`,String(f));i=i.split("/").map(encodeURIComponent).join("/"),i.startsWith("/")&&(i=i.slice(1));let u=c.toString();return u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",s.startsWith("http")?new URL(`${i}${u}`,s):`${s}${i}${u}`}var N=async(e,t)=>{var r,n,o,s,i,a,c,u;const{hooks:l,url:d,options:f}=await qc(e,t),h=Yc(f),m=new AbortController,w=(r=f.signal)!=null?r:m.signal,_=au(d,f),E=tu(f),A=await Xc(f),v=ru(d,f);let T=Pe(Te({},f),{url:_,headers:A,body:E,method:v,signal:w});for(const L of l.onRequest)if(L){const $=await L(T);$ instanceof Object&&(T=$)}("pipeTo"in T&&typeof T.pipeTo=="function"||typeof((n=t?.body)==null?void 0:n.pipe)=="function")&&("duplex"in T||(T.duplex="half"));const{clearTimeout:H}=nu(f,m);let x=await h(T.url,T);H();const q={response:x,request:T};for(const L of l.onResponse)if(L){const $=await L(Pe(Te({},q),{response:(o=t?.hookOptions)!=null&&o.cloneResponse?x.clone():x}));$ instanceof Response?x=$:$ instanceof Object&&(x=$.response)}if(x.ok){if(!(T.method!=="HEAD"))return{data:"",error:null};const $=Gc(x),D={data:"",response:x,request:T};if($==="json"||$==="text"){const O=await x.text(),k=await((s=T.jsonParser)!=null?s:so)(O);D.data=k}else D.data=await x[$]();T?.output&&T.output&&!T.disableValidation&&(D.data=await pr(T.output,D.data));for(const O of l.onSuccess)O&&await O(Pe(Te({},D),{response:(i=t?.hookOptions)!=null&&i.cloneResponse?x.clone():x}));return t?.throw?D.data:{data:D.data,error:null}}const S=(a=t?.jsonParser)!=null?a:so,P=await x.text(),B=Qc(P),J=B?await S(P):null,K={response:x,responseText:P,request:T,error:Pe(Te({},J),{status:x.status,statusText:x.statusText})};for(const L of l.onError)L&&await L(Pe(Te({},K),{response:(c=t?.hookOptions)!=null&&c.cloneResponse?x.clone():x}));if(t?.retry){const L=Wc(t.retry),$=(u=t.retryAttempt)!=null?u:0;if(await L.shouldAttemptRetry($,x)){for(const O of l.onRetry)O&&await O(q);const D=L.getDelay($);return await new Promise(O=>setTimeout(O,D)),await N(e,Pe(Te({},t),{retryAttempt:$+1}))}}if(t?.throw)throw new Bc(x.status,x.statusText,B?J:P);return{data:null,error:Pe(Te({},J),{status:x.status,statusText:x.statusText})}},cu={},uu={};const hr=Object.create(null),Nt=e=>cu||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?hr:globalThis),it=new Proxy(hr,{get(e,t){return Nt()[t]??hr[t]},has(e,t){const r=Nt();return t in r||t in hr},set(e,t,r){const n=Nt(!0);return n[t]=r,!0},deleteProperty(e,t){if(!t)return!1;const r=Nt(!0);return delete r[t],!0},ownKeys(){const e=Nt(!0);return Object.keys(e)}}),ao=typeof process<"u"&&uu&&"production"||"",lu=ao==="dev"||ao==="development";class pe extends Error{constructor(t,r){super(t),this.name="BetterAuthError",this.message=t,this.cause=r,this.stack=""}}function du(e){try{return new URL(e).pathname!=="/"}catch{throw new pe(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}function Gr(e,t="/api/auth"){return du(e)?e:(t=t.startsWith("/")?t:`/${t}`,`${e.replace(/\/+$/,"")}${t}`)}function fu(e,t,r){if(e)return Gr(e,t);const n=it.BETTER_AUTH_URL||it.NEXT_PUBLIC_BETTER_AUTH_URL||it.PUBLIC_BETTER_AUTH_URL||it.NUXT_PUBLIC_BETTER_AUTH_URL||it.NUXT_PUBLIC_AUTH_URL||(it.BASE_URL!=="/"?it.BASE_URL:void 0);if(n)return Gr(n,t);if(typeof window<"u"&&window.location)return Gr(window.location.origin,t)}function gr(e){try{return new URL(e).origin}catch{return null}}function ts(e){try{return new URL(e).protocol}catch{return null}}function rs(e){try{return new URL(e).host}catch{return e}}let Ae=[],We=0;const tr=4;let ns=e=>{let t=[],r={get(){return r.lc||r.listen(()=>{})(),r.value},lc:0,listen(n){return r.lc=t.push(n),()=>{for(let s=We+tr;s<Ae.length;)Ae[s]===n?Ae.splice(s,tr):s+=tr;let o=t.indexOf(n);~o&&(t.splice(o,1),--r.lc||r.off())}},notify(n,o){let s=!Ae.length;for(let i of t)Ae.push(i,r.value,n,o);if(s){for(We=0;We<Ae.length;We+=tr)Ae[We](Ae[We+1],Ae[We+2],Ae[We+3]);Ae.length=0}},off(){},set(n){let o=r.value;o!==n&&(r.value=n,r.notify(o))},subscribe(n){let o=r.listen(n);return n(r.value),o},value:e};return r};const pu=5,rr=6,nr=10;let hu=(e,t,r,n)=>(e.events=e.events||{},e.events[r+nr]||(e.events[r+nr]=n(o=>{e.events[r].reduceRight((s,i)=>(i(s),s),{shared:{},...o})})),e.events[r]=e.events[r]||[],e.events[r].push(t),()=>{let o=e.events[r],s=o.indexOf(t);o.splice(s,1),o.length||(delete e.events[r],e.events[r+nr](),delete e.events[r+nr])}),mu=1e3,gu=(e,t)=>hu(e,n=>{let o=t(n);o&&e.events[rr].push(o)},pu,n=>{let o=e.listen;e.listen=(...i)=>(!e.lc&&!e.active&&(e.active=!0,n()),o(...i));let s=e.off;return e.events[rr]=[],e.off=()=>{s(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let i of e.events[rr])i();e.events[rr]=[]}},mu)},()=>{e.listen=o,e.off=s}});function yu(e,t,r){let n=new Set(t).add(void 0);return e.listen((o,s,i)=>{n.has(i)&&r(o,s,i)})}const wu=typeof window>"u",bu=(e,t,r,n)=>{const o=ns({data:null,error:null,isPending:!0,isRefetching:!1,refetch:a=>s(a)}),s=a=>{const c=typeof n=="function"?n({data:o.get().data,error:o.get().error,isPending:o.get().isPending}):n;r(t,{...c,query:{...c?.query,...a?.query},async onSuccess(u){o.set({data:u.data,error:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await c?.onSuccess?.(u)},async onError(u){const{request:l}=u,d=typeof l.retry=="number"?l.retry:l.retry?.attempts,f=l.retryAttempt||0;d&&f<d||(o.set({error:u.error,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await c?.onError?.(u))},async onRequest(u){const l=o.get();o.set({isPending:l.data===null,data:l.data,error:null,isRefetching:!0,refetch:o.value.refetch}),await c?.onRequest?.(u)}}).catch(u=>{o.set({error:u,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch})})};e=Array.isArray(e)?e:[e];let i=!1;for(const a of e)a.subscribe(()=>{wu||(i?s():gu(o,()=>(setTimeout(()=>{s()},0),i=!0,()=>{o.off(),a.off()})))});return o},_u={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},vu=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,co={true:!0,false:!1,null:null,undefined:void 0,nan:Number.NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},ku=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/;function Au(e){return e instanceof Date&&!isNaN(e.getTime())}function Eu(e){const t=ku.exec(e);if(!t)return null;const[,r,n,o,s,i,a,c,u,l,d]=t;let f=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(o,10),parseInt(s,10),parseInt(i,10),parseInt(a,10),c?parseInt(c.padEnd(3,"0"),10):0));if(u){const h=(parseInt(l,10)*60+parseInt(d,10))*(u==="+"?-1:1);f.setUTCMinutes(f.getUTCMinutes()+h)}return Au(f)?f:null}function Tu(e,t={}){const{strict:r=!1,warnings:n=!1,reviver:o,parseDates:s=!0}=t;if(typeof e!="string")return e;const i=e.trim();if(i[0]==='"'&&i.endsWith('"')&&!i.slice(1,-1).includes('"'))return i.slice(1,-1);const a=i.toLowerCase();if(a.length<=9&&a in co)return co[a];if(!vu.test(i)){if(r)throw new SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(_u).some(([u,l])=>{const d=l.test(i);return d&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${u} pattern`),d})&&r)throw new Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(i,(l,d)=>{if(l==="__proto__"||l==="constructor"&&d&&typeof d=="object"&&"prototype"in d){n&&console.warn(`[better-json] Dropping "${l}" key to prevent prototype pollution`);return}if(s&&typeof d=="string"){const f=Eu(d);if(f)return f}return o?o(l,d):d})}catch(u){if(r)throw u;return e}}function Su(e,t={strict:!0}){return Tu(e,t)}const Iu={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&typeof window<"u"&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}};function Ru(e){const t=ns(!1);return{session:bu(t,"/get-session",e,{method:"GET"}),$sessionSignal:t}}const Uu=e=>{const t="credentials"in Request.prototype,r=fu(e?.baseURL,e?.basePath),n=e?.plugins?.flatMap(v=>v.fetchPlugins).filter(v=>v!==void 0)||[],o={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:s,onError:i,onRequest:a,onResponse:c,...u}=e?.fetchOptions||{},l=iu({baseURL:r,...t?{credentials:"include"}:{},method:"GET",jsonParser(v){return v?Su(v,{strict:!1}):null},customFetchImpl:fetch,...u,plugins:[o,...u.plugins||[],...e?.disableDefaultFetchPlugins?[]:[Iu],...n]}),{$sessionSignal:d,session:f}=Ru(l),h=e?.plugins||[];let m={},w={$sessionSignal:d,session:f},_={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"};const E=[{signal:"$sessionSignal",matcher(v){return v==="/sign-out"||v==="/update-user"||v.startsWith("/sign-in")||v.startsWith("/sign-up")||v==="/delete-user"||v==="/verify-email"}}];for(const v of h)v.getAtoms&&Object.assign(w,v.getAtoms?.(l)),v.pathMethods&&Object.assign(_,v.pathMethods),v.atomListeners&&E.push(...v.atomListeners);const A={notify:v=>{w[v].set(!w[v].get())},listen:(v,T)=>{w[v].subscribe(T)},atoms:w};for(const v of h)v.getActions&&Object.assign(m,v.getActions?.(l,A,e));return{pluginsActions:m,pluginsAtoms:w,pluginPathMethods:_,atomListeners:E,$fetch:l,$store:A}};function xu(e){return typeof e=="object"&&e!==null&&"get"in e&&typeof e.get=="function"&&"lc"in e&&typeof e.lc=="number"}function zu(e,t,r){const n=t[e],{fetchOptions:o,query:s,...i}=r||{};return n||(o?.method?o.method:i&&Object.keys(i).length>0?"POST":"GET")}function $u(e,t,r,n,o){function s(i=[]){return new Proxy(function(){},{get(a,c){if(c==="then"||c==="catch"||c==="finally")return;const u=[...i,c];let l=e;for(const d of u)if(l&&typeof l=="object"&&d in l)l=l[d];else{l=void 0;break}return typeof l=="function"||xu(l)?l:s(u)},apply:async(a,c,u)=>{const l="/"+i.map(A=>A.replace(/[A-Z]/g,v=>`-${v.toLowerCase()}`)).join("/"),d=u[0]||{},f=u[1]||{},{query:h,fetchOptions:m,...w}=d,_={...f,...m},E=zu(l,r,d);return await t(l,{..._,body:E==="GET"?void 0:{...w,..._?.body||{}},query:h||_?.query,method:E,async onSuccess(A){await _?.onSuccess?.(A);const v=o?.find(x=>x.matcher(l));if(!v)return;const T=n[v.signal];if(!T)return;const H=T.get();setTimeout(()=>{T.set(!H)},10)}})}})}return s()}function Ou(e,t={}){let r=fe.useRef(e.get());const{keys:n,deps:o=[e,n]}=t;let s=fe.useCallback(a=>{const c=u=>{r.current!==u&&(r.current=u,a())};return c(e.value),n?.length?yu(e,n,c):e.listen(c)},o),i=()=>r.current;return fe.useSyncExternalStore(s,i,i)}function Pu(e){return`use${Cu(e)}`}function Cu(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Du(e){const{pluginPathMethods:t,pluginsActions:r,pluginsAtoms:n,$fetch:o,$store:s,atomListeners:i}=Uu(e);let a={};for(const[l,d]of Object.entries(n))a[Pu(l)]=()=>Ou(d);const c={...r,...a,$fetch:o,$store:s};return $u(c,o,t,n,i)}const Sw=Object.freeze({status:"aborted"});function p(e,t,r){function n(a,c){var u;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(u=a._zod).traits??(u.traits=new Set),a._zod.traits.add(e),t(a,c);for(const l in i.prototype)l in a||Object.defineProperty(a,l,{value:i.prototype[l].bind(a)});a._zod.constr=i,a._zod.def=c}const o=r?.Parent??Object;class s extends o{}Object.defineProperty(s,"name",{value:e});function i(a){var c;const u=r?.Parent?new s:this;n(u,a),(c=u._zod).deferred??(c.deferred=[]);for(const l of u._zod.deferred)l();return u}return Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:a=>r?.Parent&&a instanceof r.Parent?!0:a?._zod?.traits?.has(e)}),Object.defineProperty(i,"name",{value:e}),i}const Iw=Symbol("zod_brand");class _t extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class $n extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const sn={};function Ze(e){return e&&Object.assign(sn,e),sn}function Nu(e){return e}function Lu(e){return e}function Zu(e){}function ju(e){throw new Error}function Vu(e){}function os(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,o])=>t.indexOf(+n)===-1).map(([n,o])=>o)}function Mu(e,t="|"){return e.map(r=>cs(r)).join(t)}function yr(e,t){return typeof t=="bigint"?t.toString():t}function Wt(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function ft(e){return e==null}function zr(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function ss(e,t){const r=(e.toString().split(".")[1]||"").length,n=t.toString();let o=(n.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(n)){const c=n.match(/\d?e-(\d?)/);c?.[1]&&(o=Number.parseInt(c[1]))}const s=r>o?r:o,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}const uo=Symbol("evaluating");function M(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==uo)return n===void 0&&(n=uo,n=r()),n},set(o){Object.defineProperty(e,t,{value:o})},configurable:!0})}function $r(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function ze(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function nt(...e){const t={};for(const r of e){const n=Object.getOwnPropertyDescriptors(r);Object.assign(t,n)}return Object.defineProperties({},t)}function Fu(e){return nt(e._zod.def)}function Bu(e,t){return t?t.reduce((r,n)=>r?.[n],e):e}function qu(e){const t=Object.keys(e),r=t.map(n=>e[n]);return Promise.all(r).then(n=>{const o={};for(let s=0;s<t.length;s++)o[t[s]]=n[s];return o})}function Ku(e=10){const t="abcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}function an(e){return JSON.stringify(e)}const On="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function kt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const is=Wt(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function dt(e){if(kt(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(kt(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Or(e){return dt(e)?{...e}:e}function Wu(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}const Hu=e=>{const t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(e)?"array":e===null?"null":e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?"promise":typeof Map<"u"&&e instanceof Map?"map":typeof Set<"u"&&e instanceof Set?"set":typeof Date<"u"&&e instanceof Date?"date":typeof File<"u"&&e instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${t}`)}},wr=new Set(["string","number","symbol"]),as=new Set(["string","number","bigint","boolean","symbol","undefined"]);function et(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function je(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function y(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Ju(e){let t;return new Proxy({},{get(r,n,o){return t??(t=e()),Reflect.get(t,n,o)},set(r,n,o,s){return t??(t=e()),Reflect.set(t,n,o,s)},has(r,n){return t??(t=e()),Reflect.has(t,n)},deleteProperty(r,n){return t??(t=e()),Reflect.deleteProperty(t,n)},ownKeys(r){return t??(t=e()),Reflect.ownKeys(t)},getOwnPropertyDescriptor(r,n){return t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)},defineProperty(r,n,o){return t??(t=e()),Reflect.defineProperty(t,n,o)}})}function cs(e){return typeof e=="bigint"?e.toString()+"n":typeof e=="string"?`"${e}"`:`${e}`}function us(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const ls={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},ds={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function fs(e,t){const r=e._zod.def,n=nt(e._zod.def,{get shape(){const o={};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&(o[s]=r.shape[s])}return ze(this,"shape",o),o},checks:[]});return je(e,n)}function ps(e,t){const r=e._zod.def,n=nt(e._zod.def,{get shape(){const o={...e._zod.def.shape};for(const s in t){if(!(s in r.shape))throw new Error(`Unrecognized key: "${s}"`);t[s]&&delete o[s]}return ze(this,"shape",o),o},checks:[]});return je(e,n)}function hs(e,t){if(!dt(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const o=nt(e._zod.def,{get shape(){const s={...e._zod.def.shape,...t};return ze(this,"shape",s),s},checks:[]});return je(e,o)}function ms(e,t){if(!dt(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return ze(this,"shape",n),n},checks:e._zod.def.checks};return je(e,r)}function gs(e,t){const r=nt(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return ze(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return je(e,r)}function ys(e,t,r){const n=nt(t._zod.def,{get shape(){const o=t._zod.def.shape,s={...o};if(r)for(const i in r){if(!(i in o))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=e?new e({type:"optional",innerType:o[i]}):o[i])}else for(const i in o)s[i]=e?new e({type:"optional",innerType:o[i]}):o[i];return ze(this,"shape",s),s},checks:[]});return je(t,n)}function ws(e,t,r){const n=nt(t._zod.def,{get shape(){const o=t._zod.def.shape,s={...o};if(r)for(const i in r){if(!(i in s))throw new Error(`Unrecognized key: "${i}"`);r[i]&&(s[i]=new e({type:"nonoptional",innerType:o[i]}))}else for(const i in o)s[i]=new e({type:"nonoptional",innerType:o[i]});return ze(this,"shape",s),s},checks:[]});return je(t,n)}function ut(e,t=0){if(e.aborted===!0)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function Ie(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function jt(e){return typeof e=="string"?e:e?.message}function Re(e,t,r){const n={...e,path:e.path??[]};if(!e.message){const o=jt(e.inst?._zod.def?.error?.(e))??jt(t?.error?.(e))??jt(r.customError?.(e))??jt(r.localeError?.(e))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function Pr(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function Cr(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function At(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}function Gu(e){return Object.entries(e).filter(([t,r])=>Number.isNaN(Number.parseInt(t,10))).map(t=>t[1])}function bs(e){const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}function _s(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function Qu(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4);return bs(t+r)}function Yu(e){return _s(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Xu(e){const t=e.replace(/^0x/,"");if(t.length%2!==0)throw new Error("Invalid hex string length");const r=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2)r[n/2]=Number.parseInt(t.slice(n,n+2),16);return r}function el(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}let tl=class{constructor(...t){}};const Uw=Object.freeze(Object.defineProperty({__proto__:null,BIGINT_FORMAT_RANGES:ds,Class:tl,NUMBER_FORMAT_RANGES:ls,aborted:ut,allowsEval:is,assert:Vu,assertEqual:Nu,assertIs:Zu,assertNever:ju,assertNotEqual:Lu,assignProp:ze,base64ToUint8Array:bs,base64urlToUint8Array:Qu,cached:Wt,captureStackTrace:On,cleanEnum:Gu,cleanRegex:zr,clone:je,cloneDef:Fu,createTransparentProxy:Ju,defineLazy:M,esc:an,escapeRegex:et,extend:hs,finalizeIssue:Re,floatSafeRemainder:ss,getElementAtPath:Bu,getEnumValues:os,getLengthableOrigin:Cr,getParsedType:Hu,getSizableOrigin:Pr,hexToUint8Array:Xu,isObject:kt,isPlainObject:dt,issue:At,joinValues:Mu,jsonStringifyReplacer:yr,merge:gs,mergeDefs:nt,normalizeParams:y,nullish:ft,numKeys:Wu,objectClone:$r,omit:ps,optionalKeys:us,partial:ys,pick:fs,prefixIssues:Ie,primitiveTypes:as,promiseAllObject:qu,propertyKeyTypes:wr,randomString:Ku,required:ws,safeExtend:ms,shallowClone:Or,stringifyPrimitive:cs,uint8ArrayToBase64:_s,uint8ArrayToBase64url:Yu,uint8ArrayToHex:el,unwrapMessage:jt},Symbol.toStringTag,{value:"Module"})),vs=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,yr,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},ks=p("$ZodError",vs),be=p("$ZodError",vs,{Parent:Error});function rl(e,t=r=>r.message){const r={},n=[];for(const o of e.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):n.push(t(o));return{formErrors:n,fieldErrors:r}}function nl(e,t){const r=t||function(s){return s.message},n={_errors:[]},o=s=>{for(const i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(a=>o({issues:a}));else if(i.code==="invalid_key")o({issues:i.issues});else if(i.code==="invalid_element")o({issues:i.issues});else if(i.path.length===0)n._errors.push(r(i));else{let a=n,c=0;for(;c<i.path.length;){const u=i.path[c];c===i.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(i))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return o(e),n}function xw(e,t){const r=t||function(s){return s.message},n={errors:[]},o=(s,i=[])=>{var a,c;for(const u of s.issues)if(u.code==="invalid_union"&&u.errors.length)u.errors.map(l=>o({issues:l},u.path));else if(u.code==="invalid_key")o({issues:u.issues},u.path);else if(u.code==="invalid_element")o({issues:u.issues},u.path);else{const l=[...i,...u.path];if(l.length===0){n.errors.push(r(u));continue}let d=n,f=0;for(;f<l.length;){const h=l[f],m=f===l.length-1;typeof h=="string"?(d.properties??(d.properties={}),(a=d.properties)[h]??(a[h]={errors:[]}),d=d.properties[h]):(d.items??(d.items=[]),(c=d.items)[h]??(c[h]={errors:[]}),d=d.items[h]),m&&d.errors.push(r(u)),f++}}};return o(e),n}function ol(e){const t=[],r=e.map(n=>typeof n=="object"?n.key:n);for(const n of r)typeof n=="number"?t.push(`[${n}]`):typeof n=="symbol"?t.push(`[${JSON.stringify(String(n))}]`):/[^\w$]/.test(n)?t.push(`[${JSON.stringify(n)}]`):(t.length&&t.push("."),t.push(n));return t.join("")}function zw(e){const t=[],r=[...e.issues].sort((n,o)=>(n.path??[]).length-(o.path??[]).length);for(const n of r)t.push(`✖ ${n.message}`),n.path?.length&&t.push(`  → at ${ol(n.path)}`);return t.join(`
`)}const Dr=e=>(t,r,n,o)=>{const s=n?Object.assign(n,{async:!1}):{async:!1},i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise)throw new _t;if(i.issues.length){const a=new(o?.Err??e)(i.issues.map(c=>Re(c,s,Ze())));throw On(a,o?.callee),a}return i.value},lo=Dr(be),Nr=e=>async(t,r,n,o)=>{const s=n?Object.assign(n,{async:!0}):{async:!0};let i=t._zod.run({value:r,issues:[]},s);if(i instanceof Promise&&(i=await i),i.issues.length){const a=new(o?.Err??e)(i.issues.map(c=>Re(c,s,Ze())));throw On(a,o?.callee),a}return i.value},fo=Nr(be),Lr=e=>(t,r,n)=>{const o=n?{...n,async:!1}:{async:!1},s=t._zod.run({value:r,issues:[]},o);if(s instanceof Promise)throw new _t;return s.issues.length?{success:!1,error:new(e??ks)(s.issues.map(i=>Re(i,o,Ze())))}:{success:!0,data:s.value}},sl=Lr(be),Zr=e=>async(t,r,n)=>{const o=n?Object.assign(n,{async:!0}):{async:!0};let s=t._zod.run({value:r,issues:[]},o);return s instanceof Promise&&(s=await s),s.issues.length?{success:!1,error:new e(s.issues.map(i=>Re(i,o,Ze())))}:{success:!0,data:s.value}},il=Zr(be),As=e=>(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Dr(e)(t,r,o)},$w=As(be),Es=e=>(t,r,n)=>Dr(e)(t,r,n),Ow=Es(be),Ts=e=>async(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Nr(e)(t,r,o)},Pw=Ts(be),Ss=e=>async(t,r,n)=>Nr(e)(t,r,n),Cw=Ss(be),Is=e=>(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Lr(e)(t,r,o)},Dw=Is(be),Rs=e=>(t,r,n)=>Lr(e)(t,r,n),Nw=Rs(be),Us=e=>async(t,r,n)=>{const o=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Zr(e)(t,r,o)},Lw=Us(be),xs=e=>async(t,r,n)=>Zr(e)(t,r,n),Zw=xs(be),zs=/^[cC][^\s-]{8,}$/,$s=/^[0-9a-z]+$/,Os=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Ps=/^[0-9a-vA-V]{20}$/,Cs=/^[A-Za-z0-9]{27}$/,Ds=/^[a-zA-Z0-9_-]{21}$/,Ns=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,al=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Ls=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Et=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,cl=Et(4),ul=Et(6),ll=Et(7),Zs=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,dl=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,fl=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,pl=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,hl=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,ml=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,gl="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function js(){return new RegExp(gl,"u")}const Vs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ms=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Fs=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Bs=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,qs=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Pn=/^[A-Za-z0-9_-]*$/,Cn=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,Ks=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,Ws=/^\+(?:[0-9]){6,14}[0-9]$/,Hs="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Js=new RegExp(`^${Hs}$`);function Gs(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Qs(e){return new RegExp(`^${Gs(e)}$`)}function Ys(e){const t=Gs({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${Hs}T(?:${n})$`)}const Xs=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},ei=/^\d+n?$/,ti=/^\d+$/,ri=/^-?\d+(?:\.\d+)?/i,ni=/true|false/i,oi=/null/i,si=/undefined/i,ii=/^[^A-Z]*$/,ai=/^[^a-z]*$/,ci=/^[0-9a-fA-F]*$/;function Ht(e,t){return new RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function Jt(e){return new RegExp(`^[A-Za-z0-9-_]{${e}}$`)}const yl=/^[0-9a-fA-F]{32}$/,wl=Ht(22,"=="),bl=Jt(22),_l=/^[0-9a-fA-F]{40}$/,vl=Ht(27,"="),kl=Jt(27),Al=/^[0-9a-fA-F]{64}$/,El=Ht(43,"="),Tl=Jt(43),Sl=/^[0-9a-fA-F]{96}$/,Il=Ht(64,""),Rl=Jt(64),Ul=/^[0-9a-fA-F]{128}$/,xl=Ht(86,"=="),zl=Jt(86),$l=Object.freeze(Object.defineProperty({__proto__:null,base64:qs,base64url:Pn,bigint:ei,boolean:ni,browserEmail:ml,cidrv4:Fs,cidrv6:Bs,cuid:zs,cuid2:$s,date:Js,datetime:Ys,domain:Ks,duration:Ns,e164:Ws,email:Zs,emoji:js,extendedDuration:al,guid:Ls,hex:ci,hostname:Cn,html5Email:dl,idnEmail:hl,integer:ti,ipv4:Vs,ipv6:Ms,ksuid:Cs,lowercase:ii,md5_base64:wl,md5_base64url:bl,md5_hex:yl,nanoid:Ds,null:oi,number:ri,rfc5322Email:fl,sha1_base64:vl,sha1_base64url:kl,sha1_hex:_l,sha256_base64:El,sha256_base64url:Tl,sha256_hex:Al,sha384_base64:Il,sha384_base64url:Rl,sha384_hex:Sl,sha512_base64:xl,sha512_base64url:zl,sha512_hex:Ul,string:Xs,time:Qs,ulid:Os,undefined:si,unicodeEmail:pl,uppercase:ai,uuid:Et,uuid4:cl,uuid6:ul,uuid7:ll,xid:Ps},Symbol.toStringTag,{value:"Module"})),ue=p("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),ui={number:"number",bigint:"bigint",object:"date"},li=p("$ZodCheckLessThan",(e,t)=>{ue.init(e,t);const r=ui[typeof t.value];e._zod.onattach.push(n=>{const o=n._zod.bag,s=(t.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<s&&(t.inclusive?o.maximum=t.value:o.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),di=p("$ZodCheckGreaterThan",(e,t)=>{ue.init(e,t);const r=ui[typeof t.value];e._zod.onattach.push(n=>{const o=n._zod.bag,s=(t.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>s&&(t.inclusive?o.minimum=t.value:o.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Ol=p("$ZodCheckMultipleOf",(e,t)=>{ue.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):ss(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),Pl=p("$ZodCheckNumberFormat",(e,t)=>{ue.init(e,t),t.format=t.format||"float64";const r=t.format?.includes("int"),n=r?"int":"number",[o,s]=ls[t.format];e._zod.onattach.push(i=>{const a=i._zod.bag;a.format=t.format,a.minimum=o,a.maximum=s,r&&(a.pattern=ti)}),e._zod.check=i=>{const a=i.value;if(r){if(!Number.isInteger(a)){i.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:a,inst:e});return}if(!Number.isSafeInteger(a)){a>0?i.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):i.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}a<o&&i.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),a>s&&i.issues.push({origin:"number",input:a,code:"too_big",maximum:s,inst:e})}}),Cl=p("$ZodCheckBigIntFormat",(e,t)=>{ue.init(e,t);const[r,n]=ds[t.format];e._zod.onattach.push(o=>{const s=o._zod.bag;s.format=t.format,s.minimum=r,s.maximum=n}),e._zod.check=o=>{const s=o.value;s<r&&o.issues.push({origin:"bigint",input:s,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),s>n&&o.issues.push({origin:"bigint",input:s,code:"too_big",maximum:n,inst:e})}}),Dl=p("$ZodCheckMaxSize",(e,t)=>{var r;ue.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!ft(o)&&o.size!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<o&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const o=n.value;o.size<=t.maximum||n.issues.push({origin:Pr(o),code:"too_big",maximum:t.maximum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),Nl=p("$ZodCheckMinSize",(e,t)=>{var r;ue.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!ft(o)&&o.size!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>o&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const o=n.value;o.size>=t.minimum||n.issues.push({origin:Pr(o),code:"too_small",minimum:t.minimum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),Ll=p("$ZodCheckSizeEquals",(e,t)=>{var r;ue.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!ft(o)&&o.size!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag;o.minimum=t.size,o.maximum=t.size,o.size=t.size}),e._zod.check=n=>{const o=n.value,s=o.size;if(s===t.size)return;const i=s>t.size;n.issues.push({origin:Pr(o),...i?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),Zl=p("$ZodCheckMaxLength",(e,t)=>{var r;ue.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!ft(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<o&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const o=n.value;if(o.length<=t.maximum)return;const i=Cr(o);n.issues.push({origin:i,code:"too_big",maximum:t.maximum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),jl=p("$ZodCheckMinLength",(e,t)=>{var r;ue.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!ft(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>o&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const o=n.value;if(o.length>=t.minimum)return;const i=Cr(o);n.issues.push({origin:i,code:"too_small",minimum:t.minimum,inclusive:!0,input:o,inst:e,continue:!t.abort})}}),Vl=p("$ZodCheckLengthEquals",(e,t)=>{var r;ue.init(e,t),(r=e._zod.def).when??(r.when=n=>{const o=n.value;return!ft(o)&&o.length!==void 0}),e._zod.onattach.push(n=>{const o=n._zod.bag;o.minimum=t.length,o.maximum=t.length,o.length=t.length}),e._zod.check=n=>{const o=n.value,s=o.length;if(s===t.length)return;const i=Cr(o),a=s>t.length;n.issues.push({origin:i,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),jr=p("$ZodCheckStringFormat",(e,t)=>{var r,n;ue.init(e,t),e._zod.onattach.push(o=>{const s=o._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=o=>{t.pattern.lastIndex=0,!t.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:t.format,input:o.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),Ml=p("$ZodCheckRegex",(e,t)=>{jr.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Fl=p("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=ii),jr.init(e,t)}),Bl=p("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=ai),jr.init(e,t)}),ql=p("$ZodCheckIncludes",(e,t)=>{ue.init(e,t);const r=et(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(o=>{const s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=o=>{o.value.includes(t.includes,t.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:o.value,inst:e,continue:!t.abort})}}),Kl=p("$ZodCheckStartsWith",(e,t)=>{ue.init(e,t);const r=new RegExp(`^${et(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),Wl=p("$ZodCheckEndsWith",(e,t)=>{ue.init(e,t);const r=new RegExp(`.*${et(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const o=n._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}});function po(e,t,r){e.issues.length&&t.issues.push(...Ie(r,e.issues))}const Hl=p("$ZodCheckProperty",(e,t)=>{ue.init(e,t),e._zod.check=r=>{const n=t.schema._zod.run({value:r.value[t.property],issues:[]},{});if(n instanceof Promise)return n.then(o=>po(o,r,t.property));po(n,r,t.property)}}),Jl=p("$ZodCheckMimeType",(e,t)=>{ue.init(e,t);const r=new Set(t.mime);e._zod.onattach.push(n=>{n._zod.bag.mime=t.mime}),e._zod.check=n=>{r.has(n.value.type)||n.issues.push({code:"invalid_value",values:t.mime,input:n.value.type,inst:e,continue:!t.abort})}}),Gl=p("$ZodCheckOverwrite",(e,t)=>{ue.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class Ql{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(i=>i),o=Math.min(...n.map(i=>i.length-i.trimStart().length)),s=n.map(i=>i.slice(o)).map(i=>" ".repeat(this.indent*2)+i);for(const i of s)this.content.push(i)}compile(){const t=Function,r=this?.args,o=[...(this?.content??[""]).map(s=>`  ${s}`)];return new t(...r,o.join(`
`))}}const Yl={major:4,minor:1,patch:5},C=p("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Yl;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const o of n)for(const s of o._zod.onattach)s(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const o=(i,a,c)=>{let u=ut(i),l;for(const d of a){if(d._zod.def.when){if(!d._zod.def.when(i))continue}else if(u)continue;const f=i.issues.length,h=d._zod.check(i);if(h instanceof Promise&&c?.async===!1)throw new _t;if(l||h instanceof Promise)l=(l??Promise.resolve()).then(async()=>{await h,i.issues.length!==f&&(u||(u=ut(i,f)))});else{if(i.issues.length===f)continue;u||(u=ut(i,f))}}return l?l.then(()=>i):i},s=(i,a,c)=>{if(ut(i))return i.aborted=!0,i;const u=o(a,n,c);if(u instanceof Promise){if(c.async===!1)throw new _t;return u.then(l=>e._zod.parse(l,c))}return e._zod.parse(u,c)};e._zod.run=(i,a)=>{if(a.skipChecks)return e._zod.parse(i,a);if(a.direction==="backward"){const u=e._zod.parse({value:i.value,issues:[]},{...a,skipChecks:!0});return u instanceof Promise?u.then(l=>s(l,i,a)):s(u,i,a)}const c=e._zod.parse(i,a);if(c instanceof Promise){if(a.async===!1)throw new _t;return c.then(u=>o(u,n,a))}return o(c,n,a)}}e["~standard"]={validate:o=>{try{const s=sl(e,o);return s.success?{value:s.data}:{issues:s.error?.issues}}catch{return il(e,o).then(i=>i.success?{value:i.data}:{issues:i.error?.issues})}},vendor:"zod",version:1}}),Vr=p("$ZodString",(e,t)=>{C.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??Xs(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),oe=p("$ZodStringFormat",(e,t)=>{jr.init(e,t),Vr.init(e,t)}),Xl=p("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Ls),oe.init(e,t)}),ed=p("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Et(n))}else t.pattern??(t.pattern=Et());oe.init(e,t)}),td=p("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Zs),oe.init(e,t)}),rd=p("$ZodURL",(e,t)=>{oe.init(e,t),e._zod.check=r=>{try{const n=r.value.trim(),o=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(o.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Cn.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=o.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),nd=p("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=js()),oe.init(e,t)}),od=p("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Ds),oe.init(e,t)}),sd=p("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=zs),oe.init(e,t)}),id=p("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=$s),oe.init(e,t)}),ad=p("$ZodULID",(e,t)=>{t.pattern??(t.pattern=Os),oe.init(e,t)}),cd=p("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Ps),oe.init(e,t)}),ud=p("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Cs),oe.init(e,t)}),ld=p("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Ys(t)),oe.init(e,t)}),dd=p("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Js),oe.init(e,t)}),fd=p("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=Qs(t)),oe.init(e,t)}),pd=p("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Ns),oe.init(e,t)}),hd=p("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Vs),oe.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),md=p("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Ms),oe.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),gd=p("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Fs),oe.init(e,t)}),yd=p("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Bs),oe.init(e,t),e._zod.check=r=>{const[n,o]=r.value.split("/");try{if(!o)throw new Error;const s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function fi(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const wd=p("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=qs),oe.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{fi(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function bd(e){if(!Pn.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return fi(r)}const _d=p("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Pn),oe.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{bd(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),vd=p("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Ws),oe.init(e,t)});function kd(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const o=JSON.parse(atob(n));return!("typ"in o&&o?.typ!=="JWT"||!o.alg||t&&(!("alg"in o)||o.alg!==t))}catch{return!1}}const Ad=p("$ZodJWT",(e,t)=>{oe.init(e,t),e._zod.check=r=>{kd(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),Ed=p("$ZodCustomStringFormat",(e,t)=>{oe.init(e,t),e._zod.check=r=>{t.fn(r.value)||r.issues.push({code:"invalid_format",format:t.format,input:r.value,inst:e,continue:!t.abort})}}),pi=p("$ZodNumber",(e,t)=>{C.init(e,t),e._zod.pattern=e._zod.bag.pattern??ri,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const o=r.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return r;const s=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:o,inst:e,...s?{received:s}:{}}),r}}),Td=p("$ZodNumber",(e,t)=>{Pl.init(e,t),pi.init(e,t)}),hi=p("$ZodBoolean",(e,t)=>{C.init(e,t),e._zod.pattern=ni,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch{}const o=r.value;return typeof o=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),r}}),mi=p("$ZodBigInt",(e,t)=>{C.init(e,t),e._zod.pattern=ei,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=BigInt(r.value)}catch{}return typeof r.value=="bigint"||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:e}),r}}),Sd=p("$ZodBigInt",(e,t)=>{Cl.init(e,t),mi.init(e,t)}),Id=p("$ZodSymbol",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;return typeof o=="symbol"||r.issues.push({expected:"symbol",code:"invalid_type",input:o,inst:e}),r}}),Rd=p("$ZodUndefined",(e,t)=>{C.init(e,t),e._zod.pattern=si,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(r,n)=>{const o=r.value;return typeof o>"u"||r.issues.push({expected:"undefined",code:"invalid_type",input:o,inst:e}),r}}),Ud=p("$ZodNull",(e,t)=>{C.init(e,t),e._zod.pattern=oi,e._zod.values=new Set([null]),e._zod.parse=(r,n)=>{const o=r.value;return o===null||r.issues.push({expected:"null",code:"invalid_type",input:o,inst:e}),r}}),xd=p("$ZodAny",(e,t)=>{C.init(e,t),e._zod.parse=r=>r}),zd=p("$ZodUnknown",(e,t)=>{C.init(e,t),e._zod.parse=r=>r}),$d=p("$ZodNever",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)}),Od=p("$ZodVoid",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;return typeof o>"u"||r.issues.push({expected:"void",code:"invalid_type",input:o,inst:e}),r}}),Pd=p("$ZodDate",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=new Date(r.value)}catch{}const o=r.value,s=o instanceof Date;return s&&!Number.isNaN(o.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:o,...s?{received:"Invalid Date"}:{},inst:e}),r}});function ho(e,t,r){e.issues.length&&t.issues.push(...Ie(r,e.issues)),t.value[r]=e.value}const Cd=p("$ZodArray",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!Array.isArray(o))return r.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),r;r.value=Array(o.length);const s=[];for(let i=0;i<o.length;i++){const a=o[i],c=t.element._zod.run({value:a,issues:[]},n);c instanceof Promise?s.push(c.then(u=>ho(u,r,i))):ho(c,r,i)}return s.length?Promise.all(s).then(()=>r):r}});function br(e,t,r,n){e.issues.length&&t.issues.push(...Ie(r,e.issues)),e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function gi(e){const t=Object.keys(e.shape);for(const n of t)if(!e.shape[n]._zod.traits.has("$ZodType"))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);const r=us(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function yi(e,t,r,n,o,s){const i=[],a=o.keySet,c=o.catchall._zod,u=c.def.type;for(const l of Object.keys(t)){if(a.has(l))continue;if(u==="never"){i.push(l);continue}const d=c.run({value:t[l],issues:[]},n);d instanceof Promise?e.push(d.then(f=>br(f,r,l,t))):br(d,r,l,t)}return i.length&&r.issues.push({code:"unrecognized_keys",keys:i,input:t,inst:s}),e.length?Promise.all(e).then(()=>r):r}const Dd=p("$ZodObject",(e,t)=>{C.init(e,t);const r=Wt(()=>gi(t));M(e._zod,"propValues",()=>{const i=t.shape,a={};for(const c in i){const u=i[c]._zod;if(u.values){a[c]??(a[c]=new Set);for(const l of u.values)a[c].add(l)}}return a});const n=kt,o=t.catchall;let s;e._zod.parse=(i,a)=>{s??(s=r.value);const c=i.value;if(!n(c))return i.issues.push({expected:"object",code:"invalid_type",input:c,inst:e}),i;i.value={};const u=[],l=s.shape;for(const d of s.keys){const h=l[d]._zod.run({value:c[d],issues:[]},a);h instanceof Promise?u.push(h.then(m=>br(m,i,d,c))):br(h,i,d,c)}return o?yi(u,c,i,a,r.value,e):u.length?Promise.all(u).then(()=>i):i}}),Nd=p("$ZodObjectJIT",(e,t)=>{Dd.init(e,t);const r=e._zod.parse,n=Wt(()=>gi(t)),o=f=>{const h=new Ql(["shape","payload","ctx"]),m=n.value,w=v=>{const T=an(v);return`shape[${T}]._zod.run({ value: input[${T}], issues: [] }, ctx)`};h.write("const input = payload.value;");const _=Object.create(null);let E=0;for(const v of m.keys)_[v]=`key_${E++}`;h.write("const newResult = {}");for(const v of m.keys){const T=_[v],H=an(v);h.write(`const ${T} = ${w(v)};`),h.write(`
        if (${T}.issues.length) {
          payload.issues = payload.issues.concat(${T}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${H}, ...iss.path] : [${H}]
          })));
        }
        
        if (${T}.value === undefined) {
          if (${H} in input) {
            newResult[${H}] = undefined;
          }
        } else {
          newResult[${H}] = ${T}.value;
        }
      `)}h.write("payload.value = newResult;"),h.write("return payload;");const A=h.compile();return(v,T)=>A(f,v,T)};let s;const i=kt,a=!sn.jitless,u=a&&is.value,l=t.catchall;let d;e._zod.parse=(f,h)=>{d??(d=n.value);const m=f.value;return i(m)?a&&u&&h?.async===!1&&h.jitless!==!0?(s||(s=o(t.shape)),f=s(f,h),l?yi([],m,f,h,d,e):f):r(f,h):(f.issues.push({expected:"object",code:"invalid_type",input:m,inst:e}),f)}});function mo(e,t,r,n){for(const s of e)if(s.issues.length===0)return t.value=s.value,t;const o=e.filter(s=>!ut(s));return o.length===1?(t.value=o[0].value,o[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(s=>s.issues.map(i=>Re(i,n,Ze())))}),t)}const wi=p("$ZodUnion",(e,t)=>{C.init(e,t),M(e._zod,"optin",()=>t.options.some(o=>o._zod.optin==="optional")?"optional":void 0),M(e._zod,"optout",()=>t.options.some(o=>o._zod.optout==="optional")?"optional":void 0),M(e._zod,"values",()=>{if(t.options.every(o=>o._zod.values))return new Set(t.options.flatMap(o=>Array.from(o._zod.values)))}),M(e._zod,"pattern",()=>{if(t.options.every(o=>o._zod.pattern)){const o=t.options.map(s=>s._zod.pattern);return new RegExp(`^(${o.map(s=>zr(s.source)).join("|")})$`)}});const r=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(o,s)=>{if(r)return n(o,s);let i=!1;const a=[];for(const c of t.options){const u=c._zod.run({value:o.value,issues:[]},s);if(u instanceof Promise)a.push(u),i=!0;else{if(u.issues.length===0)return u;a.push(u)}}return i?Promise.all(a).then(c=>mo(c,o,e,s)):mo(a,o,e,s)}}),Ld=p("$ZodDiscriminatedUnion",(e,t)=>{wi.init(e,t);const r=e._zod.parse;M(e._zod,"propValues",()=>{const o={};for(const s of t.options){const i=s._zod.propValues;if(!i||Object.keys(i).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(const[a,c]of Object.entries(i)){o[a]||(o[a]=new Set);for(const u of c)o[a].add(u)}}return o});const n=Wt(()=>{const o=t.options,s=new Map;for(const i of o){const a=i._zod.propValues?.[t.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(i)}"`);for(const c of a){if(s.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);s.set(c,i)}}return s});e._zod.parse=(o,s)=>{const i=o.value;if(!kt(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:e}),o;const a=n.value.get(i?.[t.discriminator]);return a?a._zod.run(o,s):t.unionFallback?r(o,s):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:i,path:[t.discriminator],inst:e}),o)}}),Zd=p("$ZodIntersection",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value,s=t.left._zod.run({value:o,issues:[]},n),i=t.right._zod.run({value:o,issues:[]},n);return s instanceof Promise||i instanceof Promise?Promise.all([s,i]).then(([c,u])=>go(r,c,u)):go(r,s,i)}});function cn(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(dt(e)&&dt(t)){const r=Object.keys(t),n=Object.keys(e).filter(s=>r.indexOf(s)!==-1),o={...e,...t};for(const s of n){const i=cn(e[s],t[s]);if(!i.valid)return{valid:!1,mergeErrorPath:[s,...i.mergeErrorPath]};o[s]=i.data}return{valid:!0,data:o}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const o=e[n],s=t[n],i=cn(o,s);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};r.push(i.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function go(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),ut(e))return e;const n=cn(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const bi=p("$ZodTuple",(e,t)=>{C.init(e,t);const r=t.items,n=r.length-[...r].reverse().findIndex(o=>o._zod.optin!=="optional");e._zod.parse=(o,s)=>{const i=o.value;if(!Array.isArray(i))return o.issues.push({input:i,inst:e,expected:"tuple",code:"invalid_type"}),o;o.value=[];const a=[];if(!t.rest){const u=i.length>r.length,l=i.length<n-1;if(u||l)return o.issues.push({...u?{code:"too_big",maximum:r.length}:{code:"too_small",minimum:r.length},input:i,inst:e,origin:"array"}),o}let c=-1;for(const u of r){if(c++,c>=i.length&&c>=n)continue;const l=u._zod.run({value:i[c],issues:[]},s);l instanceof Promise?a.push(l.then(d=>or(d,o,c))):or(l,o,c)}if(t.rest){const u=i.slice(r.length);for(const l of u){c++;const d=t.rest._zod.run({value:l,issues:[]},s);d instanceof Promise?a.push(d.then(f=>or(f,o,c))):or(d,o,c)}}return a.length?Promise.all(a).then(()=>o):o}});function or(e,t,r){e.issues.length&&t.issues.push(...Ie(r,e.issues)),t.value[r]=e.value}const jd=p("$ZodRecord",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!dt(o))return r.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),r;const s=[];if(t.keyType._zod.values){const i=t.keyType._zod.values;r.value={};for(const c of i)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){const u=t.valueType._zod.run({value:o[c],issues:[]},n);u instanceof Promise?s.push(u.then(l=>{l.issues.length&&r.issues.push(...Ie(c,l.issues)),r.value[c]=l.value})):(u.issues.length&&r.issues.push(...Ie(c,u.issues)),r.value[c]=u.value)}let a;for(const c in o)i.has(c)||(a=a??[],a.push(c));a&&a.length>0&&r.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:a})}else{r.value={};for(const i of Reflect.ownKeys(o)){if(i==="__proto__")continue;const a=t.keyType._zod.run({value:i,issues:[]},n);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){r.issues.push({code:"invalid_key",origin:"record",issues:a.issues.map(u=>Re(u,n,Ze())),input:i,path:[i],inst:e}),r.value[a.value]=a.value;continue}const c=t.valueType._zod.run({value:o[i],issues:[]},n);c instanceof Promise?s.push(c.then(u=>{u.issues.length&&r.issues.push(...Ie(i,u.issues)),r.value[a.value]=u.value})):(c.issues.length&&r.issues.push(...Ie(i,c.issues)),r.value[a.value]=c.value)}}return s.length?Promise.all(s).then(()=>r):r}}),Vd=p("$ZodMap",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!(o instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:o,inst:e}),r;const s=[];r.value=new Map;for(const[i,a]of o){const c=t.keyType._zod.run({value:i,issues:[]},n),u=t.valueType._zod.run({value:a,issues:[]},n);c instanceof Promise||u instanceof Promise?s.push(Promise.all([c,u]).then(([l,d])=>{yo(l,d,r,i,o,e,n)})):yo(c,u,r,i,o,e,n)}return s.length?Promise.all(s).then(()=>r):r}});function yo(e,t,r,n,o,s,i){e.issues.length&&(wr.has(typeof n)?r.issues.push(...Ie(n,e.issues)):r.issues.push({code:"invalid_key",origin:"map",input:o,inst:s,issues:e.issues.map(a=>Re(a,i,Ze()))})),t.issues.length&&(wr.has(typeof n)?r.issues.push(...Ie(n,t.issues)):r.issues.push({origin:"map",code:"invalid_element",input:o,inst:s,key:n,issues:t.issues.map(a=>Re(a,i,Ze()))})),r.value.set(e.value,t.value)}const Md=p("$ZodSet",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;if(!(o instanceof Set))return r.issues.push({input:o,inst:e,expected:"set",code:"invalid_type"}),r;const s=[];r.value=new Set;for(const i of o){const a=t.valueType._zod.run({value:i,issues:[]},n);a instanceof Promise?s.push(a.then(c=>wo(c,r))):wo(a,r)}return s.length?Promise.all(s).then(()=>r):r}});function wo(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}const Fd=p("$ZodEnum",(e,t)=>{C.init(e,t);const r=os(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=new RegExp(`^(${r.filter(o=>wr.has(typeof o)).map(o=>typeof o=="string"?et(o):o.toString()).join("|")})$`),e._zod.parse=(o,s)=>{const i=o.value;return n.has(i)||o.issues.push({code:"invalid_value",values:r,input:i,inst:e}),o}}),Bd=p("$ZodLiteral",(e,t)=>{if(C.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(r=>typeof r=="string"?et(r):r?et(r.toString()):String(r)).join("|")})$`),e._zod.parse=(r,n)=>{const o=r.value;return e._zod.values.has(o)||r.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),r}}),qd=p("$ZodFile",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{const o=r.value;return o instanceof File||r.issues.push({expected:"file",code:"invalid_type",input:o,inst:e}),r}}),Kd=p("$ZodTransform",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new $n(e.constructor.name);const o=t.transform(r.value,r);if(n.async)return(o instanceof Promise?o:Promise.resolve(o)).then(i=>(r.value=i,r));if(o instanceof Promise)throw new _t;return r.value=o,r}});function bo(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const Wd=p("$ZodOptional",(e,t)=>{C.init(e,t),e._zod.optin="optional",e._zod.optout="optional",M(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),M(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${zr(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>{if(t.innerType._zod.optin==="optional"){const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>bo(s,r.value)):bo(o,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,n)}}),Hd=p("$ZodNullable",(e,t)=>{C.init(e,t),M(e._zod,"optin",()=>t.innerType._zod.optin),M(e._zod,"optout",()=>t.innerType._zod.optout),M(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${zr(r.source)}|null)$`):void 0}),M(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),Jd=p("$ZodDefault",(e,t)=>{C.init(e,t),e._zod.optin="optional",M(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);if(r.value===void 0)return r.value=t.defaultValue,r;const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>_o(s,t)):_o(o,t)}});function _o(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Gd=p("$ZodPrefault",(e,t)=>{C.init(e,t),e._zod.optin="optional",M(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),Qd=p("$ZodNonOptional",(e,t)=>{C.init(e,t),M(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>vo(s,e)):vo(o,e)}});function vo(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const Yd=p("$ZodSuccess",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new $n("ZodSuccess");const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.issues.length===0,r)):(r.value=o.issues.length===0,r)}}),Xd=p("$ZodCatch",(e,t)=>{C.init(e,t),M(e._zod,"optin",()=>t.innerType._zod.optin),M(e._zod,"optout",()=>t.innerType._zod.optout),M(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(s=>(r.value=s.value,s.issues.length&&(r.value=t.catchValue({...r,error:{issues:s.issues.map(i=>Re(i,n,Ze()))},input:r.value}),r.issues=[]),r)):(r.value=o.value,o.issues.length&&(r.value=t.catchValue({...r,error:{issues:o.issues.map(s=>Re(s,n,Ze()))},input:r.value}),r.issues=[]),r)}}),ef=p("$ZodNaN",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>((typeof r.value!="number"||!Number.isNaN(r.value))&&r.issues.push({input:r.value,inst:e,expected:"nan",code:"invalid_type"}),r)}),tf=p("$ZodPipe",(e,t)=>{C.init(e,t),M(e._zod,"values",()=>t.in._zod.values),M(e._zod,"optin",()=>t.in._zod.optin),M(e._zod,"optout",()=>t.out._zod.optout),M(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if(n.direction==="backward"){const s=t.out._zod.run(r,n);return s instanceof Promise?s.then(i=>sr(i,t.in,n)):sr(s,t.in,n)}const o=t.in._zod.run(r,n);return o instanceof Promise?o.then(s=>sr(s,t.out,n)):sr(o,t.out,n)}});function sr(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const _i=p("$ZodCodec",(e,t)=>{C.init(e,t),M(e._zod,"values",()=>t.in._zod.values),M(e._zod,"optin",()=>t.in._zod.optin),M(e._zod,"optout",()=>t.out._zod.optout),M(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if((n.direction||"forward")==="forward"){const s=t.in._zod.run(r,n);return s instanceof Promise?s.then(i=>ir(i,t,n)):ir(s,t,n)}else{const s=t.out._zod.run(r,n);return s instanceof Promise?s.then(i=>ir(i,t,n)):ir(s,t,n)}}});function ir(e,t,r){if(e.issues.length)return e.aborted=!0,e;if((r.direction||"forward")==="forward"){const o=t.transform(e.value,e);return o instanceof Promise?o.then(s=>ar(e,s,t.out,r)):ar(e,o,t.out,r)}else{const o=t.reverseTransform(e.value,e);return o instanceof Promise?o.then(s=>ar(e,s,t.in,r)):ar(e,o,t.in,r)}}function ar(e,t,r,n){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:t,issues:e.issues},n)}const rf=p("$ZodReadonly",(e,t)=>{C.init(e,t),M(e._zod,"propValues",()=>t.innerType._zod.propValues),M(e._zod,"values",()=>t.innerType._zod.values),M(e._zod,"optin",()=>t.innerType._zod.optin),M(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const o=t.innerType._zod.run(r,n);return o instanceof Promise?o.then(ko):ko(o)}});function ko(e){return e.value=Object.freeze(e.value),e}const nf=p("$ZodTemplateLiteral",(e,t)=>{C.init(e,t);const r=[];for(const n of t.parts)if(typeof n=="object"&&n!==null){if(!n._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...n._zod.traits].shift()}`);const o=n._zod.pattern instanceof RegExp?n._zod.pattern.source:n._zod.pattern;if(!o)throw new Error(`Invalid template literal part: ${n._zod.traits}`);const s=o.startsWith("^")?1:0,i=o.endsWith("$")?o.length-1:o.length;r.push(o.slice(s,i))}else if(n===null||as.has(typeof n))r.push(et(`${n}`));else throw new Error(`Invalid template literal part: ${n}`);e._zod.pattern=new RegExp(`^${r.join("")}$`),e._zod.parse=(n,o)=>typeof n.value!="string"?(n.issues.push({input:n.value,inst:e,expected:"template_literal",code:"invalid_type"}),n):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(n.value)||n.issues.push({input:n.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source}),n)}),of=p("$ZodFunction",(e,t)=>(C.init(e,t),e._def=t,e._zod.def=t,e.implement=r=>{if(typeof r!="function")throw new Error("implement() must be called with a function");return function(...n){const o=e._def.input?lo(e._def.input,n):n,s=Reflect.apply(r,this,o);return e._def.output?lo(e._def.output,s):s}},e.implementAsync=r=>{if(typeof r!="function")throw new Error("implementAsync() must be called with a function");return async function(...n){const o=e._def.input?await fo(e._def.input,n):n,s=await Reflect.apply(r,this,o);return e._def.output?await fo(e._def.output,s):s}},e._zod.parse=(r,n)=>typeof r.value!="function"?(r.issues.push({code:"invalid_type",expected:"function",input:r.value,inst:e}),r):(e._def.output&&e._def.output._zod.def.type==="promise"?r.value=e.implementAsync(r.value):r.value=e.implement(r.value),r),e.input=(...r)=>{const n=e.constructor;return Array.isArray(r[0])?new n({type:"function",input:new bi({type:"tuple",items:r[0],rest:r[1]}),output:e._def.output}):new n({type:"function",input:r[0],output:e._def.output})},e.output=r=>{const n=e.constructor;return new n({type:"function",input:e._def.input,output:r})},e)),sf=p("$ZodPromise",(e,t)=>{C.init(e,t),e._zod.parse=(r,n)=>Promise.resolve(r.value).then(o=>t.innerType._zod.run({value:o,issues:[]},n))}),af=p("$ZodLazy",(e,t)=>{C.init(e,t),M(e._zod,"innerType",()=>t.getter()),M(e._zod,"pattern",()=>e._zod.innerType._zod.pattern),M(e._zod,"propValues",()=>e._zod.innerType._zod.propValues),M(e._zod,"optin",()=>e._zod.innerType._zod.optin??void 0),M(e._zod,"optout",()=>e._zod.innerType._zod.optout??void 0),e._zod.parse=(r,n)=>e._zod.innerType._zod.run(r,n)}),cf=p("$ZodCustom",(e,t)=>{ue.init(e,t),C.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,o=t.fn(n);if(o instanceof Promise)return o.then(s=>Ao(s,r,n,e));Ao(o,r,n,e)}});function Ao(e,t,r,n){if(!e){const o={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(o.params=n._zod.def.params),t.issues.push(At(o))}}const jw=Symbol("ZodOutput"),Vw=Symbol("ZodInput");class uf{constructor(){this._map=new Map,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const o={...n,...this._map.get(t)};return Object.keys(o).length?o:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function lf(){return new uf}const cr=lf();function df(e,t){return new e({type:"string",...y(t)})}function ff(e,t){return new e({type:"string",coerce:!0,...y(t)})}function vi(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...y(t)})}function un(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...y(t)})}function ki(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...y(t)})}function Ai(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...y(t)})}function Ei(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...y(t)})}function Ti(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...y(t)})}function Dn(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...y(t)})}function Si(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...y(t)})}function Ii(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...y(t)})}function Ri(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...y(t)})}function Ui(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...y(t)})}function xi(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...y(t)})}function zi(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...y(t)})}function $i(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...y(t)})}function Oi(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...y(t)})}function Pi(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...y(t)})}function Ci(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...y(t)})}function Di(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...y(t)})}function Ni(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...y(t)})}function Li(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...y(t)})}function Zi(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...y(t)})}function ji(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...y(t)})}const Mw={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6};function pf(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...y(t)})}function hf(e,t){return new e({type:"string",format:"date",check:"string_format",...y(t)})}function mf(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...y(t)})}function gf(e,t){return new e({type:"string",format:"duration",check:"string_format",...y(t)})}function yf(e,t){return new e({type:"number",checks:[],...y(t)})}function wf(e,t){return new e({type:"number",coerce:!0,checks:[],...y(t)})}function bf(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...y(t)})}function _f(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float32",...y(t)})}function vf(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float64",...y(t)})}function kf(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"int32",...y(t)})}function Af(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"uint32",...y(t)})}function Ef(e,t){return new e({type:"boolean",...y(t)})}function Tf(e,t){return new e({type:"boolean",coerce:!0,...y(t)})}function Sf(e,t){return new e({type:"bigint",...y(t)})}function If(e,t){return new e({type:"bigint",coerce:!0,...y(t)})}function Rf(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...y(t)})}function Uf(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...y(t)})}function xf(e,t){return new e({type:"symbol",...y(t)})}function zf(e,t){return new e({type:"undefined",...y(t)})}function $f(e,t){return new e({type:"null",...y(t)})}function Of(e){return new e({type:"any"})}function Pf(e){return new e({type:"unknown"})}function Cf(e,t){return new e({type:"never",...y(t)})}function Df(e,t){return new e({type:"void",...y(t)})}function Nf(e,t){return new e({type:"date",...y(t)})}function Lf(e,t){return new e({type:"date",coerce:!0,...y(t)})}function Zf(e,t){return new e({type:"nan",...y(t)})}function Bt(e,t){return new li({check:"less_than",...y(t),value:e,inclusive:!1})}function Qe(e,t){return new li({check:"less_than",...y(t),value:e,inclusive:!0})}function qt(e,t){return new di({check:"greater_than",...y(t),value:e,inclusive:!1})}function Ce(e,t){return new di({check:"greater_than",...y(t),value:e,inclusive:!0})}function Fw(e){return qt(0,e)}function Bw(e){return Bt(0,e)}function qw(e){return Qe(0,e)}function Kw(e){return Ce(0,e)}function ln(e,t){return new Ol({check:"multiple_of",...y(t),value:e})}function Vi(e,t){return new Dl({check:"max_size",...y(t),maximum:e})}function dn(e,t){return new Nl({check:"min_size",...y(t),minimum:e})}function jf(e,t){return new Ll({check:"size_equals",...y(t),size:e})}function Mi(e,t){return new Zl({check:"max_length",...y(t),maximum:e})}function _r(e,t){return new jl({check:"min_length",...y(t),minimum:e})}function Fi(e,t){return new Vl({check:"length_equals",...y(t),length:e})}function Vf(e,t){return new Ml({check:"string_format",format:"regex",...y(t),pattern:e})}function Mf(e){return new Fl({check:"string_format",format:"lowercase",...y(e)})}function Ff(e){return new Bl({check:"string_format",format:"uppercase",...y(e)})}function Bf(e,t){return new ql({check:"string_format",format:"includes",...y(t),includes:e})}function qf(e,t){return new Kl({check:"string_format",format:"starts_with",...y(t),prefix:e})}function Kf(e,t){return new Wl({check:"string_format",format:"ends_with",...y(t),suffix:e})}function Ww(e,t,r){return new Hl({check:"property",property:e,schema:t,...y(r)})}function Wf(e,t){return new Jl({check:"mime_type",mime:e,...y(t)})}function Gt(e){return new Gl({check:"overwrite",tx:e})}function Hf(e){return Gt(t=>t.normalize(e))}function Jf(){return Gt(e=>e.trim())}function Gf(){return Gt(e=>e.toLowerCase())}function Qf(){return Gt(e=>e.toUpperCase())}function Yf(e,t,r){return new e({type:"array",element:t,...y(r)})}function Hw(e,t,r){return new e({type:"union",options:t,...y(r)})}function Jw(e,t,r,n){return new e({type:"union",options:r,discriminator:t,...y(n)})}function Gw(e,t,r){return new e({type:"intersection",left:t,right:r})}function Qw(e,t,r,n){const o=r instanceof C,s=o?n:r,i=o?r:null;return new e({type:"tuple",items:t,rest:i,...y(s)})}function Yw(e,t,r,n){return new e({type:"record",keyType:t,valueType:r,...y(n)})}function Xw(e,t,r,n){return new e({type:"map",keyType:t,valueType:r,...y(n)})}function eb(e,t,r){return new e({type:"set",valueType:t,...y(r)})}function tb(e,t,r){const n=Array.isArray(t)?Object.fromEntries(t.map(o=>[o,o])):t;return new e({type:"enum",entries:n,...y(r)})}function rb(e,t,r){return new e({type:"enum",entries:t,...y(r)})}function nb(e,t,r){return new e({type:"literal",values:Array.isArray(t)?t:[t],...y(r)})}function Xf(e,t){return new e({type:"file",...y(t)})}function ob(e,t){return new e({type:"transform",transform:t})}function sb(e,t){return new e({type:"optional",innerType:t})}function ib(e,t){return new e({type:"nullable",innerType:t})}function ab(e,t,r){return new e({type:"default",innerType:t,get defaultValue(){return typeof r=="function"?r():Or(r)}})}function cb(e,t,r){return new e({type:"nonoptional",innerType:t,...y(r)})}function ub(e,t){return new e({type:"success",innerType:t})}function lb(e,t,r){return new e({type:"catch",innerType:t,catchValue:typeof r=="function"?r:()=>r})}function db(e,t,r){return new e({type:"pipe",in:t,out:r})}function fb(e,t){return new e({type:"readonly",innerType:t})}function pb(e,t,r){return new e({type:"template_literal",parts:t,...y(r)})}function hb(e,t){return new e({type:"lazy",getter:t})}function mb(e,t){return new e({type:"promise",innerType:t})}function ep(e,t,r){const n=y(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})}function tp(e,t,r){return new e({type:"custom",check:"custom",fn:t,...y(r)})}function rp(e){const t=np(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(At(n,r.value,t._zod.def));else{const o=n;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=r.value),o.inst??(o.inst=t),o.continue??(o.continue=!t._zod.def.abort),r.issues.push(At(o))}},e(r.value,r)));return t}function np(e,t){const r=new ue({check:"custom",...y(t)});return r._zod.check=e,r}function op(e,t){const r=y(t);let n=r.truthy??["true","1","yes","on","y","enabled"],o=r.falsy??["false","0","no","off","n","disabled"];r.case!=="sensitive"&&(n=n.map(h=>typeof h=="string"?h.toLowerCase():h),o=o.map(h=>typeof h=="string"?h.toLowerCase():h));const s=new Set(n),i=new Set(o),a=e.Codec??_i,c=e.Boolean??hi,u=e.String??Vr,l=new u({type:"string",error:r.error}),d=new c({type:"boolean",error:r.error}),f=new a({type:"pipe",in:l,out:d,transform:((h,m)=>{let w=h;return r.case!=="sensitive"&&(w=w.toLowerCase()),s.has(w)?!0:i.has(w)?!1:(m.issues.push({code:"invalid_value",expected:"stringbool",values:[...s,...i],input:m.value,inst:f,continue:!1}),{})}),reverseTransform:((h,m)=>h===!0?n[0]||"true":o[0]||"false"),error:r.error});return f}function Mr(e,t,r,n={}){const o=y(n),s={...y(n),check:"string_format",type:"string",format:t,fn:typeof r=="function"?r:a=>r.test(a),...o};return r instanceof RegExp&&(s.pattern=r),new e(s)}const Bi=p("ZodISODateTime",(e,t)=>{ld.init(e,t),ae.init(e,t)});function qi(e){return pf(Bi,e)}const Ki=p("ZodISODate",(e,t)=>{dd.init(e,t),ae.init(e,t)});function Wi(e){return hf(Ki,e)}const Hi=p("ZodISOTime",(e,t)=>{fd.init(e,t),ae.init(e,t)});function Ji(e){return mf(Hi,e)}const Gi=p("ZodISODuration",(e,t)=>{pd.init(e,t),ae.init(e,t)});function Qi(e){return gf(Gi,e)}const gb=Object.freeze(Object.defineProperty({__proto__:null,ZodISODate:Ki,ZodISODateTime:Bi,ZodISODuration:Gi,ZodISOTime:Hi,date:Wi,datetime:qi,duration:Qi,time:Ji},Symbol.toStringTag,{value:"Module"})),Yi=(e,t)=>{ks.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>nl(e,r)},flatten:{value:r=>rl(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,yr,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,yr,2)}},isEmpty:{get(){return e.issues.length===0}}})},yb=p("ZodError",Yi),_e=p("ZodError",Yi,{Parent:Error}),sp=Dr(_e),ip=Nr(_e),ap=Lr(_e),cp=Zr(_e),up=As(_e),lp=Es(_e),dp=Ts(_e),fp=Ss(_e),pp=Is(_e),hp=Rs(_e),mp=Us(_e),gp=xs(_e),V=p("ZodType",(e,t)=>(C.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),e.clone=(r,n)=>je(e,r,n),e.brand=()=>e,e.register=((r,n)=>(r.add(e,n),e)),e.parse=(r,n)=>sp(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>ap(e,r,n),e.parseAsync=async(r,n)=>ip(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>cp(e,r,n),e.spa=e.safeParseAsync,e.encode=(r,n)=>up(e,r,n),e.decode=(r,n)=>lp(e,r,n),e.encodeAsync=async(r,n)=>dp(e,r,n),e.decodeAsync=async(r,n)=>fp(e,r,n),e.safeEncode=(r,n)=>pp(e,r,n),e.safeDecode=(r,n)=>hp(e,r,n),e.safeEncodeAsync=async(r,n)=>mp(e,r,n),e.safeDecodeAsync=async(r,n)=>gp(e,r,n),e.refine=(r,n)=>e.check(Xp(r,n)),e.superRefine=r=>e.check(eh(r)),e.overwrite=r=>e.check(Gt(r)),e.optional=()=>Rt(e),e.nullable=()=>pn(e),e.nullish=()=>Rt(pn(e)),e.nonoptional=r=>Vp(e,r),e.array=()=>tt(e),e.or=r=>Bn([e,r]),e.and=r=>Rp(e,r),e.transform=r=>hn(e,va(r)),e.default=r=>Lp(e,r),e.prefault=r=>jp(e,r),e.catch=r=>Bp(e,r),e.pipe=r=>hn(e,r),e.readonly=()=>Wp(e),e.describe=r=>{const n=e.clone();return cr.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){return cr.get(e)?.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return cr.get(e);const n=e.clone();return cr.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Xi=p("_ZodString",(e,t)=>{Vr.init(e,t),V.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(Vf(...n)),e.includes=(...n)=>e.check(Bf(...n)),e.startsWith=(...n)=>e.check(qf(...n)),e.endsWith=(...n)=>e.check(Kf(...n)),e.min=(...n)=>e.check(_r(...n)),e.max=(...n)=>e.check(Mi(...n)),e.length=(...n)=>e.check(Fi(...n)),e.nonempty=(...n)=>e.check(_r(1,...n)),e.lowercase=n=>e.check(Mf(n)),e.uppercase=n=>e.check(Ff(n)),e.trim=()=>e.check(Jf()),e.normalize=(...n)=>e.check(Hf(...n)),e.toLowerCase=()=>e.check(Gf()),e.toUpperCase=()=>e.check(Qf())}),Nn=p("ZodString",(e,t)=>{Vr.init(e,t),Xi.init(e,t),e.email=r=>e.check(vi(ea,r)),e.url=r=>e.check(Dn(Zn,r)),e.jwt=r=>e.check(ji(ma,r)),e.emoji=r=>e.check(Si(ta,r)),e.guid=r=>e.check(un(fn,r)),e.uuid=r=>e.check(ki(Ge,r)),e.uuidv4=r=>e.check(Ai(Ge,r)),e.uuidv6=r=>e.check(Ei(Ge,r)),e.uuidv7=r=>e.check(Ti(Ge,r)),e.nanoid=r=>e.check(Ii(ra,r)),e.guid=r=>e.check(un(fn,r)),e.cuid=r=>e.check(Ri(na,r)),e.cuid2=r=>e.check(Ui(oa,r)),e.ulid=r=>e.check(xi(sa,r)),e.base64=r=>e.check(Ni(fa,r)),e.base64url=r=>e.check(Li(pa,r)),e.xid=r=>e.check(zi(ia,r)),e.ksuid=r=>e.check($i(aa,r)),e.ipv4=r=>e.check(Oi(ca,r)),e.ipv6=r=>e.check(Pi(ua,r)),e.cidrv4=r=>e.check(Ci(la,r)),e.cidrv6=r=>e.check(Di(da,r)),e.e164=r=>e.check(Zi(ha,r)),e.datetime=r=>e.check(qi(r)),e.date=r=>e.check(Wi(r)),e.time=r=>e.check(Ji(r)),e.duration=r=>e.check(Qi(r))});function g(e){return df(Nn,e)}const ae=p("ZodStringFormat",(e,t)=>{oe.init(e,t),Xi.init(e,t)}),ea=p("ZodEmail",(e,t)=>{td.init(e,t),ae.init(e,t)});function Ln(e){return vi(ea,e)}const fn=p("ZodGUID",(e,t)=>{Xl.init(e,t),ae.init(e,t)});function wb(e){return un(fn,e)}const Ge=p("ZodUUID",(e,t)=>{ed.init(e,t),ae.init(e,t)});function bb(e){return ki(Ge,e)}function _b(e){return Ai(Ge,e)}function vb(e){return Ei(Ge,e)}function kb(e){return Ti(Ge,e)}const Zn=p("ZodURL",(e,t)=>{rd.init(e,t),ae.init(e,t)});function Ab(e){return Dn(Zn,e)}function Eb(e){return Dn(Zn,{protocol:/^https?$/,hostname:Ks,...y(e)})}const ta=p("ZodEmoji",(e,t)=>{nd.init(e,t),ae.init(e,t)});function Tb(e){return Si(ta,e)}const ra=p("ZodNanoID",(e,t)=>{od.init(e,t),ae.init(e,t)});function Sb(e){return Ii(ra,e)}const na=p("ZodCUID",(e,t)=>{sd.init(e,t),ae.init(e,t)});function Ib(e){return Ri(na,e)}const oa=p("ZodCUID2",(e,t)=>{id.init(e,t),ae.init(e,t)});function Rb(e){return Ui(oa,e)}const sa=p("ZodULID",(e,t)=>{ad.init(e,t),ae.init(e,t)});function Ub(e){return xi(sa,e)}const ia=p("ZodXID",(e,t)=>{cd.init(e,t),ae.init(e,t)});function xb(e){return zi(ia,e)}const aa=p("ZodKSUID",(e,t)=>{ud.init(e,t),ae.init(e,t)});function zb(e){return $i(aa,e)}const ca=p("ZodIPv4",(e,t)=>{hd.init(e,t),ae.init(e,t)});function $b(e){return Oi(ca,e)}const ua=p("ZodIPv6",(e,t)=>{md.init(e,t),ae.init(e,t)});function Ob(e){return Pi(ua,e)}const la=p("ZodCIDRv4",(e,t)=>{gd.init(e,t),ae.init(e,t)});function Pb(e){return Ci(la,e)}const da=p("ZodCIDRv6",(e,t)=>{yd.init(e,t),ae.init(e,t)});function Cb(e){return Di(da,e)}const fa=p("ZodBase64",(e,t)=>{wd.init(e,t),ae.init(e,t)});function Db(e){return Ni(fa,e)}const pa=p("ZodBase64URL",(e,t)=>{_d.init(e,t),ae.init(e,t)});function Nb(e){return Li(pa,e)}const ha=p("ZodE164",(e,t)=>{vd.init(e,t),ae.init(e,t)});function Lb(e){return Zi(ha,e)}const ma=p("ZodJWT",(e,t)=>{Ad.init(e,t),ae.init(e,t)});function Zb(e){return ji(ma,e)}const Fr=p("ZodCustomStringFormat",(e,t)=>{Ed.init(e,t),ae.init(e,t)});function jb(e,t,r={}){return Mr(Fr,e,t,r)}function Vb(e){return Mr(Fr,"hostname",Cn,e)}function Mb(e){return Mr(Fr,"hex",ci,e)}function Fb(e,t){const r=t?.enc??"hex",n=`${e}_${r}`,o=$l[n];if(!o)throw new Error(`Unrecognized hash format: ${n}`);return Mr(Fr,n,o,t)}const jn=p("ZodNumber",(e,t)=>{pi.init(e,t),V.init(e,t),e.gt=(n,o)=>e.check(qt(n,o)),e.gte=(n,o)=>e.check(Ce(n,o)),e.min=(n,o)=>e.check(Ce(n,o)),e.lt=(n,o)=>e.check(Bt(n,o)),e.lte=(n,o)=>e.check(Qe(n,o)),e.max=(n,o)=>e.check(Qe(n,o)),e.int=n=>e.check(Eo(n)),e.safe=n=>e.check(Eo(n)),e.positive=n=>e.check(qt(0,n)),e.nonnegative=n=>e.check(Ce(0,n)),e.negative=n=>e.check(Bt(0,n)),e.nonpositive=n=>e.check(Qe(0,n)),e.multipleOf=(n,o)=>e.check(ln(n,o)),e.step=(n,o)=>e.check(ln(n,o)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function Tt(e){return yf(jn,e)}const Qt=p("ZodNumberFormat",(e,t)=>{Td.init(e,t),jn.init(e,t)});function Eo(e){return bf(Qt,e)}function Bb(e){return _f(Qt,e)}function qb(e){return vf(Qt,e)}function Kb(e){return kf(Qt,e)}function Wb(e){return Af(Qt,e)}const Vn=p("ZodBoolean",(e,t)=>{hi.init(e,t),V.init(e,t)});function Ue(e){return Ef(Vn,e)}const Mn=p("ZodBigInt",(e,t)=>{mi.init(e,t),V.init(e,t),e.gte=(n,o)=>e.check(Ce(n,o)),e.min=(n,o)=>e.check(Ce(n,o)),e.gt=(n,o)=>e.check(qt(n,o)),e.gte=(n,o)=>e.check(Ce(n,o)),e.min=(n,o)=>e.check(Ce(n,o)),e.lt=(n,o)=>e.check(Bt(n,o)),e.lte=(n,o)=>e.check(Qe(n,o)),e.max=(n,o)=>e.check(Qe(n,o)),e.positive=n=>e.check(qt(BigInt(0),n)),e.negative=n=>e.check(Bt(BigInt(0),n)),e.nonpositive=n=>e.check(Qe(BigInt(0),n)),e.nonnegative=n=>e.check(Ce(BigInt(0),n)),e.multipleOf=(n,o)=>e.check(ln(n,o));const r=e._zod.bag;e.minValue=r.minimum??null,e.maxValue=r.maximum??null,e.format=r.format??null});function Hb(e){return Sf(Mn,e)}const ga=p("ZodBigIntFormat",(e,t)=>{Sd.init(e,t),Mn.init(e,t)});function Jb(e){return Rf(ga,e)}function Gb(e){return Uf(ga,e)}const yp=p("ZodSymbol",(e,t)=>{Id.init(e,t),V.init(e,t)});function Qb(e){return xf(yp,e)}const wp=p("ZodUndefined",(e,t)=>{Rd.init(e,t),V.init(e,t)});function Yb(e){return zf(wp,e)}const bp=p("ZodNull",(e,t)=>{Ud.init(e,t),V.init(e,t)});function _p(e){return $f(bp,e)}const vp=p("ZodAny",(e,t)=>{xd.init(e,t),V.init(e,t)});function Xb(){return Of(vp)}const kp=p("ZodUnknown",(e,t)=>{zd.init(e,t),V.init(e,t)});function St(){return Pf(kp)}const Ap=p("ZodNever",(e,t)=>{$d.init(e,t),V.init(e,t)});function ya(e){return Cf(Ap,e)}const Ep=p("ZodVoid",(e,t)=>{Od.init(e,t),V.init(e,t)});function e_(e){return Df(Ep,e)}const wa=p("ZodDate",(e,t)=>{Pd.init(e,t),V.init(e,t),e.min=(n,o)=>e.check(Ce(n,o)),e.max=(n,o)=>e.check(Qe(n,o));const r=e._zod.bag;e.minDate=r.minimum?new Date(r.minimum):null,e.maxDate=r.maximum?new Date(r.maximum):null});function ge(e){return Nf(wa,e)}const Tp=p("ZodArray",(e,t)=>{Cd.init(e,t),V.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(_r(r,n)),e.nonempty=r=>e.check(_r(1,r)),e.max=(r,n)=>e.check(Mi(r,n)),e.length=(r,n)=>e.check(Fi(r,n)),e.unwrap=()=>e.element});function tt(e,t){return Yf(Tp,e,t)}function t_(e){const t=e._zod.def.shape;return It(Object.keys(t))}const Fn=p("ZodObject",(e,t)=>{Nd.init(e,t),V.init(e,t),M(e,"shape",()=>t.shape),e.keyof=()=>It(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:St()}),e.loose=()=>e.clone({...e._zod.def,catchall:St()}),e.strict=()=>e.clone({...e._zod.def,catchall:ya()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>hs(e,r),e.safeExtend=r=>ms(e,r),e.merge=r=>gs(e,r),e.pick=r=>fs(e,r),e.omit=r=>ps(e,r),e.partial=(...r)=>ys(ka,e,r[0]),e.required=(...r)=>ws(Aa,e,r[0])});function F(e,t){const r={type:"object",get shape(){return ze(this,"shape",e?$r(e):{}),this.shape},...y(t)};return new Fn(r)}function r_(e,t){return new Fn({type:"object",get shape(){return ze(this,"shape",$r(e)),this.shape},catchall:ya(),...y(t)})}function n_(e,t){return new Fn({type:"object",get shape(){return ze(this,"shape",$r(e)),this.shape},catchall:St(),...y(t)})}const ba=p("ZodUnion",(e,t)=>{wi.init(e,t),V.init(e,t),e.options=t.options});function Bn(e,t){return new ba({type:"union",options:e,...y(t)})}const Sp=p("ZodDiscriminatedUnion",(e,t)=>{ba.init(e,t),Ld.init(e,t)});function o_(e,t,r){return new Sp({type:"union",options:t,discriminator:e,...y(r)})}const Ip=p("ZodIntersection",(e,t)=>{Zd.init(e,t),V.init(e,t)});function Rp(e,t){return new Ip({type:"intersection",left:e,right:t})}const Up=p("ZodTuple",(e,t)=>{bi.init(e,t),V.init(e,t),e.rest=r=>e.clone({...e._zod.def,rest:r})});function xp(e,t,r){const n=t instanceof C,o=n?r:t,s=n?t:null;return new Up({type:"tuple",items:e,rest:s,...y(o)})}const _a=p("ZodRecord",(e,t)=>{jd.init(e,t),V.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function qn(e,t,r){return new _a({type:"record",keyType:e,valueType:t,...y(r)})}function s_(e,t,r){const n=je(e);return n._zod.values=void 0,new _a({type:"record",keyType:n,valueType:t,...y(r)})}const zp=p("ZodMap",(e,t)=>{Vd.init(e,t),V.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function i_(e,t,r){return new zp({type:"map",keyType:e,valueType:t,...y(r)})}const $p=p("ZodSet",(e,t)=>{Md.init(e,t),V.init(e,t),e.min=(...r)=>e.check(dn(...r)),e.nonempty=r=>e.check(dn(1,r)),e.max=(...r)=>e.check(Vi(...r)),e.size=(...r)=>e.check(jf(...r))});function a_(e,t){return new $p({type:"set",valueType:e,...y(t)})}const vr=p("ZodEnum",(e,t)=>{Fd.init(e,t),V.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,o)=>{const s={};for(const i of n)if(r.has(i))s[i]=t.entries[i];else throw new Error(`Key ${i} not found in enum`);return new vr({...t,checks:[],...y(o),entries:s})},e.exclude=(n,o)=>{const s={...t.entries};for(const i of n)if(r.has(i))delete s[i];else throw new Error(`Key ${i} not found in enum`);return new vr({...t,checks:[],...y(o),entries:s})}});function It(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new vr({type:"enum",entries:r,...y(t)})}function c_(e,t){return new vr({type:"enum",entries:e,...y(t)})}const Op=p("ZodLiteral",(e,t)=>{Bd.init(e,t),V.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function u_(e,t){return new Op({type:"literal",values:Array.isArray(e)?e:[e],...y(t)})}const Pp=p("ZodFile",(e,t)=>{qd.init(e,t),V.init(e,t),e.min=(r,n)=>e.check(dn(r,n)),e.max=(r,n)=>e.check(Vi(r,n)),e.mime=(r,n)=>e.check(Wf(Array.isArray(r)?r:[r],n))});function l_(e){return Xf(Pp,e)}const Cp=p("ZodTransform",(e,t)=>{Kd.init(e,t),V.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new $n(e.constructor.name);r.addIssue=s=>{if(typeof s=="string")r.issues.push(At(s,r.value,t));else{const i=s;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),r.issues.push(At(i))}};const o=t.transform(r.value,r);return o instanceof Promise?o.then(s=>(r.value=s,r)):(r.value=o,r)}});function va(e){return new Cp({type:"transform",transform:e})}const ka=p("ZodOptional",(e,t)=>{Wd.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Rt(e){return new ka({type:"optional",innerType:e})}const Dp=p("ZodNullable",(e,t)=>{Hd.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType});function pn(e){return new Dp({type:"nullable",innerType:e})}function d_(e){return Rt(pn(e))}const Np=p("ZodDefault",(e,t)=>{Jd.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function Lp(e,t){return new Np({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Or(t)}})}const Zp=p("ZodPrefault",(e,t)=>{Gd.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType});function jp(e,t){return new Zp({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Or(t)}})}const Aa=p("ZodNonOptional",(e,t)=>{Qd.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Vp(e,t){return new Aa({type:"nonoptional",innerType:e,...y(t)})}const Mp=p("ZodSuccess",(e,t)=>{Yd.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType});function f_(e){return new Mp({type:"success",innerType:e})}const Fp=p("ZodCatch",(e,t)=>{Xd.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Bp(e,t){return new Fp({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const qp=p("ZodNaN",(e,t)=>{ef.init(e,t),V.init(e,t)});function p_(e){return Zf(qp,e)}const Ea=p("ZodPipe",(e,t)=>{tf.init(e,t),V.init(e,t),e.in=t.in,e.out=t.out});function hn(e,t){return new Ea({type:"pipe",in:e,out:t})}const Ta=p("ZodCodec",(e,t)=>{Ea.init(e,t),_i.init(e,t)});function h_(e,t,r){return new Ta({type:"pipe",in:e,out:t,transform:r.decode,reverseTransform:r.encode})}const Kp=p("ZodReadonly",(e,t)=>{rf.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Wp(e){return new Kp({type:"readonly",innerType:e})}const Hp=p("ZodTemplateLiteral",(e,t)=>{nf.init(e,t),V.init(e,t)});function m_(e,t){return new Hp({type:"template_literal",parts:e,...y(t)})}const Jp=p("ZodLazy",(e,t)=>{af.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.getter()});function Gp(e){return new Jp({type:"lazy",getter:e})}const Qp=p("ZodPromise",(e,t)=>{sf.init(e,t),V.init(e,t),e.unwrap=()=>e._zod.def.innerType});function g_(e){return new Qp({type:"promise",innerType:e})}const Yp=p("ZodFunction",(e,t)=>{of.init(e,t),V.init(e,t)});function y_(e){return new Yp({type:"function",input:Array.isArray(e?.input)?xp(e?.input):e?.input??tt(St()),output:e?.output??St()})}const Kn=p("ZodCustom",(e,t)=>{cf.init(e,t),V.init(e,t)});function w_(e){const t=new ue({check:"custom"});return t._zod.check=e,t}function wt(e,t){return ep(Kn,e??(()=>!0),t)}function Xp(e,t={}){return tp(Kn,e,t)}function eh(e){return rp(e)}function b_(e,t={error:`Input not instance of ${e.name}`}){const r=new Kn({type:"custom",check:"custom",fn:n=>n instanceof e,abort:!0,...y(t)});return r._zod.bag.Class=e,r}const __=(...e)=>op({Codec:Ta,Boolean:Vn,String:Nn},...e);function v_(e){const t=Gp(()=>Bn([g(e),Tt(),Ue(),_p(),tt(t),qn(g(),t)]));return t}function k_(e,t){return hn(va(e),t)}function Yt(e){return ff(Nn,e)}function th(e){return wf(jn,e)}function mn(e){return Tf(Vn,e)}function rh(e){return If(Mn,e)}function nh(e){return Lf(wa,e)}const A_=Object.freeze(Object.defineProperty({__proto__:null,bigint:rh,boolean:mn,date:nh,number:th,string:Yt},Symbol.toStringTag,{value:"Module"})),Sa=globalThis.crypto,lt=Sa.subtle,oh=e=>Sa.getRandomValues(e);var sh=Object.defineProperty,ih=(e,t)=>{for(var r in t)sh(e,r,{get:t[r],enumerable:!0})};function ah(){const e=Object.getOwnPropertyDescriptor(Error,"stackTraceLimit");return e===void 0?Object.isExtensible(Error):Object.prototype.hasOwnProperty.call(e,"writable")?e.writable:e.set!==void 0}function ch(e){const t=e.split(`
    at `);return t.length<=1?e:(t.splice(1,1),t.join(`
    at `))}function uh(e,t){class r extends e{#e;constructor(...o){if(ah()){const i=Error.stackTraceLimit;Error.stackTraceLimit=0,super(...o),Error.stackTraceLimit=i}else super(...o);const s=new Error().stack;s&&(this.#e=ch(s.replace(/^Error/,this.name)))}get errorStack(){return this.#e}get["constructor"](){return t}}return r}var lh={OK:200,CREATED:201,ACCEPTED:202,NO_CONTENT:204,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,PAYLOAD_TOO_LARGE:413,URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,"I'M_A_TEAPOT":418,MISDIRECTED_REQUEST:421,UNPROCESSABLE_ENTITY:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_EARLY:425,UPGRADE_REQUIRED:426,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,REQUEST_HEADER_FIELDS_TOO_LARGE:431,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,VARIANT_ALSO_NEGOTIATES:506,INSUFFICIENT_STORAGE:507,LOOP_DETECTED:508,NOT_EXTENDED:510,NETWORK_AUTHENTICATION_REQUIRED:511},dh=class extends Error{constructor(e="INTERNAL_SERVER_ERROR",t=void 0,r={},n=typeof e=="number"?e:lh[e]){super(t?.message,t?.cause?{cause:t.cause}:void 0),this.status=e,this.body=t,this.headers=r,this.statusCode=n,this.name="APIError",this.status=e,this.headers=r,this.statusCode=n,this.body=t?{code:t?.message?.toUpperCase().replace(/ /g,"_").replace(/[^A-Z0-9_]/g,""),...t}:void 0}},b=uh(dh,Error);function Ia(e){return e instanceof b||e?.name==="APIError"}function fh(e){try{return e.includes("%")?decodeURIComponent(e):e}catch{return e}}function ph(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function hh(e,t,r){let n=0;const o=new WeakMap;return JSON.stringify(e,(i,a)=>{if(typeof a=="bigint")return a.toString();if(typeof a=="object"&&a!==null){if(o.has(a))return`[Circular ref-${o.get(a)}]`;o.set(a,n++)}return a},r)}function mh(e){return!e||typeof e!="object"?!1:"_flag"in e&&e._flag==="json"}function Ra(e,t){if(e instanceof Response)return t?.headers instanceof Headers&&t.headers.forEach((s,i)=>{e.headers.set(i,s)}),e;if(mh(e)){const s=e.body,i=e.routerResponse;if(i instanceof Response)return i;const a=new Headers({...i?.headers,...e.headers,...t?.headers,"Content-Type":"application/json"});return new Response(JSON.stringify(s),{...i,headers:a,status:e.status??t?.status??i?.status,statusText:t?.statusText??i?.statusText})}if(Ia(e))return Ra(e.body,{status:t?.status??e.statusCode,statusText:e.status.toString(),headers:t?.headers||e.headers});let n=e,o=new Headers(t?.headers);return e?typeof e=="string"?(n=e,o.set("Content-Type","text/plain")):e instanceof ArrayBuffer||ArrayBuffer.isView(e)?(n=e,o.set("Content-Type","application/octet-stream")):e instanceof Blob?(n=e,o.set("Content-Type",e.type||"application/octet-stream")):e instanceof FormData?n=e:e instanceof URLSearchParams?(n=e,o.set("Content-Type","application/x-www-form-urlencoded")):e instanceof ReadableStream?(n=e,o.set("Content-Type","application/octet-stream")):ph(e)&&(n=hh(e),o.set("Content-Type","application/json")):(e===null&&(n=JSON.stringify(null)),o.set("content-type","application/json")),new Response(n,{...t,headers:o})}async function gh(e,t={}){let r={body:t.body,query:t.query};if(e.body){const n=await e.body["~standard"].validate(t.body);if(n.issues)return{data:null,error:To(n.issues,"body")};r.body=n.value}if(e.query){const n=await e.query["~standard"].validate(t.query);if(n.issues)return{data:null,error:To(n.issues,"query")};r.query=n.value}return e.requireHeaders&&!t.headers?{data:null,error:{message:"Headers is required"}}:e.requireRequest&&!t.request?{data:null,error:{message:"Request is required"}}:{data:r,error:null}}function To(e,t){for(const r of e)r.message;return{message:`Invalid ${t} parameters`}}var Wn={name:"HMAC",hash:"SHA-256"},Ua=async e=>{const t=typeof e=="string"?new TextEncoder().encode(e):e;return await lt.importKey("raw",t,Wn,!1,["sign","verify"])},yh=async(e,t,r)=>{try{const n=atob(e),o=new Uint8Array(n.length);for(let s=0,i=n.length;s<i;s++)o[s]=n.charCodeAt(s);return await lt.verify(Wn,r,o,new TextEncoder().encode(t))}catch{return!1}},wh=async(e,t)=>{const r=await Ua(t),n=await lt.sign(Wn.name,r,new TextEncoder().encode(e));return btoa(String.fromCharCode(...new Uint8Array(n)))},bh=async(e,t)=>{const r=await wh(e,t);return e=`${e}.${r}`,e=encodeURIComponent(e),e},So=(e,t)=>{let r=e;if(t)if(t==="secure")r="__Secure-"+e;else if(t==="host")r="__Host-"+e;else return;return r};function _h(e){if(typeof e!="string")throw new TypeError("argument str must be a string");const t=new Map;let r=0;for(;r<e.length;){const n=e.indexOf("=",r);if(n===-1)break;let o=e.indexOf(";",r);if(o===-1)o=e.length;else if(o<n){r=e.lastIndexOf(";",n-1)+1;continue}const s=e.slice(r,n).trim();if(!t.has(s)){let i=e.slice(n+1,o).trim();i.codePointAt(0)===34&&(i=i.slice(1,-1)),t.set(s,fh(i))}r=o+1}return t}var xa=(e,t,r={})=>{let n;if(r?.prefix==="secure"?n=`${`__Secure-${e}`}=${t}`:r?.prefix==="host"?n=`${`__Host-${e}`}=${t}`:n=`${e}=${t}`,e.startsWith("__Secure-")&&!r.secure&&(r.secure=!0),e.startsWith("__Host-")&&(r.secure||(r.secure=!0),r.path!=="/"&&(r.path="/"),r.domain&&(r.domain=void 0)),r&&typeof r.maxAge=="number"&&r.maxAge>=0){if(r.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");n+=`; Max-Age=${Math.floor(r.maxAge)}`}if(r.domain&&r.prefix!=="host"&&(n+=`; Domain=${r.domain}`),r.path&&(n+=`; Path=${r.path}`),r.expires){if(r.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");n+=`; Expires=${r.expires.toUTCString()}`}return r.httpOnly&&(n+="; HttpOnly"),r.secure&&(n+="; Secure"),r.sameSite&&(n+=`; SameSite=${r.sameSite.charAt(0).toUpperCase()+r.sameSite.slice(1)}`),r.partitioned&&(r.secure||(r.secure=!0),n+="; Partitioned"),n},vh=(e,t,r)=>(t=encodeURIComponent(t),xa(e,t,r)),kh=async(e,t,r,n)=>(t=await bh(t,r),xa(e,t,n)),za=async(e,{options:t,path:r})=>{const n=new Headers,{data:o,error:s}=await gh(t,e);if(s)throw new b(400,{message:s.message,code:"VALIDATION_ERROR"});const i="headers"in e?e.headers instanceof Headers?e.headers:new Headers(e.headers):"request"in e&&e.request instanceof Request?e.request.headers:null,a=i?.get("cookie"),c=a?_h(a):void 0,u={...e,body:o.body,query:o.query,path:e.path||r,context:"context"in e&&e.context?e.context:{},returned:void 0,headers:e?.headers,request:e?.request,params:"params"in e?e.params:void 0,method:e.method,setHeader:(l,d)=>{n.set(l,d)},getHeader:l=>i?i.get(l):null,getCookie:(l,d)=>{const f=So(l,d);return f&&c?.get(f)||null},getSignedCookie:async(l,d,f)=>{const h=So(l,f);if(!h)return null;const m=c?.get(h);if(!m)return null;const w=m.lastIndexOf(".");if(w<1)return null;const _=m.substring(0,w),E=m.substring(w+1);if(E.length!==44||!E.endsWith("="))return null;const A=await Ua(d);return await yh(E,_,A)?_:!1},setCookie:(l,d,f)=>{const h=vh(l,d,f);return n.append("set-cookie",h),h},setSignedCookie:async(l,d,f,h)=>{const m=await kh(l,d,f,h);return n.append("set-cookie",m),m},redirect:l=>(n.set("location",l),new b("FOUND",void 0,n)),error:(l,d,f)=>new b(l,d,f),json:(l,d)=>e.asResponse?{body:d?.body||l,routerResponse:d,_flag:"json"}:l,responseHeaders:n};for(const l of t.use||[]){const d=await l({...u,returnHeaders:!0,asResponse:!1});d.response&&Object.assign(u.context,d.response),d.headers&&d.headers.forEach((f,h)=>{u.responseHeaders.set(h,f)})}return u};function vt(e,t){const r=async n=>{const o=n,s=typeof e=="function"?e:t,a=await za(o,{options:typeof e=="function"?{}:e,path:"/"});if(!s)throw new Error("handler must be defined");const c=await s(a),u=a.responseHeaders;return o.returnHeaders?{headers:u,response:c}:c};return r.options=typeof e=="function"?{}:e,r}vt.create=e=>{function t(r,n){if(typeof r=="function")return vt({use:e?.use},r);if(!n)throw new Error("Middleware handler is required");return vt({...r,method:"*",use:[...e?.use||[],...r.use||[]]},n)}return t};var gn=(e,t,r)=>{const n=async(...o)=>{const s=o[0]||{},i=await za(s,{options:t,path:e}),a=await r(i).catch(async u=>{if(Ia(u)){const l=t.onAPIError;if(l&&await l(u),s.asResponse)return u}throw u}),c=i.responseHeaders;return s.asResponse?Ra(a,{headers:c}):s.returnHeaders?{headers:c,response:a}:a};return n.options=t,n.path=e,n};gn.create=e=>(t,r,n)=>gn(t,{...r,use:[...r?.use||[],...e?.use||[]]},n);var Ah={};ih(Ah,{BIGINT_FORMAT_RANGES:()=>Qh,Class:()=>dm,NUMBER_FORMAT_RANGES:()=>Gh,aborted:()=>om,allowsEval:()=>Vh,assert:()=>Rh,assertEqual:()=>Eh,assertIs:()=>Sh,assertNever:()=>Ih,assertNotEqual:()=>Th,assignProp:()=>Hn,cached:()=>$a,captureStackTrace:()=>jh,cleanEnum:()=>lm,cleanRegex:()=>Oh,clone:()=>pt,createTransparentProxy:()=>Hh,defineLazy:()=>Ch,esc:()=>Zh,escapeRegex:()=>Kh,extend:()=>em,finalizeIssue:()=>im,floatSafeRemainder:()=>Ph,getElementAtPath:()=>Dh,getEnumValues:()=>Uh,getLengthableOrigin:()=>cm,getParsedType:()=>Fh,getSizableOrigin:()=>am,isObject:()=>yn,isPlainObject:()=>Oa,issue:()=>um,joinValues:()=>xh,jsonStringifyReplacer:()=>zh,merge:()=>tm,normalizeParams:()=>Wh,nullish:()=>$h,numKeys:()=>Mh,omit:()=>Xh,optionalKeys:()=>Jh,partial:()=>rm,pick:()=>Yh,prefixIssues:()=>sm,primitiveTypes:()=>qh,promiseAllObject:()=>Nh,propertyKeyTypes:()=>Bh,randomString:()=>Lh,required:()=>nm,stringifyPrimitive:()=>Pa,unwrapMessage:()=>Vt});function Eh(e){return e}function Th(e){return e}function Sh(e){}function Ih(e){throw new Error}function Rh(e){}function Uh(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,o])=>t.indexOf(+n)===-1).map(([n,o])=>o)}function xh(e,t="|"){return e.map(r=>Pa(r)).join(t)}function zh(e,t){return typeof t=="bigint"?t.toString():t}function $a(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function $h(e){return e==null}function Oh(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function Ph(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,o=r>n?r:n,s=Number.parseInt(e.toFixed(o).replace(".","")),i=Number.parseInt(t.toFixed(o).replace(".",""));return s%i/10**o}function Ch(e,t,r){Object.defineProperty(e,t,{get(){{const n=r();return e[t]=n,n}},set(n){Object.defineProperty(e,t,{value:n})},configurable:!0})}function Hn(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function Dh(e,t){return t?t.reduce((r,n)=>r?.[n],e):e}function Nh(e){const t=Object.keys(e),r=t.map(n=>e[n]);return Promise.all(r).then(n=>{const o={};for(let s=0;s<t.length;s++)o[t[s]]=n[s];return o})}function Lh(e=10){const t="abcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}function Zh(e){return JSON.stringify(e)}var jh=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function yn(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}var Vh=$a(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function Oa(e){if(yn(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(yn(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function Mh(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}var Fh=e=>{const t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(e)?"array":e===null?"null":e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?"promise":typeof Map<"u"&&e instanceof Map?"map":typeof Set<"u"&&e instanceof Set?"set":typeof Date<"u"&&e instanceof Date?"date":typeof File<"u"&&e instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${t}`)}},Bh=new Set(["string","number","symbol"]),qh=new Set(["string","number","bigint","boolean","symbol","undefined"]);function Kh(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function pt(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function Wh(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Hh(e){let t;return new Proxy({},{get(r,n,o){return t??(t=e()),Reflect.get(t,n,o)},set(r,n,o,s){return t??(t=e()),Reflect.set(t,n,o,s)},has(r,n){return t??(t=e()),Reflect.has(t,n)},deleteProperty(r,n){return t??(t=e()),Reflect.deleteProperty(t,n)},ownKeys(r){return t??(t=e()),Reflect.ownKeys(t)},getOwnPropertyDescriptor(r,n){return t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)},defineProperty(r,n,o){return t??(t=e()),Reflect.defineProperty(t,n,o)}})}function Pa(e){return typeof e=="bigint"?e.toString()+"n":typeof e=="string"?`"${e}"`:`${e}`}function Jh(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}var Gh={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},Qh={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function Yh(e,t){const r={},n=e._zod.def;for(const o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(r[o]=n.shape[o])}return pt(e,{...e._zod.def,shape:r,checks:[]})}function Xh(e,t){const r={...e._zod.def.shape},n=e._zod.def;for(const o in t){if(!(o in n.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&delete r[o]}return pt(e,{...e._zod.def,shape:r,checks:[]})}function em(e,t){if(!Oa(t))throw new Error("Invalid input to extend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return Hn(this,"shape",n),n},checks:[]};return pt(e,r)}function tm(e,t){return pt(e,{...e._zod.def,get shape(){const r={...e._zod.def.shape,...t._zod.def.shape};return Hn(this,"shape",r),r},catchall:t._zod.def.catchall,checks:[]})}function rm(e,t,r){const n=t._zod.def.shape,o={...n};if(r)for(const s in r){if(!(s in n))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=e?new e({type:"optional",innerType:n[s]}):n[s])}else for(const s in n)o[s]=e?new e({type:"optional",innerType:n[s]}):n[s];return pt(t,{...t._zod.def,shape:o,checks:[]})}function nm(e,t,r){const n=t._zod.def.shape,o={...n};if(r)for(const s in r){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);r[s]&&(o[s]=new e({type:"nonoptional",innerType:n[s]}))}else for(const s in n)o[s]=new e({type:"nonoptional",innerType:n[s]});return pt(t,{...t._zod.def,shape:o,checks:[]})}function om(e,t=0){for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function sm(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function Vt(e){return typeof e=="string"?e:e?.message}function im(e,t,r){const n={...e,path:e.path??[]};if(!e.message){const o=Vt(e.inst?._zod.def?.error?.(e))??Vt(t?.error?.(e))??Vt(r.customError?.(e))??Vt(r.localeError?.(e))??"Invalid input";n.message=o}return delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function am(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function cm(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function um(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}function lm(e){return Object.entries(e).filter(([t,r])=>Number.isNaN(Number.parseInt(t,10))).map(t=>t[1])}var dm=class{constructor(...e){}};const Ut=(e,t="ms")=>new Date(Date.now()+(t==="sec"?e*1e3:e));function kr(e){return e?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}function Ca(e,t,r){let n="",o=0,s=0;for(const i of e)for(o=o<<8|i,s+=8;s>=6;)s-=6,n+=t[o>>s&63];if(s>0&&(n+=t[o<<6-s&63]),r){const i=(4-n.length%4)%4;n+="=".repeat(i)}return n}function Da(e,t){const r=new Map;for(let i=0;i<t.length;i++)r.set(t[i],i);const n=[];let o=0,s=0;for(const i of e){if(i==="=")break;const a=r.get(i);if(a===void 0)throw new Error(`Invalid Base64 character: ${i}`);o=o<<6|a,s+=6,s>=8&&(s-=8,n.push(o>>s&255))}return Uint8Array.from(n)}const xt={encode(e,t={}){const r=kr(!1),n=typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e);return Ca(n,r,t.padding??!0)},decode(e){typeof e!="string"&&(e=new TextDecoder().decode(e));const t=e.includes("-")||e.includes("_"),r=kr(t);return Da(e,r)}},Br={encode(e,t={}){const r=kr(!0),n=typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e);return Ca(n,r,t.padding??!0)},decode(e){const t=e.includes("-")||e.includes("_"),r=kr(t);return Da(e,r)}},fm="0123456789abcdef",Io={encode:e=>{if(typeof e=="string"&&(e=new TextEncoder().encode(e)),e.byteLength===0)return"";const t=new Uint8Array(e);let r="";for(const n of t)r+=n.toString(16).padStart(2,"0");return r},decode:e=>{if(!e)return"";if(typeof e=="string"){if(e.length%2!==0)throw new Error("Invalid hexadecimal string");if(!new RegExp(`^[${fm}]+$`).test(e))throw new Error("Invalid hexadecimal string");const t=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=parseInt(e.slice(r,r+2),16);return new TextDecoder().decode(t)}return new TextDecoder().decode(e)}},Na=(e="SHA-256",t="none")=>{const r={importKey:async(n,o)=>lt.importKey("raw",typeof n=="string"?new TextEncoder().encode(n):n,{name:"HMAC",hash:{name:e}},!1,[o]),sign:async(n,o)=>{typeof n=="string"&&(n=await r.importKey(n,"sign"));const s=await lt.sign("HMAC",n,typeof o=="string"?new TextEncoder().encode(o):o);return t==="hex"?Io.encode(s):t==="base64"||t==="base64url"||t==="base64urlnopad"?Br.encode(s,{padding:t!=="base64urlnopad"}):s},verify:async(n,o,s)=>(typeof n=="string"&&(n=await r.importKey(n,"verify")),t==="hex"&&(s=Io.decode(s)),(t==="base64"||t==="base64url"||t==="base64urlnopad")&&(s=await xt.decode(s)),lt.verify("HMAC",n,typeof s=="string"?new TextEncoder().encode(s):s,typeof o=="string"?new TextEncoder().encode(o):o))};return r},wn=["info","success","warn","error","debug"];function pm(e,t){return wn.indexOf(t)<=wn.indexOf(e)}const De={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",fg:{red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m"}},hm={info:De.fg.blue,success:De.fg.green,warn:De.fg.yellow,error:De.fg.red,debug:De.fg.magenta},mm=(e,t)=>{const r=new Date().toISOString();return`${De.dim}${r}${De.reset} ${hm[e]}${e.toUpperCase()}${De.reset} ${De.bright}[Better Auth]:${De.reset} ${t}`},gm=e=>{const t="error",r=(o,s,i=[])=>{if(!pm(t,o))return;const a=mm(o,s);{o==="error"?console.error(a,...i):o==="warn"?console.warn(a,...i):console.log(a,...i);return}};return{...Object.fromEntries(wn.map(o=>[o,(...[s,...i])=>r(o,s,i)])),get level(){return t}}},G=gm();function La(e){function t(r,n){if(typeof n=="string"&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z$/.test(n)){const s=new Date(n);if(!isNaN(s.getTime()))return s}return n}try{return typeof e!="string"?e:JSON.parse(e,t)}catch(r){return G.error("Error parsing JSON",{error:r}),null}}const Qr=new Map,ym=new TextEncoder,wm={decode:(e,t="utf-8")=>(Qr.has(t)||Qr.set(t,new TextDecoder(t)),Qr.get(t).decode(e)),encode:ym.encode},Ar=1e3,Er=Ar*60,Tr=Er*60,Kt=Tr*24,bn=Kt*7,Sr=Kt*365.25,_n=Sr/12;function bm(e,t){if(typeof e=="string")return _m(e);if(typeof e=="number")return km(e);throw new Error(`Value provided to ms() must be a string or number. value=${JSON.stringify(e)}`)}function _m(e){if(typeof e!="string"||e.length===0||e.length>100)throw new Error(`Value provided to ms.parse() must be a string with length between 1 and 99. value=${JSON.stringify(e)}`);const t=/^(?<value>-?\d*\.?\d+) *(?<unit>milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)?$/i.exec(e);if(!t?.groups)return NaN;const{value:r,unit:n="ms"}=t.groups,o=parseFloat(r),s=n.toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return o*Sr;case"months":case"month":case"mo":return o*_n;case"weeks":case"week":case"w":return o*bn;case"days":case"day":case"d":return o*Kt;case"hours":case"hour":case"hrs":case"hr":case"h":return o*Tr;case"minutes":case"minute":case"mins":case"min":case"m":return o*Er;case"seconds":case"second":case"secs":case"sec":case"s":return o*Ar;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:throw new Error(`Unknown unit "${s}" provided to ms.parse(). value=${JSON.stringify(e)}`)}}function vm(e){const t=Math.abs(e);return t>=Sr?`${Math.round(e/Sr)}y`:t>=_n?`${Math.round(e/_n)}mo`:t>=bn?`${Math.round(e/bn)}w`:t>=Kt?`${Math.round(e/Kt)}d`:t>=Tr?`${Math.round(e/Tr)}h`:t>=Er?`${Math.round(e/Er)}m`:t>=Ar?`${Math.round(e/Ar)}s`:`${e}ms`}function km(e,t){if(typeof e!="number"||!Number.isFinite(e))throw new Error("Value provided to ms.format() must be of type number.");return vm(e)}async function Za(e,t){if(e.context.options.session?.cookieCache?.enabled){const o={session:Object.entries(t.session).reduce((a,[c,u])=>{const l=e.context.options.session?.additionalFields?.[c];return(!l||l.returned!==!1)&&(a[c]=u),a},{}),user:t.user},s=Ut(e.context.authCookies.sessionData.options.maxAge||60,"sec").getTime(),i=Br.encode(JSON.stringify({session:o,expiresAt:s,signature:await Na("SHA-256","base64urlnopad").sign(e.context.secret,JSON.stringify({...o,expiresAt:s}))}),{padding:!1});if(i.length>4093)throw new pe("Session data is too large to store in the cookie. Please disable session cookie caching or reduce the size of the session data");e.setCookie(e.context.authCookies.sessionData.name,i,e.context.authCookies.sessionData.options)}}async function qe(e,t,r,n){const o=await e.getSignedCookie(e.context.authCookies.dontRememberToken.name,e.context.secret);r=r!==void 0?r:!!o;const s=e.context.authCookies.sessionToken.options,i=r?void 0:e.context.sessionConfig.expiresIn;await e.setSignedCookie(e.context.authCookies.sessionToken.name,t.session.token,e.context.secret,{...s,maxAge:i,...n}),r&&await e.setSignedCookie(e.context.authCookies.dontRememberToken.name,"true",e.context.secret,e.context.authCookies.dontRememberToken.options),await Za(e,t),e.context.setNewSession(t),e.context.options.secondaryStorage&&await e.context.secondaryStorage?.set(t.session.token,JSON.stringify({user:t.user,session:t.session}),Math.floor((new Date(t.session.expiresAt).getTime()-Date.now())/1e3))}function zt(e,t){e.setCookie(e.context.authCookies.sessionToken.name,"",{...e.context.authCookies.sessionToken.options,maxAge:0}),e.setCookie(e.context.authCookies.sessionData.name,"",{...e.context.authCookies.sessionData.options,maxAge:0}),e.setCookie(e.context.authCookies.dontRememberToken.name,"",{...e.context.authCookies.dontRememberToken.options,maxAge:0})}const ja=vt(async()=>({})),ht=vt.create({use:[ja,vt(async()=>({}))]}),X=gn.create({use:[ja]}),Z={FAILED_TO_CREATE_SESSION:"Failed to create session",FAILED_TO_GET_SESSION:"Failed to get session",INVALID_PASSWORD:"Invalid password",INVALID_EMAIL:"Invalid email",INVALID_EMAIL_OR_PASSWORD:"Invalid email or password",PROVIDER_NOT_FOUND:"Provider not found",INVALID_TOKEN:"Invalid token",ID_TOKEN_NOT_SUPPORTED:"id_token not supported",FAILED_TO_GET_USER_INFO:"Failed to get user info",USER_EMAIL_NOT_FOUND:"User email not found",EMAIL_NOT_VERIFIED:"Email not verified",PASSWORD_TOO_SHORT:"Password too short",PASSWORD_TOO_LONG:"Password too long",USER_ALREADY_EXISTS:"User already exists. Use another email.",CREDENTIAL_ACCOUNT_NOT_FOUND:"Credential account not found",SESSION_EXPIRED:"Session expired. Re-authenticate to perform this action.",FAILED_TO_UNLINK_LAST_ACCOUNT:"You can't unlink your last account",ACCOUNT_NOT_FOUND:"Account not found"},Am=Rt(F({disableCookieCache:mn().meta({description:"Disable cookie cache and fetch session from database"}).optional(),disableRefresh:mn().meta({description:"Disable session refresh. Useful for checking session status, without updating the session"}).optional()})),Em=()=>X("/get-session",{method:"GET",query:Am,requireHeaders:!0,metadata:{openapi:{description:"Get the current session",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{session:{$ref:"#/components/schemas/Session"},user:{$ref:"#/components/schemas/User"}},required:["session","user"]}}}}}}}},async e=>{try{const t=await e.getSignedCookie(e.context.authCookies.sessionToken.name,e.context.secret);if(!t)return null;const r=e.getCookie(e.context.authCookies.sessionData.name),n=r?La(wm.decode(Br.decode(r))):null;if(n&&!await Na("SHA-256","base64urlnopad").verify(e.context.secret,JSON.stringify({...n.session,expiresAt:n.expiresAt}),n.signature)){const d=e.context.authCookies.sessionData.name;return e.setCookie(d,"",{maxAge:0}),e.json(null)}const o=await e.getSignedCookie(e.context.authCookies.dontRememberToken.name,e.context.secret);if(n?.session&&e.context.options.session?.cookieCache?.enabled&&!e.query?.disableCookieCache){const l=n.session;if(n.expiresAt<Date.now()||l.session.expiresAt<new Date){const f=e.context.authCookies.sessionData.name;e.setCookie(f,"",{maxAge:0})}else return e.context.session=l,e.json(l)}const s=await e.context.internalAdapter.findSession(t);if(e.context.session=s,!s||s.session.expiresAt<new Date)return zt(e),s&&await e.context.internalAdapter.deleteSession(s.session.token),e.json(null);if(o||e.query?.disableRefresh)return e.json(s);const i=e.context.sessionConfig.expiresIn,a=e.context.sessionConfig.updateAge;if(s.session.expiresAt.valueOf()-i*1e3+a*1e3<=Date.now()&&(!e.query?.disableRefresh||!e.context.options.session?.disableSessionRefresh)){const l=await e.context.internalAdapter.updateSession(s.session.token,{expiresAt:Ut(e.context.sessionConfig.expiresIn,"sec"),updatedAt:new Date});if(!l)return zt(e),e.json(null,{status:401});const d=(l.expiresAt.valueOf()-Date.now())/1e3;return await qe(e,{session:l,user:s.user},!1,{maxAge:d}),e.json({session:l,user:s.user})}return await Za(e,s),e.json(s)}catch(t){throw e.context.logger.error("INTERNAL_SERVER_ERROR",t),new b("INTERNAL_SERVER_ERROR",{message:Z.FAILED_TO_GET_SESSION})}}),Ke=async(e,t)=>{if(e.context.session)return e.context.session;const r=await Em()({...e,asResponse:!1,headers:e.headers,returnHeaders:!1,query:{...t,...e.query}}).catch(n=>null);return e.context.session=r,r},$e=ht(async e=>{const t=await Ke(e);if(!t?.session)throw new b("UNAUTHORIZED");return{session:t}});ht(async e=>{const t=await Ke(e);if(!t?.session&&(e.request||e.headers))throw new b("UNAUTHORIZED");return{session:t}});const Tm=ht(async e=>{const t=await Ke(e);if(!t?.session)throw new b("UNAUTHORIZED");if(e.context.sessionConfig.freshAge===0)return{session:t};const r=e.context.sessionConfig.freshAge,n=t.session.updatedAt?.valueOf()||t.session.createdAt.valueOf();if(!(Date.now()-n<r*1e3))throw new b("FORBIDDEN",{message:"Session is not fresh"});return{session:t}});X("/revoke-session",{method:"POST",body:F({token:g().meta({description:"The token to revoke"})}),use:[$e],requireHeaders:!0,metadata:{openapi:{description:"Revoke a single session",requestBody:{content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",description:"The token to revoke"}},required:["token"]}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the session was revoked successfully"}},required:["status"]}}}}}}}},async e=>{const t=e.body.token,r=await e.context.internalAdapter.findSession(t);if(!r)throw new b("BAD_REQUEST",{message:"Session not found"});if(r.session.userId!==e.context.session.user.id)throw new b("UNAUTHORIZED");try{await e.context.internalAdapter.deleteSession(t)}catch(n){throw e.context.logger.error(n&&typeof n=="object"&&"name"in n?n.name:"",n),new b("INTERNAL_SERVER_ERROR")}return e.json({status:!0})});X("/revoke-sessions",{method:"POST",use:[$e],requireHeaders:!0,metadata:{openapi:{description:"Revoke all sessions for the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all sessions were revoked successfully"}},required:["status"]}}}}}}}},async e=>{try{await e.context.internalAdapter.deleteSessions(e.context.session.user.id)}catch(t){throw e.context.logger.error(t&&typeof t=="object"&&"name"in t?t.name:"",t),new b("INTERNAL_SERVER_ERROR")}return e.json({status:!0})});X("/revoke-other-sessions",{method:"POST",requireHeaders:!0,use:[$e],metadata:{openapi:{description:"Revoke all other sessions for the user except the current one",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all other sessions were revoked successfully"}},required:["status"]}}}}}}}},async e=>{const t=e.context.session;if(!t.user)throw new b("UNAUTHORIZED");const o=(await e.context.internalAdapter.listSessions(t.user.id)).filter(s=>s.expiresAt>new Date).filter(s=>s.token!==e.context.session.session.token);return await Promise.all(o.map(s=>e.context.internalAdapter.deleteSession(s.token))),e.json({status:!0})});function Jn(e,t){return{digest:async r=>{const n=new TextEncoder,o=typeof r=="string"?n.encode(r):r;return await lt.digest(e,o)}}}function mr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function Ro(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Va(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function we(e,...t){if(!Va(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function Uo(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Sm(e,t){we(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Ye=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Im=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Rm=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Rm)throw new Error("Non little-endian hardware is not supported");const Um=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function xm(e){we(e);let t="";for(let r=0;r<e.length;r++)t+=Um[e[r]];return t}const Fe={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function xo(e){if(e>=Fe._0&&e<=Fe._9)return e-Fe._0;if(e>=Fe._A&&e<=Fe._F)return e-(Fe._A-10);if(e>=Fe._a&&e<=Fe._f)return e-(Fe._a-10)}function zm(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){const i=xo(e.charCodeAt(s)),a=xo(e.charCodeAt(s+1));if(i===void 0||a===void 0){const c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[o]=i*16+a}return n}function Ma(e){if(typeof e!="string")throw new Error(`string expected, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function vn(e){if(typeof e=="string")e=Ma(e);else if(Va(e))e=kn(e);else throw new Error(`Uint8Array expected, got ${typeof e}`);return e}function $m(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];we(o),t+=o.length}const r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){const s=e[n];r.set(s,o),o+=s.length}return r}function Om(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Pm(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}const Cm=(e,t)=>(Object.assign(t,e),t);function zo(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),a=Number(r&s),c=4,u=0;e.setUint32(t+c,i,n),e.setUint32(t+u,a,n)}function kn(e){return Uint8Array.from(e)}function $t(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const Fa=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Dm=Fa("expand 16-byte k"),Nm=Fa("expand 32-byte k"),Lm=Ye(Dm),Ba=Ye(Nm);Ba.slice();function U(e,t){return e<<t|e>>>32-t}function An(e){return e.byteOffset%4===0}const ur=64,Zm=16,qa=2**32-1,$o=new Uint32Array;function jm(e,t,r,n,o,s,i,a){const c=o.length,u=new Uint8Array(ur),l=Ye(u),d=An(o)&&An(s),f=d?Ye(o):$o,h=d?Ye(s):$o;for(let m=0;m<c;i++){if(e(t,r,n,l,i,a),i>=qa)throw new Error("arx: counter overflow");const w=Math.min(ur,c-m);if(d&&w===ur){const _=m/4;if(m%4!==0)throw new Error("arx: invalid block position");for(let E=0,A;E<Zm;E++)A=_+E,h[A]=f[A]^l[E];m+=ur;continue}for(let _=0,E;_<w;_++)E=m+_,s[E]=o[E]^u[_];m+=w}}function Vm(e,t){const{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:s,rounds:i}=Om({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return mr(o),mr(i),Ro(s),Ro(r),(a,c,u,l,d=0)=>{we(a),we(c),we(u);const f=u.length;if(l===void 0&&(l=new Uint8Array(f)),we(l),mr(d),d<0||d>=qa)throw new Error("arx: counter overflow");if(l.length<f)throw new Error(`arx: output (${l.length}) is shorter than data (${f})`);const h=[];let m=a.length,w,_;if(m===32)h.push(w=kn(a)),_=Ba;else if(m===16&&r)w=new Uint8Array(32),w.set(a),w.set(a,16),_=Lm,h.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${m}`);An(c)||h.push(c=kn(c));const E=Ye(w);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(_,E,Ye(c.subarray(0,16)),E),c=c.subarray(16)}const A=16-o;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const T=new Uint8Array(12);T.set(c,s?0:12-c.length),c=T,h.push(c)}const v=Ye(c);return jm(e,_,E,v,u,l,d,i),$t(...h),l}}const he=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class Mm{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=vn(t),we(t,32);const r=he(t,0),n=he(t,2),o=he(t,4),s=he(t,6),i=he(t,8),a=he(t,10),c=he(t,12),u=he(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=he(t,16+2*l)}process(t,r,n=!1){const o=n?0:2048,{h:s,r:i}=this,a=i[0],c=i[1],u=i[2],l=i[3],d=i[4],f=i[5],h=i[6],m=i[7],w=i[8],_=i[9],E=he(t,r+0),A=he(t,r+2),v=he(t,r+4),T=he(t,r+6),H=he(t,r+8),x=he(t,r+10),q=he(t,r+12),S=he(t,r+14);let P=s[0]+(E&8191),B=s[1]+((E>>>13|A<<3)&8191),J=s[2]+((A>>>10|v<<6)&8191),K=s[3]+((v>>>7|T<<9)&8191),L=s[4]+((T>>>4|H<<12)&8191),$=s[5]+(H>>>1&8191),D=s[6]+((H>>>14|x<<2)&8191),O=s[7]+((x>>>11|q<<5)&8191),W=s[8]+((q>>>8|S<<8)&8191),k=s[9]+(S>>>5|o),z=0,te=z+P*a+B*(5*_)+J*(5*w)+K*(5*m)+L*(5*h);z=te>>>13,te&=8191,te+=$*(5*f)+D*(5*d)+O*(5*l)+W*(5*u)+k*(5*c),z+=te>>>13,te&=8191;let ie=z+P*c+B*a+J*(5*_)+K*(5*w)+L*(5*m);z=ie>>>13,ie&=8191,ie+=$*(5*h)+D*(5*f)+O*(5*d)+W*(5*l)+k*(5*u),z+=ie>>>13,ie&=8191;let Y=z+P*u+B*c+J*a+K*(5*_)+L*(5*w);z=Y>>>13,Y&=8191,Y+=$*(5*m)+D*(5*h)+O*(5*f)+W*(5*d)+k*(5*l),z+=Y>>>13,Y&=8191;let re=z+P*l+B*u+J*c+K*a+L*(5*_);z=re>>>13,re&=8191,re+=$*(5*w)+D*(5*m)+O*(5*h)+W*(5*f)+k*(5*d),z+=re>>>13,re&=8191;let le=z+P*d+B*l+J*u+K*c+L*a;z=le>>>13,le&=8191,le+=$*(5*_)+D*(5*w)+O*(5*m)+W*(5*h)+k*(5*f),z+=le>>>13,le&=8191;let ve=z+P*f+B*d+J*l+K*u+L*c;z=ve>>>13,ve&=8191,ve+=$*a+D*(5*_)+O*(5*w)+W*(5*m)+k*(5*h),z+=ve>>>13,ve&=8191;let Ve=z+P*h+B*f+J*d+K*l+L*u;z=Ve>>>13,Ve&=8191,Ve+=$*c+D*a+O*(5*_)+W*(5*w)+k*(5*m),z+=Ve>>>13,Ve&=8191;let ne=z+P*m+B*h+J*f+K*d+L*l;z=ne>>>13,ne&=8191,ne+=$*u+D*c+O*a+W*(5*_)+k*(5*w),z+=ne>>>13,ne&=8191;let Me=z+P*w+B*m+J*h+K*f+L*d;z=Me>>>13,Me&=8191,Me+=$*l+D*u+O*c+W*a+k*(5*_),z+=Me>>>13,Me&=8191;let ke=z+P*_+B*w+J*m+K*h+L*f;z=ke>>>13,ke&=8191,ke+=$*d+D*l+O*u+W*c+k*a,z+=ke>>>13,ke&=8191,z=(z<<2)+z|0,z=z+te|0,te=z&8191,z=z>>>13,ie+=z,s[0]=te,s[1]=ie,s[2]=Y,s[3]=re,s[4]=le,s[5]=ve,s[6]=Ve,s[7]=ne,s[8]=Me,s[9]=ke}finalize(){const{h:t,pad:r}=this,n=new Uint16Array(10);let o=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=o,o=t[a]>>>13,t[a]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=t[a]+o,o=n[a]>>>13,n[a]&=8191;n[9]-=8192;let s=(o^1)-1;for(let a=0;a<10;a++)n[a]&=s;s=~s;for(let a=0;a<10;a++)t[a]=t[a]&s|n[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+r[0];t[0]=i&65535;for(let a=1;a<8;a++)i=(t[a]+r[a]|0)+(i>>>16)|0,t[a]=i&65535;$t(n)}update(t){Uo(this);const{buffer:r,blockLen:n}=this;t=vn(t);const o=t.length;for(let s=0;s<o;){const i=Math.min(n-this.pos,o-s);if(i===n){for(;n<=o-s;s+=n)this.process(t,s);continue}r.set(t.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){$t(this.h,this.r,this.buffer,this.pad)}digestInto(t){Uo(this),Sm(t,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let i=0;i<8;i++)t[s++]=n[i]>>>0,t[s++]=n[i]>>>8;return t}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}}function Fm(e){const t=(n,o)=>e(o).update(vn(n)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}const Bm=Fm(e=>new Mm(e));function qm(e,t,r,n,o,s=20){let i=e[0],a=e[1],c=e[2],u=e[3],l=t[0],d=t[1],f=t[2],h=t[3],m=t[4],w=t[5],_=t[6],E=t[7],A=o,v=r[0],T=r[1],H=r[2],x=i,q=a,S=c,P=u,B=l,J=d,K=f,L=h,$=m,D=w,O=_,W=E,k=A,z=v,te=T,ie=H;for(let re=0;re<s;re+=2)x=x+B|0,k=U(k^x,16),$=$+k|0,B=U(B^$,12),x=x+B|0,k=U(k^x,8),$=$+k|0,B=U(B^$,7),q=q+J|0,z=U(z^q,16),D=D+z|0,J=U(J^D,12),q=q+J|0,z=U(z^q,8),D=D+z|0,J=U(J^D,7),S=S+K|0,te=U(te^S,16),O=O+te|0,K=U(K^O,12),S=S+K|0,te=U(te^S,8),O=O+te|0,K=U(K^O,7),P=P+L|0,ie=U(ie^P,16),W=W+ie|0,L=U(L^W,12),P=P+L|0,ie=U(ie^P,8),W=W+ie|0,L=U(L^W,7),x=x+J|0,ie=U(ie^x,16),O=O+ie|0,J=U(J^O,12),x=x+J|0,ie=U(ie^x,8),O=O+ie|0,J=U(J^O,7),q=q+K|0,k=U(k^q,16),W=W+k|0,K=U(K^W,12),q=q+K|0,k=U(k^q,8),W=W+k|0,K=U(K^W,7),S=S+L|0,z=U(z^S,16),$=$+z|0,L=U(L^$,12),S=S+L|0,z=U(z^S,8),$=$+z|0,L=U(L^$,7),P=P+B|0,te=U(te^P,16),D=D+te|0,B=U(B^D,12),P=P+B|0,te=U(te^P,8),D=D+te|0,B=U(B^D,7);let Y=0;n[Y++]=i+x|0,n[Y++]=a+q|0,n[Y++]=c+S|0,n[Y++]=u+P|0,n[Y++]=l+B|0,n[Y++]=d+J|0,n[Y++]=f+K|0,n[Y++]=h+L|0,n[Y++]=m+$|0,n[Y++]=w+D|0,n[Y++]=_+O|0,n[Y++]=E+W|0,n[Y++]=A+k|0,n[Y++]=v+z|0,n[Y++]=T+te|0,n[Y++]=H+ie|0}function Km(e,t,r,n){let o=e[0],s=e[1],i=e[2],a=e[3],c=t[0],u=t[1],l=t[2],d=t[3],f=t[4],h=t[5],m=t[6],w=t[7],_=r[0],E=r[1],A=r[2],v=r[3];for(let H=0;H<20;H+=2)o=o+c|0,_=U(_^o,16),f=f+_|0,c=U(c^f,12),o=o+c|0,_=U(_^o,8),f=f+_|0,c=U(c^f,7),s=s+u|0,E=U(E^s,16),h=h+E|0,u=U(u^h,12),s=s+u|0,E=U(E^s,8),h=h+E|0,u=U(u^h,7),i=i+l|0,A=U(A^i,16),m=m+A|0,l=U(l^m,12),i=i+l|0,A=U(A^i,8),m=m+A|0,l=U(l^m,7),a=a+d|0,v=U(v^a,16),w=w+v|0,d=U(d^w,12),a=a+d|0,v=U(v^a,8),w=w+v|0,d=U(d^w,7),o=o+u|0,v=U(v^o,16),m=m+v|0,u=U(u^m,12),o=o+u|0,v=U(v^o,8),m=m+v|0,u=U(u^m,7),s=s+l|0,_=U(_^s,16),w=w+_|0,l=U(l^w,12),s=s+l|0,_=U(_^s,8),w=w+_|0,l=U(l^w,7),i=i+d|0,E=U(E^i,16),f=f+E|0,d=U(d^f,12),i=i+d|0,E=U(E^i,8),f=f+E|0,d=U(d^f,7),a=a+c|0,A=U(A^a,16),h=h+A|0,c=U(c^h,12),a=a+c|0,A=U(A^a,8),h=h+A|0,c=U(c^h,7);let T=0;n[T++]=o,n[T++]=s,n[T++]=i,n[T++]=a,n[T++]=_,n[T++]=E,n[T++]=A,n[T++]=v}const Wm=Vm(qm,{counterRight:!1,counterLength:8,extendNonceFn:Km,allowShortKeys:!1}),Hm=new Uint8Array(16),Oo=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(Hm.subarray(r))},Jm=new Uint8Array(32);function Po(e,t,r,n,o){const s=e(t,r,Jm),i=Bm.create(s);o&&Oo(i,o),Oo(i,n);const a=new Uint8Array(16),c=Im(a);zo(c,0,BigInt(o?o.length:0),!0),zo(c,8,BigInt(n.length),!0),i.update(a);const u=i.digest();return $t(s,a),u}const Gm=e=>(t,r,n)=>(we(t,32),we(r),{encrypt(s,i){const a=s.length,c=a+16;i?we(i,c):i=new Uint8Array(c),e(t,r,s,i,1);const u=Po(e,t,r,i.subarray(0,-16),n);return i.set(u,a),$t(u),i},decrypt(s,i){const a=s.length,c=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");i?we(i,c):i=new Uint8Array(c);const u=s.subarray(0,-16),l=s.subarray(-16),d=Po(e,t,r,u,n);if(!Pm(l,d))throw new Error("invalid tag");return e(t,r,u,i,1),$t(d),i}}),Ka=Cm({blockSize:64,nonceLength:24,tagLength:16},Gm(Wm)),Yr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Qm(e=32){if(Yr&&typeof Yr.getRandomValues=="function")return Yr.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Wa(e){return mr(e.nonceLength),((t,...r)=>({encrypt(n,...o){const{nonceLength:s}=e,i=Qm(s),a=e(t,i,...r).encrypt(n,...o),c=$m(i,a);return a.fill(0),c},decrypt(n,...o){const{nonceLength:s}=e,i=n.subarray(0,s),a=n.subarray(s);return e(t,i,...r).decrypt(a,...o)}}))}const qr=crypto,Ha=e=>e instanceof CryptoKey,Ne=new TextEncoder,rt=new TextDecoder;function Ja(...e){const t=e.reduce((o,{length:s})=>o+s,0),r=new Uint8Array(t);let n=0;for(const o of e)r.set(o,n),n+=o.length;return r}const Ym=e=>{let t=e;typeof t=="string"&&(t=Ne.encode(t));const r=32768,n=[];for(let o=0;o<t.length;o+=r)n.push(String.fromCharCode.apply(null,t.subarray(o,o+r)));return btoa(n.join(""))},Xr=e=>Ym(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),Xm=e=>{const t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r},Xe=e=>{let t=e;t instanceof Uint8Array&&(t=rt.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return Xm(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}};class me extends Error{constructor(t,r){super(t,r),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}me.code="ERR_JOSE_GENERIC";class Ee extends me{constructor(t,r,n="unspecified",o="unspecified"){super(t,{cause:{claim:n,reason:o,payload:r}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=n,this.reason=o,this.payload=r}}Ee.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class Ir extends me{constructor(t,r,n="unspecified",o="unspecified"){super(t,{cause:{claim:n,reason:o,payload:r}}),this.code="ERR_JWT_EXPIRED",this.claim=n,this.reason=o,this.payload=r}}Ir.code="ERR_JWT_EXPIRED";class Ga extends me{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}Ga.code="ERR_JOSE_ALG_NOT_ALLOWED";class Le extends me{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}Le.code="ERR_JOSE_NOT_SUPPORTED";class eg extends me{constructor(t="decryption operation failed",r){super(t,r),this.code="ERR_JWE_DECRYPTION_FAILED"}}eg.code="ERR_JWE_DECRYPTION_FAILED";class tg extends me{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}}tg.code="ERR_JWE_INVALID";class ce extends me{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}ce.code="ERR_JWS_INVALID";class Se extends me{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}Se.code="ERR_JWT_INVALID";class rg extends me{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}}rg.code="ERR_JWK_INVALID";class Gn extends me{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}}Gn.code="ERR_JWKS_INVALID";class Qn extends me{constructor(t="no applicable key found in the JSON Web Key Set",r){super(t,r),this.code="ERR_JWKS_NO_MATCHING_KEY"}}Qn.code="ERR_JWKS_NO_MATCHING_KEY";class Qa extends me{constructor(t="multiple matching keys found in the JSON Web Key Set",r){super(t,r),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}Qa.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class Ya extends me{constructor(t="request timed out",r){super(t,r),this.code="ERR_JWKS_TIMEOUT"}}Ya.code="ERR_JWKS_TIMEOUT";class Xa extends me{constructor(t="signature verification failed",r){super(t,r),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}Xa.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";function Oe(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function Lt(e,t){return e.name===t}function en(e){return parseInt(e.name.slice(4),10)}function ng(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function og(e,t){if(t.length&&!t.some(r=>e.usages.includes(r))){let r="CryptoKey does not support this operation, its usages must include ";if(t.length>2){const n=t.pop();r+=`one of ${t.join(", ")}, or ${n}.`}else t.length===2?r+=`one of ${t[0]} or ${t[1]}.`:r+=`${t[0]}.`;throw new TypeError(r)}}function sg(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!Lt(e.algorithm,"HMAC"))throw Oe("HMAC");const n=parseInt(t.slice(2),10);if(en(e.algorithm.hash)!==n)throw Oe(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!Lt(e.algorithm,"RSASSA-PKCS1-v1_5"))throw Oe("RSASSA-PKCS1-v1_5");const n=parseInt(t.slice(2),10);if(en(e.algorithm.hash)!==n)throw Oe(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!Lt(e.algorithm,"RSA-PSS"))throw Oe("RSA-PSS");const n=parseInt(t.slice(2),10);if(en(e.algorithm.hash)!==n)throw Oe(`SHA-${n}`,"algorithm.hash");break}case"EdDSA":{if(e.algorithm.name!=="Ed25519"&&e.algorithm.name!=="Ed448")throw Oe("Ed25519 or Ed448");break}case"Ed25519":{if(!Lt(e.algorithm,"Ed25519"))throw Oe("Ed25519");break}case"ES256":case"ES384":case"ES512":{if(!Lt(e.algorithm,"ECDSA"))throw Oe("ECDSA");const n=ng(t);if(e.algorithm.namedCurve!==n)throw Oe(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}og(e,r)}function ec(e,t,...r){if(r=r.filter(Boolean),r.length>2){const n=r.pop();e+=`one of type ${r.join(", ")}, or ${n}.`}else r.length===2?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const Co=(e,...t)=>ec("Key must be ",e,...t);function tc(e,t,...r){return ec(`Key for the ${e} algorithm must be `,t,...r)}const rc=e=>Ha(e)?!0:e?.[Symbol.toStringTag]==="KeyObject",Rr=["CryptoKey"],nc=(...e)=>{const t=e.filter(Boolean);if(t.length===0||t.length===1)return!0;let r;for(const n of t){const o=Object.keys(n);if(!r||r.size===0){r=new Set(o);continue}for(const s of o){if(r.has(s))return!1;r.add(s)}}return!0};function ig(e){return typeof e=="object"&&e!==null}function xe(e){if(!ig(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}const oc=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if(typeof r!="number"||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}};function Pt(e){return xe(e)&&typeof e.kty=="string"}function ag(e){return e.kty!=="oct"&&typeof e.d=="string"}function cg(e){return e.kty!=="oct"&&typeof e.d>"u"}function ug(e){return Pt(e)&&e.kty==="oct"&&typeof e.k=="string"}function lg(e){let t,r;switch(e.kty){case"RSA":{switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new Le('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new Le('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(e.alg){case"Ed25519":t={name:"Ed25519"},r=e.d?["sign"]:["verify"];break;case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new Le('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new Le('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}const sc=async e=>{if(!e.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:t,keyUsages:r}=lg(e),n=[t,e.ext??!1,e.key_ops??r],o={...e};return delete o.alg,delete o.use,qr.subtle.importKey("jwk",o,...n)},ic=e=>Xe(e);let mt,gt;const ac=e=>e?.[Symbol.toStringTag]==="KeyObject",Ur=async(e,t,r,n,o=!1)=>{let s=e.get(t);if(s?.[n])return s[n];const i=await sc({...r,alg:n});return o&&Object.freeze(t),s?s[n]=i:e.set(t,{[n]:i}),i},dg=(e,t)=>{if(ac(e)){let r=e.export({format:"jwk"});return delete r.d,delete r.dp,delete r.dq,delete r.p,delete r.q,delete r.qi,r.k?ic(r.k):(gt||(gt=new WeakMap),Ur(gt,e,r,t))}return Pt(e)?e.k?Xe(e.k):(gt||(gt=new WeakMap),Ur(gt,e,e,t,!0)):e},fg=(e,t)=>{if(ac(e)){let r=e.export({format:"jwk"});return r.k?ic(r.k):(mt||(mt=new WeakMap),Ur(mt,e,r,t))}return Pt(e)?e.k?Xe(e.k):(mt||(mt=new WeakMap),Ur(mt,e,e,t,!0)):e},Do={normalizePublicKey:dg,normalizePrivateKey:fg};async function Kr(e,t){if(!xe(e))throw new TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if(typeof e.k!="string"||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return Xe(e.k);case"RSA":if("oth"in e&&e.oth!==void 0)throw new Le('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return sc({...e,alg:t});default:throw new Le('Unsupported "kty" (Key Type) Parameter value')}}const bt=e=>e?.[Symbol.toStringTag],En=(e,t,r)=>{if(t.use!==void 0&&t.use!=="sig")throw new TypeError("Invalid key for this operation, when present its use must be sig");if(t.key_ops!==void 0&&t.key_ops.includes?.(r)!==!0)throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${r}`);if(t.alg!==void 0&&t.alg!==e)throw new TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0},pg=(e,t,r,n)=>{if(!(t instanceof Uint8Array)){if(n&&Pt(t)){if(ug(t)&&En(e,t,r))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!rc(t))throw new TypeError(tc(e,t,...Rr,"Uint8Array",n?"JSON Web Key":null));if(t.type!=="secret")throw new TypeError(`${bt(t)} instances for symmetric algorithms must be of type "secret"`)}},hg=(e,t,r,n)=>{if(n&&Pt(t))switch(r){case"sign":if(ag(t)&&En(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(cg(t)&&En(e,t,r))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!rc(t))throw new TypeError(tc(e,t,...Rr,n?"JSON Web Key":null));if(t.type==="secret")throw new TypeError(`${bt(t)} instances for asymmetric algorithms must not be of type "secret"`);if(r==="sign"&&t.type==="public")throw new TypeError(`${bt(t)} instances for asymmetric algorithm signing must be of type "private"`);if(r==="decrypt"&&t.type==="public")throw new TypeError(`${bt(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&r==="verify"&&t.type==="private")throw new TypeError(`${bt(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&r==="encrypt"&&t.type==="private")throw new TypeError(`${bt(t)} instances for asymmetric algorithm encryption must be of type "public"`)};function cc(e,t,r,n){t.startsWith("HS")||t==="dir"||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?pg(t,r,n,e):hg(t,r,n,e)}cc.bind(void 0,!1);const Tn=cc.bind(void 0,!0);function uc(e,t,r,n,o){if(o.crit!==void 0&&n?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||n.crit===void 0)return new Set;if(!Array.isArray(n.crit)||n.crit.length===0||n.crit.some(i=>typeof i!="string"||i.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let s;r!==void 0?s=new Map([...Object.entries(r),...t.entries()]):s=t;for(const i of n.crit){if(!s.has(i))throw new Le(`Extension Header Parameter "${i}" is not recognized`);if(o[i]===void 0)throw new e(`Extension Header Parameter "${i}" is missing`);if(s.get(i)&&n[i]===void 0)throw new e(`Extension Header Parameter "${i}" MUST be integrity protected`)}return new Set(n.crit)}const mg=(e,t)=>{if(t!==void 0&&(!Array.isArray(t)||t.some(r=>typeof r!="string")))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};function lc(e,t){const r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case"Ed25519":return{name:"Ed25519"};case"EdDSA":return{name:t.name};default:throw new Le(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}async function dc(e,t,r){if(r==="sign"&&(t=await Do.normalizePrivateKey(t,e)),r==="verify"&&(t=await Do.normalizePublicKey(t,e)),Ha(t))return sg(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(Co(t,...Rr));return qr.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError(Co(t,...Rr,"Uint8Array","JSON Web Key"))}const gg=async(e,t,r,n)=>{const o=await dc(e,t,"verify");oc(e,o);const s=lc(e,o.algorithm);try{return await qr.subtle.verify(s,o,r,n)}catch{return!1}};async function yg(e,t,r){if(!xe(e))throw new ce("Flattened JWS must be an object");if(e.protected===void 0&&e.header===void 0)throw new ce('Flattened JWS must have either of the "protected" or "header" members');if(e.protected!==void 0&&typeof e.protected!="string")throw new ce("JWS Protected Header incorrect type");if(e.payload===void 0)throw new ce("JWS Payload missing");if(typeof e.signature!="string")throw new ce("JWS Signature missing or incorrect type");if(e.header!==void 0&&!xe(e.header))throw new ce("JWS Unprotected Header incorrect type");let n={};if(e.protected)try{const w=Xe(e.protected);n=JSON.parse(rt.decode(w))}catch{throw new ce("JWS Protected Header is invalid")}if(!nc(n,e.header))throw new ce("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const o={...n,...e.header},s=uc(ce,new Map([["b64",!0]]),r?.crit,n,o);let i=!0;if(s.has("b64")&&(i=n.b64,typeof i!="boolean"))throw new ce('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:a}=o;if(typeof a!="string"||!a)throw new ce('JWS "alg" (Algorithm) Header Parameter missing or invalid');const c=r&&mg("algorithms",r.algorithms);if(c&&!c.has(a))throw new Ga('"alg" (Algorithm) Header Parameter value not allowed');if(i){if(typeof e.payload!="string")throw new ce("JWS Payload must be a string")}else if(typeof e.payload!="string"&&!(e.payload instanceof Uint8Array))throw new ce("JWS Payload must be a string or an Uint8Array instance");let u=!1;typeof t=="function"?(t=await t(n,e),u=!0,Tn(a,t,"verify"),Pt(t)&&(t=await Kr(t,a))):Tn(a,t,"verify");const l=Ja(Ne.encode(e.protected??""),Ne.encode("."),typeof e.payload=="string"?Ne.encode(e.payload):e.payload);let d;try{d=Xe(e.signature)}catch{throw new ce("Failed to base64url decode the signature")}if(!await gg(a,t,d,l))throw new Xa;let h;if(i)try{h=Xe(e.payload)}catch{throw new ce("Failed to base64url decode the payload")}else typeof e.payload=="string"?h=Ne.encode(e.payload):h=e.payload;const m={payload:h};return e.protected!==void 0&&(m.protectedHeader=n),e.header!==void 0&&(m.unprotectedHeader=e.header),u?{...m,key:t}:m}async function wg(e,t,r){if(e instanceof Uint8Array&&(e=rt.decode(e)),typeof e!="string")throw new ce("Compact JWS must be a string or Uint8Array");const{0:n,1:o,2:s,length:i}=e.split(".");if(i!==3)throw new ce("Invalid Compact JWS");const a=await yg({payload:o,protected:n,signature:s},t,r),c={payload:a.payload,protectedHeader:a.protectedHeader};return typeof t=="function"?{...c,key:a.key}:c}const Je=e=>Math.floor(e.getTime()/1e3),fc=60,pc=fc*60,Yn=pc*24,bg=Yn*7,_g=Yn*365.25,vg=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,Mt=e=>{const t=vg.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");const r=parseFloat(t[2]),n=t[3].toLowerCase();let o;switch(n){case"sec":case"secs":case"second":case"seconds":case"s":o=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":o=Math.round(r*fc);break;case"hour":case"hours":case"hr":case"hrs":case"h":o=Math.round(r*pc);break;case"day":case"days":case"d":o=Math.round(r*Yn);break;case"week":case"weeks":case"w":o=Math.round(r*bg);break;default:o=Math.round(r*_g);break}return t[1]==="-"||t[4]==="ago"?-o:o},No=e=>e.toLowerCase().replace(/^application\//,""),kg=(e,t)=>typeof e=="string"?t.includes(e):Array.isArray(e)?t.some(Set.prototype.has.bind(new Set(e))):!1,Ag=(e,t,r={})=>{let n;try{n=JSON.parse(rt.decode(t))}catch{}if(!xe(n))throw new Se("JWT Claims Set must be a top-level JSON object");const{typ:o}=r;if(o&&(typeof e.typ!="string"||No(e.typ)!==No(o)))throw new Ee('unexpected "typ" JWT header value',n,"typ","check_failed");const{requiredClaims:s=[],issuer:i,subject:a,audience:c,maxTokenAge:u}=r,l=[...s];u!==void 0&&l.push("iat"),c!==void 0&&l.push("aud"),a!==void 0&&l.push("sub"),i!==void 0&&l.push("iss");for(const m of new Set(l.reverse()))if(!(m in n))throw new Ee(`missing required "${m}" claim`,n,m,"missing");if(i&&!(Array.isArray(i)?i:[i]).includes(n.iss))throw new Ee('unexpected "iss" claim value',n,"iss","check_failed");if(a&&n.sub!==a)throw new Ee('unexpected "sub" claim value',n,"sub","check_failed");if(c&&!kg(n.aud,typeof c=="string"?[c]:c))throw new Ee('unexpected "aud" claim value',n,"aud","check_failed");let d;switch(typeof r.clockTolerance){case"string":d=Mt(r.clockTolerance);break;case"number":d=r.clockTolerance;break;case"undefined":d=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:f}=r,h=Je(f||new Date);if((n.iat!==void 0||u)&&typeof n.iat!="number")throw new Ee('"iat" claim must be a number',n,"iat","invalid");if(n.nbf!==void 0){if(typeof n.nbf!="number")throw new Ee('"nbf" claim must be a number',n,"nbf","invalid");if(n.nbf>h+d)throw new Ee('"nbf" claim timestamp check failed',n,"nbf","check_failed")}if(n.exp!==void 0){if(typeof n.exp!="number")throw new Ee('"exp" claim must be a number',n,"exp","invalid");if(n.exp<=h-d)throw new Ir('"exp" claim timestamp check failed',n,"exp","check_failed")}if(u){const m=h-n.iat,w=typeof u=="number"?u:Mt(u);if(m-d>w)throw new Ir('"iat" claim timestamp check failed (too far in the past)',n,"iat","check_failed");if(m<0-d)throw new Ee('"iat" claim timestamp check failed (it should be in the past)',n,"iat","check_failed")}return n};async function Wr(e,t,r){const n=await wg(e,t,r);if(n.protectedHeader.crit?.includes("b64")&&n.protectedHeader.b64===!1)throw new Se("JWTs MUST NOT use unencoded payload");const s={payload:Ag(n.protectedHeader,n.payload,r),protectedHeader:n.protectedHeader};return typeof t=="function"?{...s,key:n.key}:s}const Eg=async(e,t,r)=>{const n=await dc(e,t,"sign");oc(e,n);const o=await qr.subtle.sign(lc(e,n.algorithm),n,r);return new Uint8Array(o)};class Tg{constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=t}setProtectedHeader(t){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}async sign(t,r){if(!this._protectedHeader&&!this._unprotectedHeader)throw new ce("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!nc(this._protectedHeader,this._unprotectedHeader))throw new ce("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const n={...this._protectedHeader,...this._unprotectedHeader},o=uc(ce,new Map([["b64",!0]]),r?.crit,this._protectedHeader,n);let s=!0;if(o.has("b64")&&(s=this._protectedHeader.b64,typeof s!="boolean"))throw new ce('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:i}=n;if(typeof i!="string"||!i)throw new ce('JWS "alg" (Algorithm) Header Parameter missing or invalid');Tn(i,t,"sign");let a=this._payload;s&&(a=Ne.encode(Xr(a)));let c;this._protectedHeader?c=Ne.encode(Xr(JSON.stringify(this._protectedHeader))):c=Ne.encode("");const u=Ja(c,Ne.encode("."),a),l=await Eg(i,t,u),d={signature:Xr(l),payload:""};return s&&(d.payload=rt.decode(a)),this._unprotectedHeader&&(d.header=this._unprotectedHeader),this._protectedHeader&&(d.protected=rt.decode(c)),d}}class Sg{constructor(t){this._flattened=new Tg(t)}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}async sign(t,r){const n=await this._flattened.sign(t,r);if(n.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}}function at(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}class Ig{constructor(t={}){if(!xe(t))throw new TypeError("JWT Claims Set MUST be an object");this._payload=t}setIssuer(t){return this._payload={...this._payload,iss:t},this}setSubject(t){return this._payload={...this._payload,sub:t},this}setAudience(t){return this._payload={...this._payload,aud:t},this}setJti(t){return this._payload={...this._payload,jti:t},this}setNotBefore(t){return typeof t=="number"?this._payload={...this._payload,nbf:at("setNotBefore",t)}:t instanceof Date?this._payload={...this._payload,nbf:at("setNotBefore",Je(t))}:this._payload={...this._payload,nbf:Je(new Date)+Mt(t)},this}setExpirationTime(t){return typeof t=="number"?this._payload={...this._payload,exp:at("setExpirationTime",t)}:t instanceof Date?this._payload={...this._payload,exp:at("setExpirationTime",Je(t))}:this._payload={...this._payload,exp:Je(new Date)+Mt(t)},this}setIssuedAt(t){return typeof t>"u"?this._payload={...this._payload,iat:Je(new Date)}:t instanceof Date?this._payload={...this._payload,iat:at("setIssuedAt",Je(t))}:typeof t=="string"?this._payload={...this._payload,iat:at("setIssuedAt",Je(new Date)+Mt(t))}:this._payload={...this._payload,iat:at("setIssuedAt",t)},this}}class Rg extends Ig{setProtectedHeader(t){return this._protectedHeader=t,this}async sign(t,r){const n=new Sg(Ne.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&this._protectedHeader.b64===!1)throw new Se("JWTs MUST NOT use unencoded payload");return n.sign(t,r)}}function Ug(e){switch(typeof e=="string"&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new Le('Unsupported "alg" value for a JSON Web Key Set')}}function xg(e){return e&&typeof e=="object"&&Array.isArray(e.keys)&&e.keys.every(zg)}function zg(e){return xe(e)}function hc(e){return typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}class $g{constructor(t){if(this._cached=new WeakMap,!xg(t))throw new Gn("JSON Web Key Set malformed");this._jwks=hc(t)}async getKey(t,r){const{alg:n,kid:o}={...t,...r?.header},s=Ug(n),i=this._jwks.keys.filter(u=>{let l=s===u.kty;if(l&&typeof o=="string"&&(l=o===u.kid),l&&typeof u.alg=="string"&&(l=n===u.alg),l&&typeof u.use=="string"&&(l=u.use==="sig"),l&&Array.isArray(u.key_ops)&&(l=u.key_ops.includes("verify")),l)switch(n){case"ES256":l=u.crv==="P-256";break;case"ES256K":l=u.crv==="secp256k1";break;case"ES384":l=u.crv==="P-384";break;case"ES512":l=u.crv==="P-521";break;case"Ed25519":l=u.crv==="Ed25519";break;case"EdDSA":l=u.crv==="Ed25519"||u.crv==="Ed448";break}return l}),{0:a,length:c}=i;if(c===0)throw new Qn;if(c!==1){const u=new Qa,{_cached:l}=this;throw u[Symbol.asyncIterator]=async function*(){for(const d of i)try{yield await Lo(l,d,n)}catch{}},u}return Lo(this._cached,a,n)}}async function Lo(e,t,r){const n=e.get(t)||e.set(t,{}).get(t);if(n[r]===void 0){const o=await Kr({...t,ext:!0},r);if(o instanceof Uint8Array||o.type!=="public")throw new Gn("JSON Web Key Set members must be public keys");n[r]=o}return n[r]}function Zo(e){const t=new $g(e),r=async(n,o)=>t.getKey(n,o);return Object.defineProperties(r,{jwks:{value:()=>hc(t._jwks),enumerable:!0,configurable:!1,writable:!1}}),r}const Og=async(e,t,r)=>{let n,o,s=!1;typeof AbortController=="function"&&(n=new AbortController,o=setTimeout(()=>{s=!0,n.abort()},t));const i=await fetch(e.href,{signal:n?n.signal:void 0,redirect:"manual",headers:r.headers}).catch(a=>{throw s?new Ya:a});if(o!==void 0&&clearTimeout(o),i.status!==200)throw new me("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await i.json()}catch{throw new me("Failed to parse the JSON Web Key Set HTTP response as JSON")}};function Pg(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}let Sn;(typeof navigator>"u"||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(Sn="jose/v5.10.0");const tn=Symbol();function Cg(e,t){return!(typeof e!="object"||e===null||!("uat"in e)||typeof e.uat!="number"||Date.now()-e.uat>=t||!("jwks"in e)||!xe(e.jwks)||!Array.isArray(e.jwks.keys)||!Array.prototype.every.call(e.jwks.keys,xe))}class Dg{constructor(t,r){if(!(t instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(t.href),this._options={agent:r?.agent,headers:r?.headers},this._timeoutDuration=typeof r?.timeoutDuration=="number"?r?.timeoutDuration:5e3,this._cooldownDuration=typeof r?.cooldownDuration=="number"?r?.cooldownDuration:3e4,this._cacheMaxAge=typeof r?.cacheMaxAge=="number"?r?.cacheMaxAge:6e5,r?.[tn]!==void 0&&(this._cache=r?.[tn],Cg(r?.[tn],this._cacheMaxAge)&&(this._jwksTimestamp=this._cache.uat,this._local=Zo(this._cache.jwks)))}coolingDown(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cooldownDuration:!1}fresh(){return typeof this._jwksTimestamp=="number"?Date.now()<this._jwksTimestamp+this._cacheMaxAge:!1}async getKey(t,r){(!this._local||!this.fresh())&&await this.reload();try{return await this._local(t,r)}catch(n){if(n instanceof Qn&&this.coolingDown()===!1)return await this.reload(),this._local(t,r);throw n}}async reload(){this._pendingFetch&&Pg()&&(this._pendingFetch=void 0);const t=new Headers(this._options.headers);Sn&&!t.has("User-Agent")&&(t.set("User-Agent",Sn),this._options.headers=Object.fromEntries(t.entries())),this._pendingFetch||(this._pendingFetch=Og(this._url,this._timeoutDuration,this._options).then(r=>{this._local=Zo(r),this._cache&&(this._cache.uat=Date.now(),this._cache.jwks=r),this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(r=>{throw this._pendingFetch=void 0,r})),await this._pendingFetch}}function Ng(e,t){const r=new Dg(e,t),n=async(o,s)=>r.getKey(o,s);return Object.defineProperties(n,{coolingDown:{get:()=>r.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>r.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>r.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>!!r._pendingFetch,enumerable:!0,configurable:!1},jwks:{value:()=>r._local?.jwks(),enumerable:!0,configurable:!1,writable:!1}}),n}const mc=Xe;function gc(e){let t;if(typeof e=="string"){const r=e.split(".");(r.length===3||r.length===5)&&([t]=r)}else if(typeof e=="object"&&e)if("protected"in e)t=e.protected;else throw new TypeError("Token does not contain a Protected Header");try{if(typeof t!="string"||!t)throw new Error;const r=JSON.parse(rt.decode(mc(t)));if(!xe(r))throw new Error;return r}catch{throw new TypeError("Invalid Token or Protected Header formatting")}}function ot(e){if(typeof e!="string")throw new Se("JWTs must use Compact JWS serialization, JWT must be a string");const{1:t,length:r}=e.split(".");if(r===5)throw new Se("Only JWTs using Compact JWS serialization can be decoded");if(r!==3)throw new Se("Invalid JWT");if(!t)throw new Se("JWTs must contain a payload");let n;try{n=mc(t)}catch{throw new Se("Failed to base64url decode the payload")}let o;try{o=JSON.parse(rt.decode(n))}catch{throw new Se("Failed to parse the decoded payload as JSON")}if(!xe(o))throw new Se("Invalid JWT Claims Set");return o}function jo(e){switch(e){case"a-z":return"abcdefghijklmnopqrstuvwxyz";case"A-Z":return"ABCDEFGHIJKLMNOPQRSTUVWXYZ";case"0-9":return"0123456789";case"-_":return"-_";default:throw new Error(`Unsupported alphabet: ${e}`)}}function yc(...e){const t=e.map(jo).join("");if(t.length===0)throw new Error("No valid characters provided for random string generation.");const r=t.length;return(n,...o)=>{if(n<=0)throw new Error("Length must be a positive integer.");let s=t,i=r;o.length>0&&(s=o.map(jo).join(""),i=s.length);const a=Math.floor(256/i)*i,c=new Uint8Array(n*2),u=c.length;let l="",d=u,f;for(;l.length<n;)d>=u&&(oh(c),d=0),f=c[d++],f<a&&(l+=s[f%i]);return l}}const In=yc("a-z","0-9","A-Z","-_");async function Lg(e,t,r=3600){return await new Rg(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(Math.floor(Date.now()/1e3)+r).sign(new TextEncoder().encode(t))}const Zg=async({key:e,data:t})=>{const r=await Jn("SHA-256").digest(e),n=Ma(t),o=Wa(Ka)(new Uint8Array(r));return xm(o.encrypt(n))},jg=async({key:e,data:t})=>{const r=await Jn("SHA-256").digest(e),n=zm(t),o=Wa(Ka)(new Uint8Array(r));return new TextDecoder().decode(o.decrypt(n))},st=e=>yc("a-z","A-Z","0-9")(e||32),Hr=F({id:g(),createdAt:ge().default(()=>new Date),updatedAt:ge().default(()=>new Date)});Hr.extend({providerId:g(),accountId:g(),userId:Yt(),accessToken:g().nullish(),refreshToken:g().nullish(),idToken:g().nullish(),accessTokenExpiresAt:ge().nullish(),refreshTokenExpiresAt:ge().nullish(),scope:g().nullish(),password:g().nullish()});Hr.extend({email:g().transform(e=>e.toLowerCase()),emailVerified:Ue().default(!1),name:g(),image:g().nullish()});Hr.extend({userId:Yt(),expiresAt:ge(),token:g(),ipAddress:g().nullish(),userAgent:g().nullish()});Hr.extend({value:g(),expiresAt:ge(),identifier:g()});function Rn(e){return e==="-"||e==="^"||e==="$"||e==="+"||e==="."||e==="("||e===")"||e==="|"||e==="["||e==="]"||e==="{"||e==="}"||e==="*"||e==="?"||e==="\\"?`\\${e}`:e}function Vg(e){let t="";for(let r=0;r<e.length;r++)t+=Rn(e[r]);return t}function wc(e,t=!0){if(Array.isArray(e))return`(?:${e.map(l=>`^${wc(l,t)}$`).join("|")})`;let r="",n="",o=".";t===!0?(r="/",n="[/\\\\]",o="[^/\\\\]"):t&&(r=t,n=Vg(r),n.length>1?(n=`(?:${n})`,o=`((?!${n}).)`):o=`[^${n}]`);let s=t?`${n}+?`:"",i=t?`${n}*?`:"",a=t?e.split(r):[e],c="";for(let u=0;u<a.length;u++){let l=a[u],d=a[u+1],f="";if(!(!l&&u>0)){if(t&&(u===a.length-1?f=i:d!=="**"?f=s:f=""),t&&l==="**"){f&&(c+=u===0?"":f,c+=`(?:${o}*?${f})*?`);continue}for(let h=0;h<l.length;h++){let m=l[h];m==="\\"?h<l.length-1&&(c+=Rn(l[h+1]),h++):m==="?"?c+=o:m==="*"?c+=`${o}*?`:c+=Rn(m)}c+=f}}return c}function Mg(e,t){if(typeof t!="string")throw new TypeError(`Sample must be a string, but ${typeof t} given`);return e.test(t)}function xr(e,t){if(typeof e!="string"&&!Array.isArray(e))throw new TypeError(`The first argument must be a single pattern string or an array of patterns, but ${typeof e} given`);if((typeof t=="string"||typeof t=="boolean")&&(t={separator:t}),arguments.length===2&&!(typeof t>"u"||typeof t=="object"&&t!==null&&!Array.isArray(t)))throw new TypeError(`The second argument must be an options object or a string/boolean separator, but ${typeof t} given`);if(t=t||{},t.separator==="\\")throw new Error("\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead");let r=wc(e,t.separator),n=new RegExp(`^${r}$`,t.flags),o=Mg.bind(null,n);return o.options=t,o.pattern=e,o.regexp=n,o}ht(async e=>{if(e.request?.method!=="POST"||!e.request)return;const{body:t,query:r,context:n}=e,o=e.headers?.get("origin")||e.headers?.get("referer")||"",s=t?.callbackURL||r?.callbackURL,i=t?.redirectTo,a=t?.errorCallbackURL,c=t?.newUserCallbackURL,u=Array.isArray(n.options.trustedOrigins)?n.trustedOrigins:[...n.trustedOrigins,...await n.options.trustedOrigins?.(e.request)||[]],l=e.headers?.has("cookie"),d=(h,m)=>{if(h.startsWith("/"))return!1;if(m.includes("*"))return m.includes("://")?xr(m)(gr(h)||h):xr(m)(rs(h));const w=ts(h);return w==="http:"||w==="https:"||!w?m===gr(h):h.startsWith(m)},f=(h,m)=>{if(!h)return;if(!u.some(_=>d(h,_)||h?.startsWith("/")&&m!=="origin"&&/^\/(?!\/|\\|%2f|%5c)[\w\-.\+/@]*(?:\?[\w\-.\+/=&%@]*)?$/.test(h)))throw e.context.logger.error(`Invalid ${m}: ${h}`),e.context.logger.info(`If it's a valid URL, please add ${h} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${u}`),new b("FORBIDDEN",{message:`Invalid ${m}`})};l&&!e.context.options.advanced?.disableCSRFCheck&&f(o,"origin"),s&&f(s,"callbackURL"),i&&f(i,"redirectURL"),a&&f(a,"errorCallbackURL"),c&&f(c,"newUserCallbackURL")});const Xn=e=>ht(async t=>{if(!t.request)return;const{context:r}=t,n=e(t),o=Array.isArray(r.options.trustedOrigins)?r.trustedOrigins:[...r.trustedOrigins,...await r.options.trustedOrigins?.(t.request)||[]],s=(c,u)=>{if(c.startsWith("/"))return!1;if(u.includes("*"))return u.includes("://")?xr(u)(gr(c)||c):xr(u)(rs(c));const l=ts(c);return l==="http:"||l==="https:"||!l?u===gr(c):c.startsWith(u)},i=(c,u)=>{if(!c)return;if(!o.some(d=>s(c,d)||c?.startsWith("/")&&u!=="origin"&&/^\/(?!\/|\\|%2f|%5c)[\w\-.\+/@]*(?:\?[\w\-.\+/=&%@]*)?$/.test(c)))throw t.context.logger.error(`Invalid ${u}: ${c}`),t.context.logger.info(`If it's a valid URL, please add ${c} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${o}`),new b("FORBIDDEN",{message:`Invalid ${u}`})},a=Array.isArray(n)?n:[n];for(const c of a)i(c,"callbackURL")});async function Ot(e,t,r,n=3600){return await Lg({email:t.toLowerCase(),updateTo:r},e,n)}async function Vo(e,t){if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new b("BAD_REQUEST",{message:"Verification email isn't enabled"});const r=await Ot(e.context.secret,t.email,void 0,e.context.options.emailVerification?.expiresIn),n=`${e.context.baseURL}/verify-email?token=${r}&callbackURL=${e.body.callbackURL||"/"}`;await e.context.options.emailVerification.sendVerificationEmail({user:t,url:n,token:r},e.request)}X("/send-verification-email",{method:"POST",body:F({email:Ln().meta({description:"The email to send the verification email to"}),callbackURL:g().meta({description:"The URL to use for email verification callback"}).optional()}),metadata:{openapi:{description:"Send a verification email to the user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{email:{type:"string",description:"The email to send the verification email to",example:"user@example.com"},callbackURL:{type:"string",description:"The URL to use for email verification callback",example:"https://example.com/callback",nullable:!0}},required:["email"]}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the email was sent successfully",example:!0}}}}}},400:{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",description:"Error message",example:"Verification email isn't enabled"}}}}}}}}}},async e=>{if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new b("BAD_REQUEST",{message:"Verification email isn't enabled"});const{email:t}=e.body,r=await Ke(e);if(!r){const n=await e.context.internalAdapter.findUserByEmail(t);return n?(await Vo(e,n.user),e.json({status:!0})):e.json({status:!0})}if(r?.user.emailVerified)throw new b("BAD_REQUEST",{message:"You can only send a verification email to an unverified email"});if(r?.user.email!==t)throw new b("BAD_REQUEST",{message:"You can only send a verification email to your own email"});return await Vo(e,r.user),e.json({status:!0})});X("/verify-email",{method:"GET",query:F({token:g().meta({description:"The token to verify the email"}),callbackURL:g().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[Xn(e=>e.query.callbackURL)],metadata:{openapi:{description:"Verify the email of the user",parameters:[{name:"token",in:"query",description:"The token to verify the email",required:!0,schema:{type:"string"}},{name:"callbackURL",in:"query",description:"The URL to redirect to after email verification",required:!1,schema:{type:"string"}}],responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",properties:{id:{type:"string",description:"User ID"},email:{type:"string",description:"User email"},name:{type:"string",description:"User name"},image:{type:"string",description:"User image URL"},emailVerified:{type:"boolean",description:"Indicates if the user email is verified"},createdAt:{type:"string",description:"User creation date"},updatedAt:{type:"string",description:"User update date"}},required:["id","email","name","image","emailVerified","createdAt","updatedAt"]},status:{type:"boolean",description:"Indicates if the email was verified successfully"}},required:["user","status"]}}}}}}}},async e=>{function t(c){throw e.query.callbackURL?e.query.callbackURL.includes("?")?e.redirect(`${e.query.callbackURL}&error=${c}`):e.redirect(`${e.query.callbackURL}?error=${c}`):new b("UNAUTHORIZED",{message:c})}const{token:r}=e.query;let n;try{n=await Wr(r,new TextEncoder().encode(e.context.secret),{algorithms:["HS256"]})}catch(c){return c instanceof Ir?t("token_expired"):t("invalid_token")}const s=F({email:g().email(),updateTo:g().optional()}).parse(n.payload),i=await e.context.internalAdapter.findUserByEmail(s.email);if(!i)return t("user_not_found");if(s.updateTo){const c=await Ke(e);if(!c){if(e.query.callbackURL)throw e.redirect(`${e.query.callbackURL}?error=unauthorized`);return t("unauthorized")}if(c.user.email!==s.email){if(e.query.callbackURL)throw e.redirect(`${e.query.callbackURL}?error=unauthorized`);return t("unauthorized")}const u=await e.context.internalAdapter.updateUserByEmail(s.email,{email:s.updateTo,emailVerified:!1},e),l=await Ot(e.context.secret,s.updateTo);if(await e.context.options.emailVerification?.sendVerificationEmail?.({user:u,url:`${e.context.baseURL}/verify-email?token=${l}&callbackURL=${e.query.callbackURL||"/"}`,token:l},e.request),await qe(e,{session:c.session,user:{...c.user,email:s.updateTo,emailVerified:!1}}),e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:{id:u.id,email:u.email,name:u.name,image:u.image,emailVerified:u.emailVerified,createdAt:u.createdAt,updatedAt:u.updatedAt}})}e.context.options.emailVerification?.onEmailVerification&&await e.context.options.emailVerification.onEmailVerification(i.user,e.request);const a=await e.context.internalAdapter.updateUserByEmail(s.email,{emailVerified:!0},e);if(e.context.options.emailVerification?.afterEmailVerification&&await e.context.options.emailVerification.afterEmailVerification(a,e.request),e.context.options.emailVerification?.autoSignInAfterVerification){const c=await Ke(e);if(!c||c.user.email!==s.email){const u=await e.context.internalAdapter.createSession(i.user.id,e);if(!u)throw new b("INTERNAL_SERVER_ERROR",{message:"Failed to create session"});await qe(e,{session:u,user:{...i.user,emailVerified:!0}})}else await qe(e,{session:c.session,user:{...c.user,emailVerified:!0}})}if(e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:null})});const eo={isAction:!1};async function bc(e,t){const r=e.body?.callbackURL||e.context.options.baseURL;if(!r)throw new b("BAD_REQUEST",{message:"callbackURL is required"});const n=In(128),o=In(32),s=JSON.stringify({callbackURL:r,codeVerifier:n,errorURL:e.body?.errorCallbackURL,newUserURL:e.body?.newUserCallbackURL,link:t,expiresAt:Date.now()+600*1e3,requestSignUp:e.body?.requestSignUp}),i=new Date;i.setMinutes(i.getMinutes()+10);const a=await e.context.internalAdapter.createVerificationValue({value:s,identifier:o,expiresAt:i},e);if(!a)throw e.context.logger.error("Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database"),new b("INTERNAL_SERVER_ERROR",{message:"Unable to create verification"});return{state:a.identifier,codeVerifier:n}}async function Fg(e){const t=e.query.state||e.body.state,r=await e.context.internalAdapter.findVerificationValue(t);if(!r){e.context.logger.error("State Mismatch. Verification not found",{state:t});const o=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${o}?error=please_restart_the_process`)}const n=F({callbackURL:g(),codeVerifier:g(),errorURL:g().optional(),newUserURL:g().optional(),expiresAt:Tt(),link:F({email:g(),userId:Yt()}).optional(),requestSignUp:Ue().optional()}).parse(JSON.parse(r.value));if(n.errorURL||(n.errorURL=`${e.context.baseURL}/error`),n.expiresAt<Date.now()){await e.context.internalAdapter.deleteVerificationValue(r.id);const o=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${o}?error=please_restart_the_process`)}return await e.context.internalAdapter.deleteVerificationValue(r.id),n}async function _c(e){const t=await Jn("SHA-256").digest(e);return Br.encode(new Uint8Array(t),{padding:!1})}function vc(e){return{tokenType:e.token_type,accessToken:e.access_token,refreshToken:e.refresh_token,accessTokenExpiresAt:e.expires_in?Ut(e.expires_in,"sec"):void 0,refreshTokenExpiresAt:e.refresh_token_expires_in?Ut(e.refresh_token_expires_in,"sec"):void 0,scopes:e?.scope?typeof e.scope=="string"?e.scope.split(" "):e.scope:[],idToken:e.id_token}}function Bg(e,t){return e&&(t.options.account?.encryptOAuthTokens?jg({key:t.secret,data:e}):e)}function ye(e,t){return t.options.account?.encryptOAuthTokens&&e?Zg({key:t.secret,data:e}):e}async function kc(e,{userInfo:t,account:r,callbackURL:n,disableSignUp:o,overrideUserInfo:s}){const i=await e.context.internalAdapter.findOAuthUser(t.email.toLowerCase(),r.accountId,r.providerId).catch(l=>{G.error(`Better auth was unable to query your database.
Error: `,l);const d=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${d}?error=internal_server_error`)});let a=i?.user,c=!a;if(i){const l=i.accounts.find(d=>d.providerId===r.providerId&&d.accountId===r.accountId);if(l){if(e.context.options.account?.updateAccountOnSignIn!==!1){const d=Object.fromEntries(Object.entries({idToken:r.idToken,accessToken:await ye(r.accessToken,e.context),refreshToken:await ye(r.refreshToken,e.context),accessTokenExpiresAt:r.accessTokenExpiresAt,refreshTokenExpiresAt:r.refreshTokenExpiresAt,scope:r.scope}).filter(([f,h])=>h!==void 0));Object.keys(d).length>0&&await e.context.internalAdapter.updateAccount(l.id,d,e)}}else{if(!e.context.options.account?.accountLinking?.trustedProviders?.includes(r.providerId)&&!t.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)return lu&&G.warn(`User already exist but account isn't linked to ${r.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`),{error:"account not linked",data:null};try{await e.context.internalAdapter.linkAccount({providerId:r.providerId,accountId:t.id.toString(),userId:i.user.id,accessToken:await ye(r.accessToken,e.context),refreshToken:await ye(r.refreshToken,e.context),idToken:r.idToken,accessTokenExpiresAt:r.accessTokenExpiresAt,refreshTokenExpiresAt:r.refreshTokenExpiresAt,scope:r.scope},e)}catch(h){return G.error("Unable to link account",h),{error:"unable to link account",data:null}}}if(s){const{id:d,...f}=t;await e.context.internalAdapter.updateUser(i.user.id,{...f,email:t.email.toLowerCase(),emailVerified:t.email.toLowerCase()===i.user.email&&i.user.emailVerified||t.emailVerified})}}else{if(o)return{error:"signup disabled",data:null,isRegister:!1};try{const{id:l,...d}=t;if(a=await e.context.internalAdapter.createOAuthUser({...d,email:t.email.toLowerCase()},{accessToken:await ye(r.accessToken,e.context),refreshToken:await ye(r.refreshToken,e.context),idToken:r.idToken,accessTokenExpiresAt:r.accessTokenExpiresAt,refreshTokenExpiresAt:r.refreshTokenExpiresAt,scope:r.scope,providerId:r.providerId,accountId:t.id.toString()},e).then(f=>f?.user),!t.emailVerified&&a&&e.context.options.emailVerification?.sendOnSignUp){const f=await Ot(e.context.secret,a.email,void 0,e.context.options.emailVerification?.expiresIn),h=`${e.context.baseURL}/verify-email?token=${f}&callbackURL=${n}`;await e.context.options.emailVerification?.sendVerificationEmail?.({user:a,url:h,token:f},e.request)}}catch(l){return G.error(l),l instanceof b?{error:l.message,data:null,isRegister:!1}:{error:"unable to create user",data:null,isRegister:!1}}}if(!a)return{error:"unable to create user",data:null,isRegister:!1};const u=await e.context.internalAdapter.createSession(a.id,e);return u?{data:{session:u,user:a},error:null,isRegister:c}:{error:"unable to create session",data:null,isRegister:!1}}async function se({id:e,options:t,authorizationEndpoint:r,state:n,codeVerifier:o,scopes:s,claims:i,redirectURI:a,duration:c,prompt:u,accessType:l,responseType:d,display:f,loginHint:h,hd:m,responseMode:w,additionalParams:_,scopeJoiner:E}){const A=new URL(r);if(A.searchParams.set("response_type",d||"code"),A.searchParams.set("client_id",t.clientId),A.searchParams.set("state",n),A.searchParams.set("scope",s.join(E||" ")),A.searchParams.set("redirect_uri",t.redirectURI||a),c&&A.searchParams.set("duration",c),f&&A.searchParams.set("display",f),h&&A.searchParams.set("login_hint",h),u&&A.searchParams.set("prompt",u),m&&A.searchParams.set("hd",m),l&&A.searchParams.set("access_type",l),w&&A.searchParams.set("response_mode",w),o){const v=await _c(o);A.searchParams.set("code_challenge_method","S256"),A.searchParams.set("code_challenge",v)}if(i){const v=i.reduce((T,H)=>(T[H]=null,T),{});A.searchParams.set("claims",JSON.stringify({id_token:{email:null,email_verified:null,...v}}))}return _&&Object.entries(_).forEach(([v,T])=>{A.searchParams.set(v,T)}),A}function qg({code:e,codeVerifier:t,redirectURI:r,options:n,authentication:o,deviceId:s,headers:i,additionalParams:a={},resource:c}){const u=new URLSearchParams,l={"content-type":"application/x-www-form-urlencoded",accept:"application/json","user-agent":"better-auth",...i};if(u.set("grant_type","authorization_code"),u.set("code",e),t&&u.set("code_verifier",t),n.clientKey&&u.set("client_key",n.clientKey),s&&u.set("device_id",s),u.set("redirect_uri",n.redirectURI||r),c)if(typeof c=="string")u.append("resource",c);else for(const d of c)u.append("resource",d);if(o==="basic"){const d=xt.encode(`${n.clientId}:${n.clientSecret??""}`);l.authorization=`Basic ${d}`}else n.clientId&&u.set("client_id",n.clientId),n.clientSecret&&u.set("client_secret",n.clientSecret);for(const[d,f]of Object.entries(a))u.has(d)||u.append(d,f);return{body:u,headers:l}}async function Q({code:e,codeVerifier:t,redirectURI:r,options:n,tokenEndpoint:o,authentication:s,deviceId:i,headers:a,additionalParams:c={},resource:u}){const{body:l,headers:d}=qg({code:e,codeVerifier:t,redirectURI:r,options:n,authentication:s,deviceId:i,headers:a,additionalParams:c,resource:u}),{data:f,error:h}=await N(o,{method:"POST",body:l,headers:d});if(h)throw h;return vc(f)}function Kg({refreshToken:e,options:t,authentication:r,extraParams:n,resource:o}){const s=new URLSearchParams,i={"content-type":"application/x-www-form-urlencoded",accept:"application/json"};if(s.set("grant_type","refresh_token"),s.set("refresh_token",e),r==="basic"?t.clientId?i.authorization="Basic "+xt.encode(`${t.clientId}:${t.clientSecret??""}`):i.authorization="Basic "+xt.encode(`:${t.clientSecret??""}`):(t.clientId&&s.set("client_id",t.clientId),t.clientSecret&&s.set("client_secret",t.clientSecret)),o)if(typeof o=="string")s.append("resource",o);else for(const a of o)s.append("resource",a);if(n)for(const[a,c]of Object.entries(n))s.set(a,c);return{body:s,headers:i}}async function ee({refreshToken:e,options:t,tokenEndpoint:r,authentication:n,extraParams:o}){const{body:s,headers:i}=Kg({refreshToken:e,options:t,authentication:n,extraParams:o}),{data:a,error:c}=await N(r,{method:"POST",body:s,headers:i});if(c)throw c;const u={accessToken:a.access_token,refreshToken:a.refresh_token,tokenType:a.token_type,scopes:a.scope?.split(" "),idToken:a.id_token};if(a.expires_in){const l=new Date;u.accessTokenExpiresAt=new Date(l.getTime()+a.expires_in*1e3)}return u}const Wg=e=>{const t="https://appleid.apple.com/auth/token";return{id:"apple",name:"Apple",async createAuthorizationURL({state:r,scopes:n,redirectURI:o}){const s=e.disableDefaultScope?[]:["email","name"];return e.scope&&s.push(...e.scope),n&&s.push(...n),await se({id:"apple",options:e,authorizationEndpoint:"https://appleid.apple.com/auth/authorize",scopes:s,state:r,redirectURI:o,responseMode:"form_post",responseType:"code id_token"})},validateAuthorizationCode:async({code:r,codeVerifier:n,redirectURI:o})=>Q({code:r,codeVerifier:n,redirectURI:o,options:e,tokenEndpoint:t}),async verifyIdToken(r,n){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(r,n);const o=gc(r),{kid:s,alg:i}=o;if(!s||!i)return!1;const a=await Hg(s),{payload:c}=await Wr(r,a,{algorithms:[i],issuer:"https://appleid.apple.com",audience:e.audience&&e.audience.length?e.audience:e.appBundleIdentifier?e.appBundleIdentifier:e.clientId,maxTokenAge:"1h"});return["email_verified","is_private_email"].forEach(u=>{c[u]!==void 0&&(c[u]=!!c[u])}),n&&c.nonce!==n?!1:!!c},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>ee({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://appleid.apple.com/auth/token"}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);if(!r.idToken)return null;const n=ot(r.idToken);if(!n)return null;const o=r.user?`${r.user.name?.firstName} ${r.user.name?.lastName}`:n.name||n.email,s=typeof n.email_verified=="boolean"?n.email_verified:n.email_verified==="true",i={...n,name:o},a=await e.mapProfileToUser?.(i);return{user:{id:n.sub,name:i.name,emailVerified:s,email:n.email,...a},data:i}},options:e}},Hg=async e=>{const t="https://appleid.apple.com",r="/auth/keys",{data:n}=await N(`${t}${r}`);if(!n?.keys)throw new b("BAD_REQUEST",{message:"Keys not found"});const o=n.keys.find(s=>s.kid===e);if(!o)throw new Error(`JWK with kid ${e} not found`);return await Kr(o,o.alg)},Jg=e=>({id:"atlassian",name:"Atlassian",async createAuthorizationURL({state:t,scopes:r,codeVerifier:n,redirectURI:o}){if(!e.clientId||!e.clientSecret)throw G.error("Client Id and Secret are required for Atlassian"),new pe("CLIENT_ID_AND_SECRET_REQUIRED");if(!n)throw new pe("codeVerifier is required for Atlassian");const s=e.disableDefaultScope?[]:["read:jira-user","offline_access"];return e.scope&&s.push(...e.scope),r&&s.push(...r),se({id:"atlassian",options:e,authorizationEndpoint:"https://auth.atlassian.com/authorize",scopes:s,state:t,codeVerifier:n,redirectURI:o,additionalParams:{audience:"api.atlassian.com"},prompt:e.prompt})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:n})=>Q({code:t,codeVerifier:r,redirectURI:n,options:e,tokenEndpoint:"https://auth.atlassian.com/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:"https://auth.atlassian.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.accessToken)return null;try{const{data:r}=await N("https://api.atlassian.com/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(!r)return null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.account_id,name:r.name,email:r.email,image:r.picture,emailVerified:!1,...n},data:r}}catch(r){return G.error("Failed to fetch user info from Figma:",r),null}},options:e}),Gg=e=>{if(!e.domain||!e.region||!e.userPoolId)throw G.error("Domain, region and userPoolId are required for Amazon Cognito. Make sure to provide them in the options."),new pe("DOMAIN_AND_REGION_REQUIRED");const t=e.domain.replace(/^https?:\/\//,""),r=`https://${t}/oauth2/authorize`,n=`https://${t}/oauth2/token`,o=`https://${t}/oauth2/userinfo`;return{id:"cognito",name:"Cognito",async createAuthorizationURL({state:s,scopes:i,codeVerifier:a,redirectURI:c}){if(!e.clientId)throw G.error("ClientId is required for Amazon Cognito. Make sure to provide them in the options."),new pe("CLIENT_ID_AND_SECRET_REQUIRED");if(e.requireClientSecret&&!e.clientSecret)throw G.error("Client Secret is required when requireClientSecret is true. Make sure to provide it in the options."),new pe("CLIENT_SECRET_REQUIRED");const u=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&u.push(...e.scope),i&&u.push(...i),await se({id:"cognito",options:{...e},authorizationEndpoint:r,scopes:u,state:s,codeVerifier:a,redirectURI:c,prompt:e.prompt})},validateAuthorizationCode:async({code:s,codeVerifier:i,redirectURI:a})=>Q({code:s,codeVerifier:i,redirectURI:a,options:e,tokenEndpoint:n}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async s=>ee({refreshToken:s,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:n}),async verifyIdToken(s,i){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(s,i);try{const a=gc(s),{kid:c,alg:u}=a;if(!c||!u)return!1;const l=await Qg(c,e.region,e.userPoolId),d=`https://cognito-idp.${e.region}.amazonaws.com/${e.userPoolId}`,{payload:f}=await Wr(s,l,{algorithms:[u],issuer:d,audience:e.clientId,maxTokenAge:"1h"});return!(i&&f.nonce!==i)}catch(a){return G.error("Failed to verify ID token:",a),!1}},async getUserInfo(s){if(e.getUserInfo)return e.getUserInfo(s);if(s.idToken)try{const i=ot(s.idToken);if(!i)return null;const a=i.name||i.given_name||i.username||i.email,c={...i,name:a},u=await e.mapProfileToUser?.(c);return{user:{id:i.sub,name:c.name,email:i.email,image:i.picture,emailVerified:i.email_verified,...u},data:c}}catch(i){G.error("Failed to decode ID token:",i)}if(s.accessToken)try{const{data:i}=await N(o,{headers:{Authorization:`Bearer ${s.accessToken}`}});if(i){const a=await e.mapProfileToUser?.(i);return{user:{id:i.sub,name:i.name||i.given_name||i.username,email:i.email,image:i.picture,emailVerified:i.email_verified,...a},data:i}}}catch(i){G.error("Failed to fetch user info from Cognito:",i)}return null},options:e}},Qg=async(e,t,r)=>{const n=`https://cognito-idp.${t}.amazonaws.com/${r}/.well-known/jwks.json`;try{const{data:o}=await N(n);if(!o?.keys)throw new b("BAD_REQUEST",{message:"Keys not found"});const s=o.keys.find(i=>i.kid===e);if(!s)throw new Error(`JWK with kid ${e} not found`);return await Kr(s,s.alg)}catch(o){throw G.error("Failed to fetch Cognito public key:",o),o}},Yg=e=>({id:"discord",name:"Discord",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["identify","email"];return r&&o.push(...r),e.scope&&o.push(...e.scope),new URL(`https://discord.com/api/oauth2/authorize?scope=${o.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI||n)}&state=${t}&prompt=${e.prompt||"none"}`)},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:r,options:e,tokenEndpoint:"https://discord.com/api/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://discord.com/api/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://discord.com/api/users/@me",{headers:{authorization:`Bearer ${t.accessToken}`}});if(n)return null;if(r.avatar===null){const s=r.discriminator==="0"?Number(BigInt(r.id)>>BigInt(22))%6:parseInt(r.discriminator)%5;r.image_url=`https://cdn.discordapp.com/embed/avatars/${s}.png`}else{const s=r.avatar.startsWith("a_")?"gif":"png";r.image_url=`https://cdn.discordapp.com/avatars/${r.id}/${r.avatar}.${s}`}const o=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.global_name||r.username||"",email:r.email,emailVerified:r.verified,image:r.image_url,...o},data:r}},options:e}),Xg=e=>({id:"facebook",name:"Facebook",async createAuthorizationURL({state:t,scopes:r,redirectURI:n,loginHint:o}){const s=e.disableDefaultScope?[]:["email","public_profile"];return e.scope&&s.push(...e.scope),r&&s.push(...r),await se({id:"facebook",options:e,authorizationEndpoint:"https://www.facebook.com/v21.0/dialog/oauth",scopes:s,state:t,redirectURI:n,loginHint:o,additionalParams:e.configId?{config_id:e.configId}:{}})},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:r,options:e,tokenEndpoint:"https://graph.facebook.com/oauth/access_token"}),async verifyIdToken(t,r){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(t,r);if(t.split(".").length===3)try{const{payload:n}=await Wr(t,Ng(new URL("https://limited.facebook.com/.well-known/oauth/openid/jwks/")),{algorithms:["RS256"],audience:e.clientId,issuer:"https://www.facebook.com"});return r&&n.nonce!==r?!1:!!n}catch{return!1}return!0},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://graph.facebook.com/v18.0/oauth/access_token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(t.idToken&&t.idToken.split(".").length===3){const i=ot(t.idToken),a={id:i.sub,name:i.name,email:i.email,picture:{data:{url:i.picture,height:100,width:100,is_silhouette:!1}}},c=await e.mapProfileToUser?.({...a,email_verified:!0});return{user:{...a,emailVerified:!0,...c},data:i}}const r=["id","name","email","picture",...e?.fields||[]],{data:n,error:o}=await N("https://graph.facebook.com/me?fields="+r.join(","),{auth:{type:"Bearer",token:t.accessToken}});if(o)return null;const s=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.name,email:n.email,image:n.picture.data.url,emailVerified:n.email_verified,...s},data:n}},options:e}),ey=e=>({id:"figma",name:"Figma",async createAuthorizationURL({state:t,scopes:r,codeVerifier:n,redirectURI:o}){if(!e.clientId||!e.clientSecret)throw G.error("Client Id and Client Secret are required for Figma. Make sure to provide them in the options."),new pe("CLIENT_ID_AND_SECRET_REQUIRED");if(!n)throw new pe("codeVerifier is required for Figma");const s=e.disableDefaultScope?[]:["file_read"];return e.scope&&s.push(...e.scope),r&&s.push(...r),await se({id:"figma",options:e,authorizationEndpoint:"https://www.figma.com/oauth",scopes:s,state:t,codeVerifier:n,redirectURI:o})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:n})=>Q({code:t,codeVerifier:r,redirectURI:n,options:e,tokenEndpoint:"https://www.figma.com/api/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://www.figma.com/api/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);try{const{data:r}=await N("https://api.figma.com/v1/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(!r)return G.error("Failed to fetch user from Figma"),null;const n=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.handle,email:r.email,image:r.img_url,emailVerified:!!r.email,...n},data:r}}catch(r){return G.error("Failed to fetch user info from Figma:",r),null}},options:e}),ty=e=>{const t="https://github.com/login/oauth/access_token";return{id:"github",name:"GitHub",createAuthorizationURL({state:r,scopes:n,loginHint:o,redirectURI:s}){const i=e.disableDefaultScope?[]:["read:user","user:email"];return e.scope&&i.push(...e.scope),n&&i.push(...n),se({id:"github",options:e,authorizationEndpoint:"https://github.com/login/oauth/authorize",scopes:i,state:r,redirectURI:s,loginHint:o,prompt:e.prompt})},validateAuthorizationCode:async({code:r,redirectURI:n})=>Q({code:r,redirectURI:n,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>ee({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://github.com/login/oauth/access_token"}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:n,error:o}=await N("https://api.github.com/user",{headers:{"User-Agent":"better-auth",authorization:`Bearer ${r.accessToken}`}});if(o)return null;const{data:s}=await N("https://api.github.com/user/emails",{headers:{Authorization:`Bearer ${r.accessToken}`,"User-Agent":"better-auth"}});!n.email&&s&&(n.email=(s.find(c=>c.primary)??s[0])?.email);const i=s?.find(c=>c.email===n.email)?.verified??!1,a=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.name||n.login,email:n.email,image:n.avatar_url,emailVerified:i,...a},data:n}},options:e}},ry=e=>({id:"google",name:"Google",async createAuthorizationURL({state:t,scopes:r,codeVerifier:n,redirectURI:o,loginHint:s,display:i}){if(!e.clientId||!e.clientSecret)throw G.error("Client Id and Client Secret is required for Google. Make sure to provide them in the options."),new pe("CLIENT_ID_AND_SECRET_REQUIRED");if(!n)throw new pe("codeVerifier is required for Google");const a=e.disableDefaultScope?[]:["email","profile","openid"];return e.scope&&a.push(...e.scope),r&&a.push(...r),await se({id:"google",options:e,authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",scopes:a,state:t,codeVerifier:n,redirectURI:o,prompt:e.prompt,accessType:e.accessType,display:i||e.display,loginHint:s,hd:e.hd,additionalParams:{include_granted_scopes:"true"}})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:n})=>Q({code:t,codeVerifier:r,redirectURI:n,options:e,tokenEndpoint:"https://oauth2.googleapis.com/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://www.googleapis.com/oauth2/v4/token"}),async verifyIdToken(t,r){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(t,r);const n=`https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${t}`,{data:o}=await N(n);return o?o.aud===e.clientId&&(o.iss==="https://accounts.google.com"||o.iss==="accounts.google.com"):!1},async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.idToken)return null;const r=ot(t.idToken),n=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.name,email:r.email,image:r.picture,emailVerified:r.email_verified,...n},data:r}},options:e}),ny=e=>({id:"kick",name:"Kick",createAuthorizationURL({state:t,scopes:r,redirectURI:n,codeVerifier:o}){const s=e.disableDefaultScope?[]:["user:read"];return e.scope&&s.push(...e.scope),r&&s.push(...r),se({id:"kick",redirectURI:n,options:e,authorizationEndpoint:"https://id.kick.com/oauth/authorize",scopes:s,codeVerifier:o,state:t})},async validateAuthorizationCode({code:t,redirectURI:r,codeVerifier:n}){return Q({code:t,redirectURI:r,options:e,tokenEndpoint:"https://id.kick.com/oauth/token",codeVerifier:n})},async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://api.kick.com/public/v1/users",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(n)return null;const o=r.data[0],s=await e.mapProfileToUser?.(o);return{user:{id:o.user_id,name:o.name,email:o.email,image:o.profile_picture,emailVerified:!0,...s},data:o}},options:e}),oy=e=>({id:"huggingface",name:"Hugging Face",createAuthorizationURL({state:t,scopes:r,codeVerifier:n,redirectURI:o}){const s=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&s.push(...e.scope),r&&s.push(...r),se({id:"huggingface",options:e,authorizationEndpoint:"https://huggingface.co/oauth/authorize",scopes:s,state:t,codeVerifier:n,redirectURI:o})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:n})=>Q({code:t,codeVerifier:r,redirectURI:n,options:e,tokenEndpoint:"https://huggingface.co/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://huggingface.co/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://huggingface.co/oauth/userinfo",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(n)return null;const o=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.name||r.preferred_username,email:r.email,image:r.picture,emailVerified:r.email_verified??!1,...o},data:r}},options:e}),sy=e=>{const t=e.tenantId||"common",r=e.authority||"https://login.microsoftonline.com",n=`${r}/${t}/oauth2/v2.0/authorize`,o=`${r}/${t}/oauth2/v2.0/token`;return{id:"microsoft",name:"Microsoft EntraID",createAuthorizationURL(s){const i=e.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];return e.scope&&i.push(...e.scope),s.scopes&&i.push(...s.scopes),se({id:"microsoft",options:e,authorizationEndpoint:n,state:s.state,codeVerifier:s.codeVerifier,scopes:i,redirectURI:s.redirectURI,prompt:e.prompt,loginHint:s.loginHint})},validateAuthorizationCode({code:s,codeVerifier:i,redirectURI:a}){return Q({code:s,codeVerifier:i,redirectURI:a,options:e,tokenEndpoint:o})},async getUserInfo(s){if(e.getUserInfo)return e.getUserInfo(s);if(!s.idToken)return null;const i=ot(s.idToken),a=e.profilePhotoSize||48;await N(`https://graph.microsoft.com/v1.0/me/photos/${a}x${a}/$value`,{headers:{Authorization:`Bearer ${s.accessToken}`},async onResponse(u){if(!(e.disableProfilePhoto||!u.response.ok))try{const d=await u.response.clone().arrayBuffer(),f=xt.encode(d);i.picture=`data:image/jpeg;base64, ${f}`}catch(l){G.error(l&&typeof l=="object"&&"name"in l?l.name:"",l)}}});const c=await e.mapProfileToUser?.(i);return{user:{id:i.sub,name:i.name,email:i.email,image:i.picture,emailVerified:!0,...c},data:i}},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async s=>{const i=e.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];return e.scope&&i.push(...e.scope),ee({refreshToken:s,options:{clientId:e.clientId,clientSecret:e.clientSecret},extraParams:{scope:i.join(" ")},tokenEndpoint:o})},options:e}},iy=e=>({id:"slack",name:"Slack",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["openid","profile","email"];r&&o.push(...r),e.scope&&o.push(...e.scope);const s=new URL("https://slack.com/openid/connect/authorize");return s.searchParams.set("scope",o.join(" ")),s.searchParams.set("response_type","code"),s.searchParams.set("client_id",e.clientId),s.searchParams.set("redirect_uri",e.redirectURI||n),s.searchParams.set("state",t),s},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:r,options:e,tokenEndpoint:"https://slack.com/api/openid.connect.token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://slack.com/api/openid.connect.token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://slack.com/api/openid.connect.userInfo",{headers:{authorization:`Bearer ${t.accessToken}`}});if(n)return null;const o=await e.mapProfileToUser?.(r);return{user:{id:r["https://slack.com/user_id"],name:r.name||"",email:r.email,emailVerified:r.email_verified,image:r.picture||r["https://slack.com/user_image_512"],...o},data:r}},options:e}),ay=e=>{const t="https://api.notion.com/v1/oauth/token";return{id:"notion",name:"Notion",createAuthorizationURL({state:r,scopes:n,loginHint:o,redirectURI:s}){const i=e.disableDefaultScope?[]:[];return e.scope&&i.push(...e.scope),n&&i.push(...n),se({id:"notion",options:e,authorizationEndpoint:"https://api.notion.com/v1/oauth/authorize",scopes:i,state:r,redirectURI:s,loginHint:o,additionalParams:{owner:"user"}})},validateAuthorizationCode:async({code:r,redirectURI:n})=>Q({code:r,redirectURI:n,options:e,tokenEndpoint:t,authentication:"basic"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>ee({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:t}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:n,error:o}=await N("https://api.notion.com/v1/users/me",{headers:{Authorization:`Bearer ${r.accessToken}`,"Notion-Version":"2022-06-28"}});if(o||!n)return null;const s=n.bot?.owner?.user;if(!s)return null;const i=await e.mapProfileToUser?.(s);return{user:{id:s.id,name:s.name||"Notion User",email:s.person?.email||null,image:s.avatar_url,emailVerified:!!s.person?.email,...i},data:s}},options:e}},cy=e=>({id:"spotify",name:"Spotify",createAuthorizationURL({state:t,scopes:r,codeVerifier:n,redirectURI:o}){const s=e.disableDefaultScope?[]:["user-read-email"];return e.scope&&s.push(...e.scope),r&&s.push(...r),se({id:"spotify",options:e,authorizationEndpoint:"https://accounts.spotify.com/authorize",scopes:s,state:t,codeVerifier:n,redirectURI:o})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:n})=>Q({code:t,codeVerifier:r,redirectURI:n,options:e,tokenEndpoint:"https://accounts.spotify.com/api/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://accounts.spotify.com/api/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(n)return null;const o=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.display_name,email:r.email,image:r.images[0]?.url,emailVerified:!1,...o},data:r}},options:e}),uy=e=>({id:"twitch",name:"Twitch",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["user:read:email","openid"];return e.scope&&o.push(...e.scope),r&&o.push(...r),se({id:"twitch",redirectURI:n,options:e,authorizationEndpoint:"https://id.twitch.tv/oauth2/authorize",scopes:o,state:t,claims:e.claims||["email","email_verified","preferred_username","picture"]})},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:r,options:e,tokenEndpoint:"https://id.twitch.tv/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://id.twitch.tv/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const r=t.idToken;if(!r)return G.error("No idToken found in token"),null;const n=ot(r),o=await e.mapProfileToUser?.(n);return{user:{id:n.sub,name:n.preferred_username,email:n.email,image:n.picture,emailVerified:n.email_verified,...o},data:n}},options:e}),ly=e=>({id:"twitter",name:"Twitter",createAuthorizationURL(t){const r=e.disableDefaultScope?[]:["users.read","tweet.read","offline.access","users.email"];return e.scope&&r.push(...e.scope),t.scopes&&r.push(...t.scopes),se({id:"twitter",options:e,authorizationEndpoint:"https://x.com/i/oauth2/authorize",scopes:r,state:t.state,codeVerifier:t.codeVerifier,redirectURI:t.redirectURI})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:n})=>Q({code:t,codeVerifier:r,authentication:"basic",redirectURI:n,options:e,tokenEndpoint:"https://api.x.com/2/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},authentication:"basic",tokenEndpoint:"https://api.x.com/2/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://api.x.com/2/users/me?user.fields=profile_image_url",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(n)return null;const{data:o,error:s}=await N("https://api.x.com/2/users/me?user.fields=confirmed_email",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});let i=!1;!s&&o?.data?.confirmed_email&&(r.data.email=o.data.confirmed_email,i=!0);const a=await e.mapProfileToUser?.(r);return{user:{id:r.data.id,name:r.data.name,email:r.data.email||r.data.username||null,image:r.data.profile_image_url,emailVerified:i,...a},data:r}},options:e}),dy=e=>{const t="https://api.dropboxapi.com/oauth2/token";return{id:"dropbox",name:"Dropbox",createAuthorizationURL:async({state:r,scopes:n,codeVerifier:o,redirectURI:s})=>{const i=e.disableDefaultScope?[]:["account_info.read"];e.scope&&i.push(...e.scope),n&&i.push(...n);const a={};return e.accessType&&(a.token_access_type=e.accessType),await se({id:"dropbox",options:e,authorizationEndpoint:"https://www.dropbox.com/oauth2/authorize",scopes:i,state:r,redirectURI:s,codeVerifier:o,additionalParams:a})},validateAuthorizationCode:async({code:r,codeVerifier:n,redirectURI:o})=>await Q({code:r,codeVerifier:n,redirectURI:o,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>ee({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://api.dropbox.com/oauth2/token"}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:n,error:o}=await N("https://api.dropboxapi.com/2/users/get_current_account",{method:"POST",headers:{Authorization:`Bearer ${r.accessToken}`}});if(o)return null;const s=await e.mapProfileToUser?.(n);return{user:{id:n.account_id,name:n.name?.display_name,email:n.email,emailVerified:n.email_verified||!1,image:n.profile_photo_url,...s},data:n}},options:e}},fy=e=>{const t="https://api.linear.app/oauth/token";return{id:"linear",name:"Linear",createAuthorizationURL({state:r,scopes:n,loginHint:o,redirectURI:s}){const i=e.disableDefaultScope?[]:["read"];return e.scope&&i.push(...e.scope),n&&i.push(...n),se({id:"linear",options:e,authorizationEndpoint:"https://linear.app/oauth/authorize",scopes:i,state:r,redirectURI:s,loginHint:o})},validateAuthorizationCode:async({code:r,redirectURI:n})=>Q({code:r,redirectURI:n,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>ee({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:t}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);const{data:n,error:o}=await N("https://api.linear.app/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.accessToken}`},body:JSON.stringify({query:`
							query {
								viewer {
									id
									name
									email
									avatarUrl
									active
									createdAt
									updatedAt
								}
							}
						`})});if(o||!n?.data?.viewer)return null;const s=n.data.viewer,i=await e.mapProfileToUser?.(s);return{user:{id:n.data.viewer.id,name:n.data.viewer.name,email:n.data.viewer.email,image:n.data.viewer.avatarUrl,emailVerified:!0,...i},data:s}},options:e}},py=e=>{const t="https://www.linkedin.com/oauth/v2/authorization",r="https://www.linkedin.com/oauth/v2/accessToken";return{id:"linkedin",name:"Linkedin",createAuthorizationURL:async({state:n,scopes:o,redirectURI:s,loginHint:i})=>{const a=e.disableDefaultScope?[]:["profile","email","openid"];return e.scope&&a.push(...e.scope),o&&a.push(...o),await se({id:"linkedin",options:e,authorizationEndpoint:t,scopes:a,state:n,loginHint:i,redirectURI:s})},validateAuthorizationCode:async({code:n,redirectURI:o})=>await Q({code:n,redirectURI:o,options:e,tokenEndpoint:r}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async n=>ee({refreshToken:n,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:r}),async getUserInfo(n){if(e.getUserInfo)return e.getUserInfo(n);const{data:o,error:s}=await N("https://api.linkedin.com/v2/userinfo",{method:"GET",headers:{Authorization:`Bearer ${n.accessToken}`}});if(s)return null;const i=await e.mapProfileToUser?.(o);return{user:{id:o.sub,name:o.name,email:o.email,emailVerified:o.email_verified||!1,image:o.picture,...i},data:o}},options:e}},rn=(e="")=>e.split("://").map(t=>t.replace(/\/{2,}/g,"/")).join("://"),hy=e=>{let t=e||"https://gitlab.com";return{authorizationEndpoint:rn(`${t}/oauth/authorize`),tokenEndpoint:rn(`${t}/oauth/token`),userinfoEndpoint:rn(`${t}/api/v4/user`)}},my=e=>{const{authorizationEndpoint:t,tokenEndpoint:r,userinfoEndpoint:n}=hy(e.issuer),o="gitlab";return{id:o,name:"Gitlab",createAuthorizationURL:async({state:i,scopes:a,codeVerifier:c,loginHint:u,redirectURI:l})=>{const d=e.disableDefaultScope?[]:["read_user"];return e.scope&&d.push(...e.scope),a&&d.push(...a),await se({id:o,options:e,authorizationEndpoint:t,scopes:d,state:i,redirectURI:l,codeVerifier:c,loginHint:u})},validateAuthorizationCode:async({code:i,redirectURI:a,codeVerifier:c})=>Q({code:i,redirectURI:a,options:e,codeVerifier:c,tokenEndpoint:r}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async i=>ee({refreshToken:i,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://gitlab.com/oauth/token"}),async getUserInfo(i){if(e.getUserInfo)return e.getUserInfo(i);const{data:a,error:c}=await N(n,{headers:{authorization:`Bearer ${i.accessToken}`}});if(c||a.state!=="active"||a.locked)return null;const u=await e.mapProfileToUser?.(a);return{user:{id:a.id,name:a.name??a.username,email:a.email,image:a.avatar_url,emailVerified:!0,...u},data:a}},options:e}},gy=e=>({id:"tiktok",name:"TikTok",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["user.info.profile"];return e.scope&&o.push(...e.scope),r&&o.push(...r),new URL(`https://www.tiktok.com/v2/auth/authorize?scope=${o.join(",")}&response_type=code&client_key=${e.clientKey}&client_secret=${e.clientSecret}&redirect_uri=${encodeURIComponent(e.redirectURI||n)}&state=${t}`)},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:e.redirectURI||r,options:{clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const r=["open_id","avatar_large_url","display_name","username"],{data:n,error:o}=await N(`https://open.tiktokapis.com/v2/user/info/?fields=${r.join(",")}`,{headers:{authorization:`Bearer ${t.accessToken}`}});return o?null:{user:{email:n.data.user.email||n.data.user.username,id:n.data.user.open_id,name:n.data.user.display_name||n.data.user.username,image:n.data.user.avatar_large_url,emailVerified:!!n.data.user.email},data:n}},options:e}),yy=e=>({id:"reddit",name:"Reddit",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["identity"];return e.scope&&o.push(...e.scope),r&&o.push(...r),se({id:"reddit",options:e,authorizationEndpoint:"https://www.reddit.com/api/v1/authorize",scopes:o,state:t,redirectURI:n,duration:e.duration})},validateAuthorizationCode:async({code:t,redirectURI:r})=>{const n=new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:e.redirectURI||r}),o={"content-type":"application/x-www-form-urlencoded",accept:"text/plain","user-agent":"better-auth",Authorization:`Basic ${xt.encode(`${e.clientId}:${e.clientSecret}`)}`},{data:s,error:i}=await N("https://www.reddit.com/api/v1/access_token",{method:"POST",headers:o,body:n.toString()});if(i)throw i;return vc(s)},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},authentication:"basic",tokenEndpoint:"https://www.reddit.com/api/v1/access_token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://oauth.reddit.com/api/v1/me",{headers:{Authorization:`Bearer ${t.accessToken}`,"User-Agent":"better-auth"}});if(n)return null;const o=await e.mapProfileToUser?.(r);return{user:{id:r.id,name:r.name,email:r.oauth_client_id,emailVerified:r.has_verified_email,image:r.icon_img?.split("?")[0],...o},data:r}},options:e}),wy=e=>({id:"roblox",name:"Roblox",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["openid","profile"];return e.scope&&o.push(...e.scope),r&&o.push(...r),new URL(`https://apis.roblox.com/oauth/v1/authorize?scope=${o.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI||n)}&state=${t}&prompt=${e.prompt||"select_account consent"}`)},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:e.redirectURI||r,options:e,tokenEndpoint:"https://apis.roblox.com/oauth/v1/token",authentication:"post"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://apis.roblox.com/oauth/v1/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://apis.roblox.com/oauth/v1/userinfo",{headers:{authorization:`Bearer ${t.accessToken}`}});if(n)return null;const o=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.nickname||r.preferred_username||"",image:r.picture,email:r.preferred_username||null,emailVerified:!0,...o},data:{...r}}},options:e}),by=e=>{const r=(e.environment??"production")==="sandbox",n=e.loginUrl?`https://${e.loginUrl}/services/oauth2/authorize`:r?"https://test.salesforce.com/services/oauth2/authorize":"https://login.salesforce.com/services/oauth2/authorize",o=e.loginUrl?`https://${e.loginUrl}/services/oauth2/token`:r?"https://test.salesforce.com/services/oauth2/token":"https://login.salesforce.com/services/oauth2/token",s=e.loginUrl?`https://${e.loginUrl}/services/oauth2/userinfo`:r?"https://test.salesforce.com/services/oauth2/userinfo":"https://login.salesforce.com/services/oauth2/userinfo";return{id:"salesforce",name:"Salesforce",async createAuthorizationURL({state:i,scopes:a,codeVerifier:c,redirectURI:u}){if(!e.clientId||!e.clientSecret)throw G.error("Client Id and Client Secret are required for Salesforce. Make sure to provide them in the options."),new pe("CLIENT_ID_AND_SECRET_REQUIRED");if(!c)throw new pe("codeVerifier is required for Salesforce");const l=e.disableDefaultScope?[]:["openid","email","profile"];return e.scope&&l.push(...e.scope),a&&l.push(...a),se({id:"salesforce",options:e,authorizationEndpoint:n,scopes:l,state:i,codeVerifier:c,redirectURI:e.redirectURI||u})},validateAuthorizationCode:async({code:i,codeVerifier:a,redirectURI:c})=>Q({code:i,codeVerifier:a,redirectURI:e.redirectURI||c,options:e,tokenEndpoint:o}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async i=>ee({refreshToken:i,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:o}),async getUserInfo(i){if(e.getUserInfo)return e.getUserInfo(i);try{const{data:a}=await N(s,{headers:{Authorization:`Bearer ${i.accessToken}`}});if(!a)return G.error("Failed to fetch user info from Salesforce"),null;const c=await e.mapProfileToUser?.(a);return{user:{id:a.user_id,name:a.name,email:a.email,image:a.photos?.picture||a.photos?.thumbnail,emailVerified:a.email_verified??!1,...c},data:a}}catch(a){return G.error("Failed to fetch user info from Salesforce:",a),null}},options:e}},_y=e=>({id:"vk",name:"VK",async createAuthorizationURL({state:t,scopes:r,codeVerifier:n,redirectURI:o}){const s=e.disableDefaultScope?[]:["email","phone"];return e.scope&&s.push(...e.scope),r&&s.push(...r),se({id:"vk",options:e,authorizationEndpoint:"https://id.vk.com/authorize",scopes:s,state:t,redirectURI:o,codeVerifier:n})},validateAuthorizationCode:async({code:t,codeVerifier:r,redirectURI:n,deviceId:o})=>Q({code:t,codeVerifier:r,redirectURI:e.redirectURI||n,options:e,deviceId:o,tokenEndpoint:"https://id.vk.com/oauth2/auth"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://id.vk.com/oauth2/auth"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.accessToken)return null;const r=new URLSearchParams({access_token:t.accessToken,client_id:e.clientId}).toString(),{data:n,error:o}=await N("https://id.vk.com/oauth2/user_info",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r});if(o||!n.user.email)return null;const s=await e.mapProfileToUser?.(n);return{user:{id:n.user.user_id,first_name:n.user.first_name,last_name:n.user.last_name,email:n.user.email,image:n.user.avatar,emailVerified:!!n.user.email,birthday:n.user.birthday,sex:n.user.sex,name:`${n.user.first_name} ${n.user.last_name}`,...s},data:n}},options:e}),vy=e=>{const t={pkce:!0,...e};return{id:"zoom",name:"Zoom",createAuthorizationURL:async({state:r,redirectURI:n,codeVerifier:o})=>{const s=new URLSearchParams({response_type:"code",redirect_uri:t.redirectURI?t.redirectURI:n,client_id:t.clientId,state:r});if(t.pkce){const a=await _c(o);s.set("code_challenge_method","S256"),s.set("code_challenge",a)}const i=new URL("https://zoom.us/oauth/authorize");return i.search=s.toString(),i},validateAuthorizationCode:async({code:r,redirectURI:n,codeVerifier:o})=>Q({code:r,redirectURI:t.redirectURI||n,codeVerifier:o,options:t,tokenEndpoint:"https://zoom.us/oauth/token",authentication:"post"}),async getUserInfo(r){if(t.getUserInfo)return t.getUserInfo(r);const{data:n,error:o}=await N("https://api.zoom.us/v2/users/me",{headers:{authorization:`Bearer ${r.accessToken}`}});if(o)return null;const s=await t.mapProfileToUser?.(n);return{user:{id:n.id,name:n.display_name,image:n.pic_url,email:n.email,emailVerified:!!n.verified,...s},data:{...n}}}}},ky=e=>({id:"kakao",name:"Kakao",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["account_email","profile_image","profile_nickname"];return e.scope&&o.push(...e.scope),r&&o.push(...r),se({id:"kakao",options:e,authorizationEndpoint:"https://kauth.kakao.com/oauth/authorize",scopes:o,state:t,redirectURI:n})},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:r,options:e,tokenEndpoint:"https://kauth.kakao.com/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://kauth.kakao.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://kapi.kakao.com/v2/user/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(n||!r)return null;const o=await e.mapProfileToUser?.(r),s=r.kakao_account||{},i=s.profile||{};return{user:{id:String(r.id),name:i.nickname||s.name||void 0,email:s.email,image:i.profile_image_url||i.thumbnail_image_url,emailVerified:!!s.is_email_valid&&!!s.is_email_verified,...o},data:r}},options:e}),Ay=e=>({id:"naver",name:"Naver",createAuthorizationURL({state:t,scopes:r,redirectURI:n}){const o=e.disableDefaultScope?[]:["profile","email"];return e.scope&&o.push(...e.scope),r&&o.push(...r),se({id:"naver",options:e,authorizationEndpoint:"https://nid.naver.com/oauth2.0/authorize",scopes:o,state:t,redirectURI:n})},validateAuthorizationCode:async({code:t,redirectURI:r})=>Q({code:t,redirectURI:r,options:e,tokenEndpoint:"https://nid.naver.com/oauth2.0/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>ee({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://nid.naver.com/oauth2.0/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:r,error:n}=await N("https://openapi.naver.com/v1/nid/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(n||!r||r.resultcode!=="00")return null;const o=await e.mapProfileToUser?.(r),s=r.response||{};return{user:{id:s.id,name:s.name||s.nickname,email:s.email,image:s.profile_image,emailVerified:!1,...o},data:r}},options:e}),Ey=e=>{const t="https://access.line.me/oauth2/v2.1/authorize",r="https://api.line.me/oauth2/v2.1/token",n="https://api.line.me/oauth2/v2.1/userinfo",o="https://api.line.me/oauth2/v2.1/verify";return{id:"line",name:"LINE",async createAuthorizationURL({state:s,scopes:i,codeVerifier:a,redirectURI:c,loginHint:u}){const l=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&l.push(...e.scope),i&&l.push(...i),await se({id:"line",options:e,authorizationEndpoint:t,scopes:l,state:s,codeVerifier:a,redirectURI:c,loginHint:u})},validateAuthorizationCode:async({code:s,codeVerifier:i,redirectURI:a})=>Q({code:s,codeVerifier:i,redirectURI:a,options:e,tokenEndpoint:r}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async s=>ee({refreshToken:s,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:r}),async verifyIdToken(s,i){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(s,i);const a=new URLSearchParams;a.set("id_token",s),a.set("client_id",e.clientId),i&&a.set("nonce",i);const{data:c,error:u}=await N(o,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:a});return!(u||!c||c.aud!==e.clientId||i&&c.nonce&&c.nonce!==i)},async getUserInfo(s){if(e.getUserInfo)return e.getUserInfo(s);let i=null;if(s.idToken)try{i=ot(s.idToken)}catch{}if(!i){const{data:f}=await N(n,{headers:{authorization:`Bearer ${s.accessToken}`}});i=f||null}if(!i)return null;const a=await e.mapProfileToUser?.(i),c=i.sub||i.userId,u=i.name||i.displayName,l=i.picture||i.pictureUrl||void 0,d=i.email;return{user:{id:c,name:u,email:d,image:l,emailVerified:!1,...a},data:i}},options:e}},Ty=e=>{const r=(e.environment||"sandbox")==="sandbox",n=r?"https://www.sandbox.paypal.com/signin/authorize":"https://www.paypal.com/signin/authorize",o=r?"https://api-m.sandbox.paypal.com/v1/oauth2/token":"https://api-m.paypal.com/v1/oauth2/token",s=r?"https://api-m.sandbox.paypal.com/v1/identity/oauth2/userinfo":"https://api-m.paypal.com/v1/identity/oauth2/userinfo";return{id:"paypal",name:"PayPal",async createAuthorizationURL({state:i,codeVerifier:a,redirectURI:c}){if(!e.clientId||!e.clientSecret)throw G.error("Client Id and Client Secret is required for PayPal. Make sure to provide them in the options."),new pe("CLIENT_ID_AND_SECRET_REQUIRED");return await se({id:"paypal",options:e,authorizationEndpoint:n,scopes:[],state:i,codeVerifier:a,redirectURI:c,prompt:e.prompt})},validateAuthorizationCode:async({code:i,redirectURI:a})=>{const c=Buffer.from(`${e.clientId}:${e.clientSecret}`).toString("base64");try{const u=await N(o,{method:"POST",headers:{Authorization:`Basic ${c}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:i,redirect_uri:a}).toString()});if(!u.data)throw new pe("FAILED_TO_GET_ACCESS_TOKEN");const l=u.data;return{accessToken:l.access_token,refreshToken:l.refresh_token,accessTokenExpiresAt:l.expires_in?new Date(Date.now()+l.expires_in*1e3):void 0,idToken:l.id_token}}catch(u){throw G.error("PayPal token exchange failed:",u),new pe("FAILED_TO_GET_ACCESS_TOKEN")}},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async i=>{const a=Buffer.from(`${e.clientId}:${e.clientSecret}`).toString("base64");try{const c=await N(o,{method:"POST",headers:{Authorization:`Basic ${a}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:i}).toString()});if(!c.data)throw new pe("FAILED_TO_REFRESH_ACCESS_TOKEN");const u=c.data;return{accessToken:u.access_token,refreshToken:u.refresh_token,accessTokenExpiresAt:u.expires_in?new Date(Date.now()+u.expires_in*1e3):void 0}}catch(c){throw G.error("PayPal token refresh failed:",c),new pe("FAILED_TO_REFRESH_ACCESS_TOKEN")}},async verifyIdToken(i,a){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(i,a);try{return!!ot(i).sub}catch(c){return G.error("Failed to verify PayPal ID token:",c),!1}},async getUserInfo(i){if(e.getUserInfo)return e.getUserInfo(i);if(!i.accessToken)return G.error("Access token is required to fetch PayPal user info"),null;try{const a=await N(`${s}?schema=paypalv1.1`,{headers:{Authorization:`Bearer ${i.accessToken}`,Accept:"application/json"}});if(!a.data)return G.error("Failed to fetch user info from PayPal"),null;const c=a.data,u=await e.mapProfileToUser?.(c);return{user:{id:c.user_id,name:c.name,email:c.email,image:c.picture,emailVerified:c.email_verified,...u},data:c}}catch(a){return G.error("Failed to fetch user info from PayPal:",a),null}},options:e}},Sy={apple:Wg,atlassian:Jg,cognito:Gg,discord:Yg,facebook:Xg,figma:ey,github:ty,microsoft:sy,google:ry,huggingface:oy,slack:iy,spotify:cy,twitch:uy,twitter:ly,dropbox:dy,kick:ny,linear:fy,linkedin:py,gitlab:my,tiktok:gy,reddit:yy,roblox:wy,salesforce:by,vk:_y,zoom:vy,notion:ay,kakao:ky,naver:Ay,line:Ey,paypal:Ty},Iy=Object.keys(Sy),Ac=It(Iy).or(g());X("/sign-in/social",{method:"POST",body:F({callbackURL:g().meta({description:"Callback URL to redirect to after the user has signed in"}).optional(),newUserCallbackURL:g().optional(),errorCallbackURL:g().meta({description:"Callback URL to redirect to if an error happens"}).optional(),provider:Ac,disableRedirect:Ue().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional(),idToken:Rt(F({token:g().meta({description:"ID token from the provider"}),nonce:g().meta({description:"Nonce used to generate the token"}).optional(),accessToken:g().meta({description:"Access token from the provider"}).optional(),refreshToken:g().meta({description:"Refresh token from the provider"}).optional(),expiresAt:Tt().meta({description:"Expiry date of the token"}).optional()})),scopes:tt(g()).meta({description:"Array of scopes to request from the provider. This will override the default scopes passed."}).optional(),requestSignUp:Ue().meta({description:"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider"}).optional(),loginHint:g().meta({description:"The login hint to use for the authorization code request"}).optional()}),metadata:{openapi:{description:"Sign in with a social provider",operationId:"socialSignIn",responses:{200:{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{redirect:{type:"boolean",enum:[!1]},token:{type:"string",description:"Session token",url:{type:"null",nullable:!0},user:{type:"object",properties:{id:{type:"string"},email:{type:"string"},name:{type:"string",nullable:!0},image:{type:"string",nullable:!0},emailVerified:{type:"boolean"},createdAt:{type:"string",format:"date-time"},updatedAt:{type:"string",format:"date-time"}},required:["id","email","emailVerified","createdAt","updatedAt"]}}},required:["redirect","token","user"]}}}}}}}},async e=>{const t=e.context.socialProviders.find(s=>s.id===e.body.provider);if(!t)throw e.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:e.body.provider}),new b("NOT_FOUND",{message:Z.PROVIDER_NOT_FOUND});if(e.body.idToken){if(!t.verifyIdToken)throw e.context.logger.error("Provider does not support id token verification",{provider:e.body.provider}),new b("NOT_FOUND",{message:Z.ID_TOKEN_NOT_SUPPORTED});const{token:s,nonce:i}=e.body.idToken;if(!await t.verifyIdToken(s,i))throw e.context.logger.error("Invalid id token",{provider:e.body.provider}),new b("UNAUTHORIZED",{message:Z.INVALID_TOKEN});const c=await t.getUserInfo({idToken:s,accessToken:e.body.idToken.accessToken,refreshToken:e.body.idToken.refreshToken});if(!c||!c?.user)throw e.context.logger.error("Failed to get user info",{provider:e.body.provider}),new b("UNAUTHORIZED",{message:Z.FAILED_TO_GET_USER_INFO});if(!c.user.email)throw e.context.logger.error("User email not found",{provider:e.body.provider}),new b("UNAUTHORIZED",{message:Z.USER_EMAIL_NOT_FOUND});const u=await kc(e,{userInfo:{...c.user,email:c.user.email,id:String(c.user.id),name:c.user.name||"",image:c.user.image,emailVerified:c.user.emailVerified||!1},account:{providerId:t.id,accountId:String(c.user.id),accessToken:e.body.idToken.accessToken},callbackURL:e.body.callbackURL,disableSignUp:t.disableImplicitSignUp&&!e.body.requestSignUp||t.disableSignUp});if(u.error)throw new b("UNAUTHORIZED",{message:u.error});return await qe(e,u.data),e.json({redirect:!1,token:u.data.session.token,url:void 0,user:{id:u.data.user.id,email:u.data.user.email,name:u.data.user.name,image:u.data.user.image,emailVerified:u.data.user.emailVerified,createdAt:u.data.user.createdAt,updatedAt:u.data.user.updatedAt}})}const{codeVerifier:r,state:n}=await bc(e),o=await t.createAuthorizationURL({state:n,codeVerifier:r,redirectURI:`${e.context.baseURL}/callback/${t.id}`,scopes:e.body.scopes,loginHint:e.body.loginHint});return e.json({url:o.toString(),redirect:!e.body.disableRedirect})});X("/sign-in/email",{method:"POST",body:F({email:g().meta({description:"Email of the user"}),password:g().meta({description:"Password of the user"}),callbackURL:g().meta({description:"Callback URL to use as a redirect for email verification"}).optional(),rememberMe:Ue().meta({description:"If this is false, the session will not be remembered. Default is `true`."}).default(!0).optional()}),metadata:{openapi:{description:"Sign in with email and password",responses:{200:{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{redirect:{type:"boolean",enum:[!1]},token:{type:"string",description:"Session token"},url:{type:"null",nullable:!0},user:{type:"object",properties:{id:{type:"string"},email:{type:"string"},name:{type:"string",nullable:!0},image:{type:"string",nullable:!0},emailVerified:{type:"boolean"},createdAt:{type:"string",format:"date-time"},updatedAt:{type:"string",format:"date-time"}},required:["id","email","emailVerified","createdAt","updatedAt"]}},required:["redirect","token","user"]}}}}}}}},async e=>{if(!e.context.options?.emailAndPassword?.enabled)throw e.context.logger.error("Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!"),new b("BAD_REQUEST",{message:"Email and password is not enabled"});const{email:t,password:r}=e.body;if(!g().email().safeParse(t).success)throw new b("BAD_REQUEST",{message:Z.INVALID_EMAIL});const o=await e.context.internalAdapter.findUserByEmail(t,{includeAccounts:!0});if(!o)throw await e.context.password.hash(r),e.context.logger.error("User not found",{email:t}),new b("UNAUTHORIZED",{message:Z.INVALID_EMAIL_OR_PASSWORD});const s=o.accounts.find(u=>u.providerId==="credential");if(!s)throw e.context.logger.error("Credential account not found",{email:t}),new b("UNAUTHORIZED",{message:Z.INVALID_EMAIL_OR_PASSWORD});const i=s?.password;if(!i)throw e.context.logger.error("Password not found",{email:t}),new b("UNAUTHORIZED",{message:Z.INVALID_EMAIL_OR_PASSWORD});if(!await e.context.password.verify({hash:i,password:r}))throw e.context.logger.error("Invalid password"),new b("UNAUTHORIZED",{message:Z.INVALID_EMAIL_OR_PASSWORD});if(e.context.options?.emailAndPassword?.requireEmailVerification&&!o.user.emailVerified){if(!e.context.options?.emailVerification?.sendVerificationEmail)throw new b("FORBIDDEN",{message:Z.EMAIL_NOT_VERIFIED});if(e.context.options?.emailVerification?.sendOnSignIn){const u=await Ot(e.context.secret,o.user.email,void 0,e.context.options.emailVerification?.expiresIn),l=`${e.context.baseURL}/verify-email?token=${u}&callbackURL=${e.body.callbackURL||"/"}`;await e.context.options.emailVerification.sendVerificationEmail({user:o.user,url:l,token:u},e.request)}throw new b("FORBIDDEN",{message:Z.EMAIL_NOT_VERIFIED})}const c=await e.context.internalAdapter.createSession(o.user.id,e,e.body.rememberMe===!1);if(!c)throw e.context.logger.error("Failed to create session"),new b("UNAUTHORIZED",{message:Z.FAILED_TO_CREATE_SESSION});return await qe(e,{session:c,user:o.user},e.body.rememberMe===!1),e.json({redirect:!!e.body.callbackURL,token:c.token,url:e.body.callbackURL,user:{id:o.user.id,email:o.user.email,name:o.user.name,image:o.user.image,emailVerified:o.user.emailVerified,createdAt:o.user.createdAt,updatedAt:o.user.updatedAt}})});const lr=F({code:g().optional(),error:g().optional(),device_id:g().optional(),error_description:g().optional(),state:g().optional(),user:g().optional()});X("/callback/:id",{method:["GET","POST"],body:lr.optional(),query:lr.optional(),metadata:eo},async e=>{let t;const r=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;try{if(e.method==="GET")t=lr.parse(e.query);else if(e.method==="POST")t=lr.parse(e.body);else throw new Error("Unsupported method")}catch(x){throw e.context.logger.error("INVALID_CALLBACK_REQUEST",x),e.redirect(`${r}?error=invalid_callback_request`)}const{code:n,error:o,state:s,error_description:i,device_id:a}=t;if(o)throw e.redirect(`${r}?error=${o}&error_description=${i}`);if(!s)throw e.context.logger.error("State not found",o),e.redirect(`${r}?error=state_not_found`);const{codeVerifier:c,callbackURL:u,link:l,errorURL:d,newUserURL:f,requestSignUp:h}=await Fg(e);function m(x){let q=d||r;throw q.includes("?")?q=`${q}&error=${x}`:q=`${q}?error=${x}`,e.redirect(q)}if(!n)throw e.context.logger.error("Code not found"),m("no_code");const w=e.context.socialProviders.find(x=>x.id===e.params.id);if(!w)throw e.context.logger.error("Oauth provider with id",e.params.id,"not found"),m("oauth_provider_not_found");let _;try{_=await w.validateAuthorizationCode({code:n,codeVerifier:c,deviceId:a,redirectURI:`${e.context.baseURL}/callback/${w.id}`})}catch(x){throw e.context.logger.error("",x),m("invalid_code")}const E=await w.getUserInfo({..._,user:e.body?.user?La(e.body.user):void 0}).then(x=>x?.user);if(!E)return e.context.logger.error("Unable to get user info"),m("unable_to_get_user_info");if(!u)throw e.context.logger.error("No callback URL found"),m("no_callback_url");if(l){if(!e.context.options.account?.accountLinking?.trustedProviders?.includes(w.id)&&!E.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)return e.context.logger.error("Unable to link account - untrusted provider"),m("unable_to_link_account");const S=await e.context.internalAdapter.findAccount(String(E.id));if(S){if(S.userId.toString()!==l.userId.toString())return m("account_already_linked_to_different_user");const B=Object.fromEntries(Object.entries({accessToken:await ye(_.accessToken,e.context),refreshToken:await ye(_.refreshToken,e.context),idToken:_.idToken,accessTokenExpiresAt:_.accessTokenExpiresAt,refreshTokenExpiresAt:_.refreshTokenExpiresAt,scope:_.scopes?.join(",")}).filter(([J,K])=>K!==void 0));await e.context.internalAdapter.updateAccount(S.id,B)}else if(!await e.context.internalAdapter.createAccount({userId:l.userId,providerId:w.id,accountId:String(E.id),..._,accessToken:await ye(_.accessToken,e.context),refreshToken:await ye(_.refreshToken,e.context),scope:_.scopes?.join(",")},e))return m("unable_to_link_account");let P;try{P=u.toString()}catch{P=u}throw e.redirect(P)}if(!E.email)return e.context.logger.error("Provider did not return email. This could be due to misconfiguration in the provider settings."),m("email_not_found");const A=await kc(e,{userInfo:{...E,id:String(E.id),email:E.email,name:E.name||E.email},account:{providerId:w.id,accountId:String(E.id),..._,scope:_.scopes?.join(",")},callbackURL:u,disableSignUp:w.disableImplicitSignUp&&!h||w.options?.disableSignUp,overrideUserInfo:w.options?.overrideUserInfoOnSignIn});if(A.error)return e.context.logger.error(A.error.split(" ").join("_")),m(A.error.split(" ").join("_"));const{session:v,user:T}=A.data;await qe(e,{session:v,user:T});let H;try{H=(A.isRegister&&f||u).toString()}catch{H=A.isRegister&&f||u}throw e.redirect(H)});X("/sign-out",{method:"POST",requireHeaders:!0,metadata:{openapi:{description:"Sign out the current user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean"}}}}}}}}}},async e=>{const t=await e.getSignedCookie(e.context.authCookies.sessionToken.name,e.context.secret);if(!t)throw zt(e),new b("BAD_REQUEST",{message:Z.FAILED_TO_GET_SESSION});return await e.context.internalAdapter.deleteSession(t),zt(e),e.json({success:!0})});function Mo(e,t,r){const n=t?new URL(t,e.baseURL):new URL(`${e.baseURL}/error`);return r&&Object.entries(r).forEach(([o,s])=>n.searchParams.set(o,s)),n.href}function Ry(e,t,r){const n=new URL(t,e.baseURL);return r&&Object.entries(r).forEach(([o,s])=>n.searchParams.set(o,s)),n.href}X("/request-password-reset",{method:"POST",body:F({email:Ln().meta({description:"The email address of the user to send a password reset email to"}),redirectTo:g().meta({description:"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN"}).optional()}),metadata:{openapi:{description:"Send a password reset email to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"},message:{type:"string"}}}}}}}}}},async e=>{if(!e.context.options.emailAndPassword?.sendResetPassword)throw e.context.logger.error("Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!"),new b("BAD_REQUEST",{message:"Reset password isn't enabled"});const{email:t,redirectTo:r}=e.body,n=await e.context.internalAdapter.findUserByEmail(t,{includeAccounts:!0});if(!n)return e.context.logger.error("Reset Password: User not found",{email:t}),e.json({status:!0,message:"If this email exists in our system, check your email for the reset link"});const o=3600*1,s=Ut(e.context.options.emailAndPassword.resetPasswordTokenExpiresIn||o,"sec"),i=st(24);await e.context.internalAdapter.createVerificationValue({value:n.user.id,identifier:`reset-password:${i}`,expiresAt:s},e);const a=r?encodeURIComponent(r):"",c=`${e.context.baseURL}/reset-password/${i}?callbackURL=${a}`;return await e.context.options.emailAndPassword.sendResetPassword({user:n.user,url:c,token:i},e.request),e.json({status:!0})});X("/forget-password",{method:"POST",body:F({email:g().email().meta({description:"The email address of the user to send a password reset email to"}),redirectTo:g().meta({description:"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN"}).optional()}),metadata:{openapi:{description:"Send a password reset email to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"},message:{type:"string"}}}}}}}}}},async e=>{if(!e.context.options.emailAndPassword?.sendResetPassword)throw e.context.logger.error("Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!"),new b("BAD_REQUEST",{message:"Reset password isn't enabled"});const{email:t,redirectTo:r}=e.body,n=await e.context.internalAdapter.findUserByEmail(t,{includeAccounts:!0});if(!n)return e.context.logger.error("Reset Password: User not found",{email:t}),e.json({status:!0,message:"If this email exists in our system, check your email for the reset link"});const o=3600*1,s=Ut(e.context.options.emailAndPassword.resetPasswordTokenExpiresIn||o,"sec"),i=st(24);await e.context.internalAdapter.createVerificationValue({value:n.user.id,identifier:`reset-password:${i}`,expiresAt:s},e);const a=r?encodeURIComponent(r):"",c=`${e.context.baseURL}/reset-password/${i}?callbackURL=${a}`;return await e.context.options.emailAndPassword.sendResetPassword({user:n.user,url:c,token:i},e.request),e.json({status:!0})});X("/reset-password/:token",{method:"GET",query:F({callbackURL:g().meta({description:"The URL to redirect the user to reset their password"})}),use:[Xn(e=>e.query.callbackURL)],metadata:{openapi:{description:"Redirects the user to the callback URL with the token",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string"}}}}}}}}}},async e=>{const{token:t}=e.params,{callbackURL:r}=e.query;if(!t||!r)throw e.redirect(Mo(e.context,r,{error:"INVALID_TOKEN"}));const n=await e.context.internalAdapter.findVerificationValue(`reset-password:${t}`);throw!n||n.expiresAt<new Date?e.redirect(Mo(e.context,r,{error:"INVALID_TOKEN"})):e.redirect(Ry(e.context,r,{token:t}))});X("/reset-password",{method:"POST",query:F({token:g().optional()}).optional(),body:F({newPassword:g().meta({description:"The new password to set"}),token:g().meta({description:"The token to reset the password"}).optional()}),metadata:{openapi:{description:"Reset the password for a user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async e=>{const t=e.body.token||e.query?.token;if(!t)throw new b("BAD_REQUEST",{message:Z.INVALID_TOKEN});const{newPassword:r}=e.body,n=e.context.password?.config.minPasswordLength,o=e.context.password?.config.maxPasswordLength;if(r.length<n)throw new b("BAD_REQUEST",{message:Z.PASSWORD_TOO_SHORT});if(r.length>o)throw new b("BAD_REQUEST",{message:Z.PASSWORD_TOO_LONG});const s=`reset-password:${t}`,i=await e.context.internalAdapter.findVerificationValue(s);if(!i||i.expiresAt<new Date)throw new b("BAD_REQUEST",{message:Z.INVALID_TOKEN});const a=i.value,c=await e.context.password.hash(r);if((await e.context.internalAdapter.findAccounts(a)).find(d=>d.providerId==="credential")?await e.context.internalAdapter.updatePassword(a,c,e):await e.context.internalAdapter.createAccount({userId:a,providerId:"credential",password:c,accountId:a},e),await e.context.internalAdapter.deleteVerificationValue(i.id),e.context.options.emailAndPassword?.onPasswordReset){const d=await e.context.internalAdapter.findUserById(a);d&&await e.context.options.emailAndPassword.onPasswordReset({user:d},e.request)}return e.context.options.emailAndPassword?.revokeSessionsOnPasswordReset&&await e.context.internalAdapter.deleteSessions(a),e.json({status:!0})});X("/change-password",{method:"POST",body:F({newPassword:g().meta({description:"The new password to set"}),currentPassword:g().meta({description:"The current password is required"}),revokeOtherSessions:Ue().meta({description:"Must be a boolean value"}).optional()}),use:[$e],metadata:{openapi:{description:"Change the password of the user",responses:{200:{description:"Password successfully changed",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",nullable:!0,description:"New session token if other sessions were revoked"},user:{type:"object",properties:{id:{type:"string",description:"The unique identifier of the user"},email:{type:"string",format:"email",description:"The email address of the user"},name:{type:"string",description:"The name of the user"},image:{type:"string",format:"uri",nullable:!0,description:"The profile image URL of the user"},emailVerified:{type:"boolean",description:"Whether the email has been verified"},createdAt:{type:"string",format:"date-time",description:"When the user was created"},updatedAt:{type:"string",format:"date-time",description:"When the user was last updated"}},required:["id","email","name","emailVerified","createdAt","updatedAt"]}},required:["user"]}}}}}}}},async e=>{const{newPassword:t,currentPassword:r,revokeOtherSessions:n}=e.body,o=e.context.session,s=e.context.password.config.minPasswordLength;if(t.length<s)throw e.context.logger.error("Password is too short"),new b("BAD_REQUEST",{message:Z.PASSWORD_TOO_SHORT});const i=e.context.password.config.maxPasswordLength;if(t.length>i)throw e.context.logger.error("Password is too long"),new b("BAD_REQUEST",{message:Z.PASSWORD_TOO_LONG});const c=(await e.context.internalAdapter.findAccounts(o.user.id)).find(f=>f.providerId==="credential"&&f.password);if(!c||!c.password)throw new b("BAD_REQUEST",{message:Z.CREDENTIAL_ACCOUNT_NOT_FOUND});const u=await e.context.password.hash(t);if(!await e.context.password.verify({hash:c.password,password:r}))throw new b("BAD_REQUEST",{message:Z.INVALID_PASSWORD});await e.context.internalAdapter.updateAccount(c.id,{password:u});let d=null;if(n){await e.context.internalAdapter.deleteSessions(o.user.id);const f=await e.context.internalAdapter.createSession(o.user.id,e);if(!f)throw new b("INTERNAL_SERVER_ERROR",{message:Z.FAILED_TO_GET_SESSION});await qe(e,{session:f,user:o.user}),d=f.token}return e.json({token:d,user:{id:o.user.id,email:o.user.email,name:o.user.name,image:o.user.image,emailVerified:o.user.emailVerified,createdAt:o.user.createdAt,updatedAt:o.user.updatedAt}})});X("/set-password",{method:"POST",body:F({newPassword:g().meta({description:"The new password to set is required"})}),metadata:{SERVER_ONLY:!0},use:[$e]},async e=>{const{newPassword:t}=e.body,r=e.context.session,n=e.context.password.config.minPasswordLength;if(t.length<n)throw e.context.logger.error("Password is too short"),new b("BAD_REQUEST",{message:Z.PASSWORD_TOO_SHORT});const o=e.context.password.config.maxPasswordLength;if(t.length>o)throw e.context.logger.error("Password is too long"),new b("BAD_REQUEST",{message:Z.PASSWORD_TOO_LONG});const i=(await e.context.internalAdapter.findAccounts(r.user.id)).find(c=>c.providerId==="credential"&&c.password),a=await e.context.password.hash(t);if(!i)return await e.context.internalAdapter.linkAccount({userId:r.user.id,providerId:"credential",accountId:r.user.id,password:a},e),e.json({status:!0});throw new b("BAD_REQUEST",{message:"user already has a password"})});X("/delete-user",{method:"POST",use:[$e],body:F({callbackURL:g().meta({description:"The callback URL to redirect to after the user is deleted"}).optional(),password:g().meta({description:"The password of the user is required to delete the user"}).optional(),token:g().meta({description:"The token to delete the user is required"}).optional()}),metadata:{openapi:{description:"Delete the user",responses:{200:{description:"User deletion processed successfully",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the operation was successful"},message:{type:"string",enum:["User deleted","Verification email sent"],description:"Status message of the deletion process"}},required:["success","message"]}}}}}}}},async e=>{if(!e.context.options.user?.deleteUser?.enabled)throw e.context.logger.error("Delete user is disabled. Enable it in the options",{session:e.context.session}),new b("NOT_FOUND");const t=e.context.session;if(e.body.password){const s=(await e.context.internalAdapter.findAccounts(t.user.id)).find(a=>a.providerId==="credential"&&a.password);if(!s||!s.password)throw new b("BAD_REQUEST",{message:Z.CREDENTIAL_ACCOUNT_NOT_FOUND});if(!await e.context.password.verify({hash:s.password,password:e.body.password}))throw new b("BAD_REQUEST",{message:Z.INVALID_PASSWORD})}if(e.body.token)return await Uy({...e,query:{token:e.body.token}}),e.json({success:!0,message:"User deleted"});if(e.context.options.user.deleteUser?.sendDeleteAccountVerification){const o=In(32,"0-9","a-z");await e.context.internalAdapter.createVerificationValue({value:t.user.id,identifier:`delete-account-${o}`,expiresAt:new Date(Date.now()+(e.context.options.user.deleteUser?.deleteTokenExpiresIn||3600*24)*1e3)},e);const s=`${e.context.baseURL}/delete-user/callback?token=${o}&callbackURL=${e.body.callbackURL||"/"}`;return await e.context.options.user.deleteUser.sendDeleteAccountVerification({user:t.user,url:s,token:o},e.request),e.json({success:!0,message:"Verification email sent"})}if(!e.body.password&&e.context.sessionConfig.freshAge!==0){const o=new Date(t.session.createdAt).getTime(),s=e.context.sessionConfig.freshAge*1e3;if(Date.now()-o>s*1e3)throw new b("BAD_REQUEST",{message:Z.SESSION_EXPIRED})}const r=e.context.options.user.deleteUser?.beforeDelete;r&&await r(t.user,e.request),await e.context.internalAdapter.deleteUser(t.user.id),await e.context.internalAdapter.deleteSessions(t.user.id),await e.context.internalAdapter.deleteAccounts(t.user.id),zt(e);const n=e.context.options.user.deleteUser?.afterDelete;return n&&await n(t.user,e.request),e.json({success:!0,message:"User deleted"})});const Uy=X("/delete-user/callback",{method:"GET",query:F({token:g().meta({description:"The token to verify the deletion request"}),callbackURL:g().meta({description:"The URL to redirect to after deletion"}).optional()}),use:[Xn(e=>e.query.callbackURL)],metadata:{openapi:{description:"Callback to complete user deletion with verification token",responses:{200:{description:"User successfully deleted",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the deletion was successful"},message:{type:"string",enum:["User deleted"],description:"Confirmation message"}},required:["success","message"]}}}}}}}},async e=>{if(!e.context.options.user?.deleteUser?.enabled)throw e.context.logger.error("Delete user is disabled. Enable it in the options"),new b("NOT_FOUND");const t=await Ke(e);if(!t)throw new b("NOT_FOUND",{message:Z.FAILED_TO_GET_USER_INFO});const r=await e.context.internalAdapter.findVerificationValue(`delete-account-${e.query.token}`);if(!r||r.expiresAt<new Date)throw new b("NOT_FOUND",{message:Z.INVALID_TOKEN});if(r.value!==t.user.id)throw new b("NOT_FOUND",{message:Z.INVALID_TOKEN});const n=e.context.options.user.deleteUser?.beforeDelete;n&&await n(t.user,e.request),await e.context.internalAdapter.deleteUser(t.user.id),await e.context.internalAdapter.deleteSessions(t.user.id),await e.context.internalAdapter.deleteAccounts(t.user.id),await e.context.internalAdapter.deleteVerificationValue(r.id),zt(e);const o=e.context.options.user.deleteUser?.afterDelete;if(o&&await o(t.user,e.request),e.query.callbackURL)throw e.redirect(e.query.callbackURL||"/");return e.json({success:!0,message:"User deleted"})});X("/change-email",{method:"POST",body:F({newEmail:Ln().meta({description:"The new email address to set must be a valid email address"}),callbackURL:g().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[$e],metadata:{openapi:{responses:{200:{description:"Email change request processed successfully",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the request was successful"},message:{type:"string",enum:["Email updated","Verification email sent"],description:"Status message of the email change process",nullable:!0}},required:["status"]}}}}}}}},async e=>{if(!e.context.options.user?.changeEmail?.enabled)throw e.context.logger.error("Change email is disabled."),new b("BAD_REQUEST",{message:"Change email is disabled"});const t=e.body.newEmail.toLowerCase();if(t===e.context.session.user.email)throw e.context.logger.error("Email is the same"),new b("BAD_REQUEST",{message:"Email is the same"});if(await e.context.internalAdapter.findUserByEmail(t))throw e.context.logger.error("Email already exists"),new b("BAD_REQUEST",{message:"Couldn't update your email"});if(e.context.session.user.emailVerified!==!0){if(await e.context.internalAdapter.findUserByEmail(t))throw new b("UNPROCESSABLE_ENTITY",{message:Z.USER_ALREADY_EXISTS});if(await e.context.internalAdapter.updateUserByEmail(e.context.session.user.email,{email:t},e),await qe(e,{session:e.context.session.session,user:{...e.context.session.user,email:t}}),e.context.options.emailVerification?.sendVerificationEmail){const i=await Ot(e.context.secret,t,void 0,e.context.options.emailVerification?.expiresIn),a=`${e.context.baseURL}/verify-email?token=${i}&callbackURL=${e.body.callbackURL||"/"}`;await e.context.options.emailVerification.sendVerificationEmail({user:{...e.context.session.user,email:t},url:a,token:i},e.request)}return e.json({status:!0})}if(!e.context.options.user.changeEmail.sendChangeEmailVerification)throw e.context.logger.error("Verification email isn't enabled."),new b("BAD_REQUEST",{message:"Verification email isn't enabled"});const n=await Ot(e.context.secret,e.context.session.user.email,t,e.context.options.emailVerification?.expiresIn),o=`${e.context.baseURL}/verify-email?token=${n}&callbackURL=${e.body.callbackURL||"/"}`;return await e.context.options.user.changeEmail.sendChangeEmailVerification({user:e.context.session.user,newEmail:t,url:o,token:n},e.request),e.json({status:!0})});function xy(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}const zy=(e="Unknown")=>`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication Error</title>
    <style>
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --accent-color: #000000;
            --error-color: #dc3545;
            --border-color: #e9ecef;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            line-height: 1.5;
        }
        .error-container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 2.5rem;
            text-align: center;
            max-width: 90%;
            width: 400px;
        }
        h1 {
            color: var(--error-color);
            font-size: 1.75rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }
        p {
            margin-bottom: 1.5rem;
            color: #495057;
        }
        .btn {
            background-color: var(--accent-color);
            color: #ffffff;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            transition: all 0.3s ease;
            display: inline-block;
            font-weight: 500;
            border: 2px solid var(--accent-color);
        }
        .btn:hover {
            background-color: #131721;
        }
        .error-code {
            font-size: 0.875rem;
            color: #6c757d;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="icon">⚠️</div>
        <h1>Better Auth Error</h1>
        <p>We encountered an issue while processing your request. Please try again or contact the application owner if the problem persists.</p>
        <a href="/" id="returnLink" class="btn">Return to Application</a>
        <div class="error-code">Error Code: <span id="errorCode">${xy(e)}</span></div>
    </div>
</body>
</html>`;X("/error",{method:"GET",metadata:{...eo,openapi:{description:"Displays an error page",responses:{200:{description:"Success",content:{"text/html":{schema:{type:"string",description:"The HTML content of the error page"}}}}}}}},async e=>{const t=new URL(e.request?.url||"").searchParams.get("error")||"Unknown";return new Response(zy(t),{headers:{"Content-Type":"text/html"}})});X("/ok",{method:"GET",metadata:{...eo,openapi:{description:"Check if the API is working",responses:{200:{description:"API is working",content:{"application/json":{schema:{type:"object",properties:{ok:{type:"boolean",description:"Indicates if the API is working"}},required:["ok"]}}}}}}}},async e=>e.json({ok:!0}));X("/list-accounts",{method:"GET",use:[$e],metadata:{openapi:{description:"List all accounts linked to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string"},providerId:{type:"string"},createdAt:{type:"string",format:"date-time"},updatedAt:{type:"string",format:"date-time"},accountId:{type:"string"},scopes:{type:"array",items:{type:"string"}}},required:["id","providerId","createdAt","updatedAt","accountId","scopes"]}}}}}}}}},async e=>{const t=e.context.session,r=await e.context.internalAdapter.findAccounts(t.user.id);return e.json(r.map(n=>({id:n.id,providerId:n.providerId,createdAt:n.createdAt,updatedAt:n.updatedAt,accountId:n.accountId,scopes:n.scope?.split(",")||[]})))});X("/link-social",{method:"POST",requireHeaders:!0,body:F({callbackURL:g().meta({description:"The URL to redirect to after the user has signed in"}).optional(),provider:Ac,idToken:F({token:g(),nonce:g().optional(),accessToken:g().optional(),refreshToken:g().optional(),scopes:tt(g()).optional()}).optional(),requestSignUp:Ue().optional(),scopes:tt(g()).meta({description:"Additional scopes to request from the provider"}).optional(),errorCallbackURL:g().meta({description:"The URL to redirect to if there is an error during the link process"}).optional(),disableRedirect:Ue().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional()}),use:[$e],metadata:{openapi:{description:"Link a social account to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{url:{type:"string",description:"The authorization URL to redirect the user to"},redirect:{type:"boolean",description:"Indicates if the user should be redirected to the authorization URL"},status:{type:"boolean"}},required:["redirect"]}}}}}}}},async e=>{const t=e.context.session,r=e.context.socialProviders.find(s=>s.id===e.body.provider);if(!r)throw e.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:e.body.provider}),new b("NOT_FOUND",{message:Z.PROVIDER_NOT_FOUND});if(e.body.idToken){if(!r.verifyIdToken)throw e.context.logger.error("Provider does not support id token verification",{provider:e.body.provider}),new b("NOT_FOUND",{message:Z.ID_TOKEN_NOT_SUPPORTED});const{token:s,nonce:i}=e.body.idToken;if(!await r.verifyIdToken(s,i))throw e.context.logger.error("Invalid id token",{provider:e.body.provider}),new b("UNAUTHORIZED",{message:Z.INVALID_TOKEN});const c=await r.getUserInfo({idToken:s,accessToken:e.body.idToken.accessToken,refreshToken:e.body.idToken.refreshToken});if(!c||!c?.user)throw e.context.logger.error("Failed to get user info",{provider:e.body.provider}),new b("UNAUTHORIZED",{message:Z.FAILED_TO_GET_USER_INFO});const u=String(c.user.id);if(!c.user.email)throw e.context.logger.error("User email not found",{provider:e.body.provider}),new b("UNAUTHORIZED",{message:Z.USER_EMAIL_NOT_FOUND});if((await e.context.internalAdapter.findAccounts(t.user.id)).find(m=>m.providerId===r.id&&m.accountId===u))return e.json({url:"",status:!0,redirect:!1});if(!e.context.options.account?.accountLinking?.trustedProviders?.includes(r.id)&&!c.user.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)throw new b("UNAUTHORIZED",{message:"Account not linked - linking not allowed"});if(c.user.email!==t.user.email&&e.context.options.account?.accountLinking?.allowDifferentEmails!==!0)throw new b("UNAUTHORIZED",{message:"Account not linked - different emails not allowed"});try{await e.context.internalAdapter.createAccount({userId:t.user.id,providerId:r.id,accountId:u,accessToken:e.body.idToken.accessToken,idToken:s,refreshToken:e.body.idToken.refreshToken,scope:e.body.idToken.scopes?.join(",")},e)}catch{throw new b("EXPECTATION_FAILED",{message:"Account not linked - unable to create account"})}if(e.context.options.account?.accountLinking?.updateUserInfoOnLink===!0)try{await e.context.internalAdapter.updateUser(t.user.id,{name:c.user?.name,image:c.user?.image})}catch(m){console.warn("Could not update user - "+m.toString())}return e.json({url:"",status:!0,redirect:!1})}const n=await bc(e,{userId:t.user.id,email:t.user.email}),o=await r.createAuthorizationURL({state:n.state,codeVerifier:n.codeVerifier,redirectURI:`${e.context.baseURL}/callback/${r.id}`,scopes:e.body.scopes});return e.json({url:o.toString(),redirect:!e.body.disableRedirect})});X("/unlink-account",{method:"POST",body:F({providerId:g(),accountId:g().optional()}),use:[Tm],metadata:{openapi:{description:"Unlink an account",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async e=>{const{providerId:t,accountId:r}=e.body,n=await e.context.internalAdapter.findAccounts(e.context.session.user.id);if(n.length===1&&!e.context.options.account?.accountLinking?.allowUnlinkingAll)throw new b("BAD_REQUEST",{message:Z.FAILED_TO_UNLINK_LAST_ACCOUNT});const o=n.find(s=>r?s.accountId===r&&s.providerId===t:s.providerId===t);if(!o)throw new b("BAD_REQUEST",{message:Z.ACCOUNT_NOT_FOUND});return await e.context.internalAdapter.deleteAccount(o.id),e.json({status:!0})});const $y=X("/get-access-token",{method:"POST",body:F({providerId:g().meta({description:"The provider ID for the OAuth provider"}),accountId:g().meta({description:"The account ID associated with the refresh token"}).optional(),userId:g().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Get a valid access token, doing a refresh if needed",responses:{200:{description:"A Valid access token",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},refreshToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"},refreshTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async e=>{const{providerId:t,accountId:r,userId:n}=e.body,o=e.request,s=await Ke(e);if(o&&!s)throw e.error("UNAUTHORIZED");let i=s?.user?.id||n;if(!i)throw new b("BAD_REQUEST",{message:"Either userId or session is required"});if(!e.context.socialProviders.find(l=>l.id===t))throw new b("BAD_REQUEST",{message:`Provider ${t} is not supported.`});const c=(await e.context.internalAdapter.findAccounts(i)).find(l=>r?l.id===r&&l.providerId===t:l.providerId===t);if(!c)throw new b("BAD_REQUEST",{message:"Account not found"});const u=e.context.socialProviders.find(l=>l.id===t);if(!u)throw new b("BAD_REQUEST",{message:`Provider ${t} not found.`});try{let l=null;const d=c.accessTokenExpiresAt&&new Date(c.accessTokenExpiresAt).getTime()-Date.now()<5e3;c.refreshToken&&d&&u.refreshAccessToken&&(l=await u.refreshAccessToken(c.refreshToken),await e.context.internalAdapter.updateAccount(c.id,{accessToken:await ye(l.accessToken,e.context),accessTokenExpiresAt:l.accessTokenExpiresAt,refreshToken:await ye(l.refreshToken,e.context),refreshTokenExpiresAt:l.refreshTokenExpiresAt}));const f={accessToken:await Bg(l?.accessToken??c.accessToken??"",e.context),accessTokenExpiresAt:l?.accessTokenExpiresAt??c.accessTokenExpiresAt??void 0,scopes:c.scope?.split(",")??[],idToken:l?.idToken??c.idToken??void 0};return e.json(f)}catch(l){throw new b("BAD_REQUEST",{message:"Failed to get a valid access token",cause:l})}});X("/refresh-token",{method:"POST",body:F({providerId:g().meta({description:"The provider ID for the OAuth provider"}),accountId:g().meta({description:"The account ID associated with the refresh token"}).optional(),userId:g().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Refresh the access token using a refresh token",responses:{200:{description:"Access token refreshed successfully",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},refreshToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"},refreshTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async e=>{const{providerId:t,accountId:r,userId:n}=e.body,o=e.request,s=await Ke(e);if(o&&!s)throw e.error("UNAUTHORIZED");let i=s?.user?.id||n;if(!i)throw new b("BAD_REQUEST",{message:"Either userId or session is required"});const c=(await e.context.internalAdapter.findAccounts(i)).find(l=>r?l.id===r&&l.providerId===t:l.providerId===t);if(!c)throw new b("BAD_REQUEST",{message:"Account not found"});const u=e.context.socialProviders.find(l=>l.id===t);if(!u)throw new b("BAD_REQUEST",{message:`Provider ${t} not found.`});if(!u.refreshAccessToken)throw new b("BAD_REQUEST",{message:`Provider ${t} does not support token refreshing.`});try{const l=await u.refreshAccessToken(c.refreshToken);return await e.context.internalAdapter.updateAccount(c.id,{accessToken:await ye(l.accessToken,e.context),refreshToken:await ye(l.refreshToken,e.context),accessTokenExpiresAt:l.accessTokenExpiresAt,refreshTokenExpiresAt:l.refreshTokenExpiresAt}),e.json(l)}catch(l){throw new b("BAD_REQUEST",{message:"Failed to refresh access token",cause:l})}});X("/account-info",{method:"POST",use:[$e],metadata:{openapi:{description:"Get the account info provided by the provider",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",properties:{id:{type:"string"},name:{type:"string"},email:{type:"string"},image:{type:"string"},emailVerified:{type:"boolean"}},required:["id","emailVerified"]},data:{type:"object",properties:{},additionalProperties:!0}},required:["user","data"],additionalProperties:!1}}}}}}},body:F({accountId:g().meta({description:"The provider given account id for which to get the account info"})})},async e=>{const t=await e.context.internalAdapter.findAccount(e.body.accountId);if(!t||t.userId!==e.context.session.user.id)throw new b("BAD_REQUEST",{message:"Account not found"});const r=e.context.socialProviders.find(s=>s.id===t.providerId);if(!r)throw new b("INTERNAL_SERVER_ERROR",{message:`Provider account provider is ${t.providerId} but it is not configured`});const n=await $y({...e,body:{accountId:t.id,providerId:t.providerId},returnHeaders:!1});if(!n.accessToken)throw new b("BAD_REQUEST",{message:"Access token not found"});const o=await r.getUserInfo({...n,accessToken:n.accessToken});return e.json(o)});const Oy=()=>({id:"magic-link",$InferServerPlugin:{}});ht(async()=>({}));ht({use:[$e]},async e=>({session:e.context.session}));const Ec=g(),Py=It(["pending","accepted","rejected","canceled"]).default("pending");F({id:g().default(st),name:g(),slug:g(),logo:g().nullish().optional(),metadata:qn(g(),St()).or(g().transform(e=>JSON.parse(e))).optional(),createdAt:ge()});F({id:g().default(st),organizationId:g(),userId:Yt(),role:Ec,createdAt:ge().default(()=>new Date)});F({id:g().default(st),organizationId:g(),email:g(),role:Ec,status:Py,teamId:g().nullish(),inviterId:g(),expiresAt:ge()});F({id:g().default(st),name:g().min(1),organizationId:g(),createdAt:ge(),updatedAt:ge().optional()});F({id:g().default(st),teamId:g(),userId:g(),createdAt:ge().default(()=>new Date)});F({id:g().default(st),organizationId:g(),role:g(),permission:qn(g(),tt(g())),createdAt:ge().default(()=>new Date),updatedAt:ge().optional()});const Fo=["admin","member","owner"];Bn([It(Fo),tt(It(Fo))]);Rt(F({disableCookieCache:Ue().meta({description:"Disable cookie cache and fetch session from database"}).or(g().transform(e=>e==="true")).optional(),disableRefresh:Ue().meta({description:"Disable session refresh. Useful for checking session status, without updating the session"}).optional()}));F({id:g(),deviceCode:g(),userCode:g(),userId:g().optional(),expiresAt:ge(),status:g(),lastPolledAt:ge().optional(),pollingInterval:Tt().optional(),clientId:g().optional(),scope:g().optional()});const Bo=wt(e=>{try{bm(e)}catch{return!1}return!0},{message:"Invalid time string format. Use formats like '30m', '5s', '1h', etc."});F({expiresIn:Bo.default("30m").describe("Time in seconds until the device code expires. Use formats like '30m', '5s', '1h', etc."),interval:Bo.default("5s").describe("Time in seconds between polling attempts. Use formats like '30m', '5s', '1h', etc."),deviceCodeLength:Tt().int().positive().default(40).describe("Length of the device code to be generated. Default is 40 characters."),userCodeLength:Tt().int().positive().default(8).describe("Length of the user code to be generated. Default is 8 characters."),generateDeviceCode:wt(e=>typeof e=="function",{message:"generateDeviceCode must be a function that returns a string or a promise that resolves to a string."}).optional().describe("Function to generate a device code. If not provided, a default random string generator will be used."),generateUserCode:wt(e=>typeof e=="function",{message:"generateUserCode must be a function that returns a string or a promise that resolves to a string."}).optional().describe("Function to generate a user code. If not provided, a default random string generator will be used."),validateClient:wt(e=>typeof e=="function",{message:"validateClient must be a function that returns a boolean or a promise that resolves to a boolean."}).optional().describe("Function to validate the client ID. If not provided, no validation will be performed."),onDeviceAuthRequest:wt(e=>typeof e=="function",{message:"onDeviceAuthRequest must be a function that returns void or a promise that resolves to void."}).optional().describe("Function to handle device authorization requests. If not provided, no additional actions will be taken."),schema:wt(()=>!0)});var Cy=()=>({id:"polar-client",$InferServerPlugin:{}});const E_=Du({plugins:[Oy(),Cy()]});function Tc(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=Tc(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Sc(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=Tc(e))&&(n&&(n+=" "),n+=t);return n}const to="-",Dy=e=>{const t=Ly(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const a=i.split(to);return a[0]===""&&a.length!==1&&a.shift(),Ic(a,t)||Ny(i)},getConflictingClassGroupIds:(i,a)=>{const c=r[i]||[];return a&&n[i]?[...c,...n[i]]:c}}},Ic=(e,t)=>{if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),o=n?Ic(e.slice(1),n):void 0;if(o)return o;if(t.validators.length===0)return;const s=e.join(to);return t.validators.find(({validator:i})=>i(s))?.classGroupId},qo=/^\[(.+)\]$/,Ny=e=>{if(qo.test(e)){const t=qo.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Ly=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const o in r)Un(r[o],n,o,t);return n},Un=(e,t,r,n)=>{e.forEach(o=>{if(typeof o=="string"){const s=o===""?t:Ko(t,o);s.classGroupId=r;return}if(typeof o=="function"){if(Zy(o)){Un(o(n),t,r,n);return}t.validators.push({validator:o,classGroupId:r});return}Object.entries(o).forEach(([s,i])=>{Un(i,Ko(t,s),r,n)})})},Ko=(e,t)=>{let r=e;return t.split(to).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Zy=e=>e.isThemeGetter,jy=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const o=(s,i)=>{r.set(s,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let i=r.get(s);if(i!==void 0)return i;if((i=n.get(s))!==void 0)return o(s,i),i},set(s,i){r.has(s)?r.set(s,i):o(s,i)}}},xn="!",zn=":",Vy=zn.length,My=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=o=>{const s=[];let i=0,a=0,c=0,u;for(let m=0;m<o.length;m++){let w=o[m];if(i===0&&a===0){if(w===zn){s.push(o.slice(c,m)),c=m+Vy;continue}if(w==="/"){u=m;continue}}w==="["?i++:w==="]"?i--:w==="("?a++:w===")"&&a--}const l=s.length===0?o:o.substring(c),d=Fy(l),f=d!==l,h=u&&u>c?u-c:void 0;return{modifiers:s,hasImportantModifier:f,baseClassName:d,maybePostfixModifierPosition:h}};if(t){const o=t+zn,s=n;n=i=>i.startsWith(o)?s(i.substring(o.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:i,maybePostfixModifierPosition:void 0}}if(r){const o=n;n=s=>r({className:s,parseClassName:o})}return n},Fy=e=>e.endsWith(xn)?e.substring(0,e.length-1):e.startsWith(xn)?e.substring(1):e,By=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const o=[];let s=[];return n.forEach(i=>{i[0]==="["||t[i]?(o.push(...s.sort(),i),s=[]):s.push(i)}),o.push(...s.sort()),o}},qy=e=>({cache:jy(e.cacheSize),parseClassName:My(e),sortModifiers:By(e),...Dy(e)}),Ky=/\s+/,Wy=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:o,sortModifiers:s}=t,i=[],a=e.trim().split(Ky);let c="";for(let u=a.length-1;u>=0;u-=1){const l=a[u],{isExternal:d,modifiers:f,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:w}=r(l);if(d){c=l+(c.length>0?" "+c:c);continue}let _=!!w,E=n(_?m.substring(0,w):m);if(!E){if(!_){c=l+(c.length>0?" "+c:c);continue}if(E=n(m),!E){c=l+(c.length>0?" "+c:c);continue}_=!1}const A=s(f).join(":"),v=h?A+xn:A,T=v+E;if(i.includes(T))continue;i.push(T);const H=o(E,_);for(let x=0;x<H.length;++x){const q=H[x];i.push(v+q)}c=l+(c.length>0?" "+c:c)}return c};function Hy(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=Rc(t))&&(n&&(n+=" "),n+=r);return n}const Rc=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=Rc(e[n]))&&(r&&(r+=" "),r+=t);return r};function Jy(e,...t){let r,n,o,s=i;function i(c){const u=t.reduce((l,d)=>d(l),e());return r=qy(u),n=r.cache.get,o=r.cache.set,s=a,a(c)}function a(c){const u=n(c);if(u)return u;const l=Wy(c,r);return o(c,l),l}return function(){return s(Hy.apply(null,arguments))}}const de=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},Uc=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,xc=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Gy=/^\d+\/\d+$/,Qy=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yy=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Xy=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,ew=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,tw=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,yt=e=>Gy.test(e),j=e=>!!e&&!Number.isNaN(Number(e)),He=e=>!!e&&Number.isInteger(Number(e)),nn=e=>e.endsWith("%")&&j(e.slice(0,-1)),Be=e=>Qy.test(e),rw=()=>!0,nw=e=>Yy.test(e)&&!Xy.test(e),zc=()=>!1,ow=e=>ew.test(e),sw=e=>tw.test(e),iw=e=>!I(e)&&!R(e),aw=e=>Ct(e,Pc,zc),I=e=>Uc.test(e),ct=e=>Ct(e,Cc,nw),on=e=>Ct(e,fw,j),Wo=e=>Ct(e,$c,zc),cw=e=>Ct(e,Oc,sw),dr=e=>Ct(e,Dc,ow),R=e=>xc.test(e),Zt=e=>Dt(e,Cc),uw=e=>Dt(e,pw),Ho=e=>Dt(e,$c),lw=e=>Dt(e,Pc),dw=e=>Dt(e,Oc),fr=e=>Dt(e,Dc,!0),Ct=(e,t,r)=>{const n=Uc.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},Dt=(e,t,r=!1)=>{const n=xc.exec(e);return n?n[1]?t(n[1]):r:!1},$c=e=>e==="position"||e==="percentage",Oc=e=>e==="image"||e==="url",Pc=e=>e==="length"||e==="size"||e==="bg-size",Cc=e=>e==="length",fw=e=>e==="number",pw=e=>e==="family-name",Dc=e=>e==="shadow",hw=()=>{const e=de("color"),t=de("font"),r=de("text"),n=de("font-weight"),o=de("tracking"),s=de("leading"),i=de("breakpoint"),a=de("container"),c=de("spacing"),u=de("radius"),l=de("shadow"),d=de("inset-shadow"),f=de("text-shadow"),h=de("drop-shadow"),m=de("blur"),w=de("perspective"),_=de("aspect"),E=de("ease"),A=de("animate"),v=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],H=()=>[...T(),R,I],x=()=>["auto","hidden","clip","visible","scroll"],q=()=>["auto","contain","none"],S=()=>[R,I,c],P=()=>[yt,"full","auto",...S()],B=()=>[He,"none","subgrid",R,I],J=()=>["auto",{span:["full",He,R,I]},He,R,I],K=()=>[He,"auto",R,I],L=()=>["auto","min","max","fr",R,I],$=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],D=()=>["start","end","center","stretch","center-safe","end-safe"],O=()=>["auto",...S()],W=()=>[yt,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...S()],k=()=>[e,R,I],z=()=>[...T(),Ho,Wo,{position:[R,I]}],te=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ie=()=>["auto","cover","contain",lw,aw,{size:[R,I]}],Y=()=>[nn,Zt,ct],re=()=>["","none","full",u,R,I],le=()=>["",j,Zt,ct],ve=()=>["solid","dashed","dotted","double"],Ve=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ne=()=>[j,nn,Ho,Wo],Me=()=>["","none",m,R,I],ke=()=>["none",j,R,I],Xt=()=>["none",j,R,I],Jr=()=>[j,R,I],er=()=>[yt,"full",...S()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Be],breakpoint:[Be],color:[rw],container:[Be],"drop-shadow":[Be],ease:["in","out","in-out"],font:[iw],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Be],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Be],shadow:[Be],spacing:["px",j],text:[Be],"text-shadow":[Be],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",yt,I,R,_]}],container:["container"],columns:[{columns:[j,I,R,a]}],"break-after":[{"break-after":v()}],"break-before":[{"break-before":v()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:H()}],overflow:[{overflow:x()}],"overflow-x":[{"overflow-x":x()}],"overflow-y":[{"overflow-y":x()}],overscroll:[{overscroll:q()}],"overscroll-x":[{"overscroll-x":q()}],"overscroll-y":[{"overscroll-y":q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:P()}],"inset-x":[{"inset-x":P()}],"inset-y":[{"inset-y":P()}],start:[{start:P()}],end:[{end:P()}],top:[{top:P()}],right:[{right:P()}],bottom:[{bottom:P()}],left:[{left:P()}],visibility:["visible","invisible","collapse"],z:[{z:[He,"auto",R,I]}],basis:[{basis:[yt,"full","auto",a,...S()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[j,yt,"auto","initial","none",I]}],grow:[{grow:["",j,R,I]}],shrink:[{shrink:["",j,R,I]}],order:[{order:[He,"first","last","none",R,I]}],"grid-cols":[{"grid-cols":B()}],"col-start-end":[{col:J()}],"col-start":[{"col-start":K()}],"col-end":[{"col-end":K()}],"grid-rows":[{"grid-rows":B()}],"row-start-end":[{row:J()}],"row-start":[{"row-start":K()}],"row-end":[{"row-end":K()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":L()}],"auto-rows":[{"auto-rows":L()}],gap:[{gap:S()}],"gap-x":[{"gap-x":S()}],"gap-y":[{"gap-y":S()}],"justify-content":[{justify:[...$(),"normal"]}],"justify-items":[{"justify-items":[...D(),"normal"]}],"justify-self":[{"justify-self":["auto",...D()]}],"align-content":[{content:["normal",...$()]}],"align-items":[{items:[...D(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...D(),{baseline:["","last"]}]}],"place-content":[{"place-content":$()}],"place-items":[{"place-items":[...D(),"baseline"]}],"place-self":[{"place-self":["auto",...D()]}],p:[{p:S()}],px:[{px:S()}],py:[{py:S()}],ps:[{ps:S()}],pe:[{pe:S()}],pt:[{pt:S()}],pr:[{pr:S()}],pb:[{pb:S()}],pl:[{pl:S()}],m:[{m:O()}],mx:[{mx:O()}],my:[{my:O()}],ms:[{ms:O()}],me:[{me:O()}],mt:[{mt:O()}],mr:[{mr:O()}],mb:[{mb:O()}],ml:[{ml:O()}],"space-x":[{"space-x":S()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":S()}],"space-y-reverse":["space-y-reverse"],size:[{size:W()}],w:[{w:[a,"screen",...W()]}],"min-w":[{"min-w":[a,"screen","none",...W()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[i]},...W()]}],h:[{h:["screen","lh",...W()]}],"min-h":[{"min-h":["screen","lh","none",...W()]}],"max-h":[{"max-h":["screen","lh",...W()]}],"font-size":[{text:["base",r,Zt,ct]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,R,on]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",nn,I]}],"font-family":[{font:[uw,I,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,R,I]}],"line-clamp":[{"line-clamp":[j,"none",R,on]}],leading:[{leading:[s,...S()]}],"list-image":[{"list-image":["none",R,I]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",R,I]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:k()}],"text-color":[{text:k()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ve(),"wavy"]}],"text-decoration-thickness":[{decoration:[j,"from-font","auto",R,ct]}],"text-decoration-color":[{decoration:k()}],"underline-offset":[{"underline-offset":[j,"auto",R,I]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",R,I]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",R,I]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:z()}],"bg-repeat":[{bg:te()}],"bg-size":[{bg:ie()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},He,R,I],radial:["",R,I],conic:[He,R,I]},dw,cw]}],"bg-color":[{bg:k()}],"gradient-from-pos":[{from:Y()}],"gradient-via-pos":[{via:Y()}],"gradient-to-pos":[{to:Y()}],"gradient-from":[{from:k()}],"gradient-via":[{via:k()}],"gradient-to":[{to:k()}],rounded:[{rounded:re()}],"rounded-s":[{"rounded-s":re()}],"rounded-e":[{"rounded-e":re()}],"rounded-t":[{"rounded-t":re()}],"rounded-r":[{"rounded-r":re()}],"rounded-b":[{"rounded-b":re()}],"rounded-l":[{"rounded-l":re()}],"rounded-ss":[{"rounded-ss":re()}],"rounded-se":[{"rounded-se":re()}],"rounded-ee":[{"rounded-ee":re()}],"rounded-es":[{"rounded-es":re()}],"rounded-tl":[{"rounded-tl":re()}],"rounded-tr":[{"rounded-tr":re()}],"rounded-br":[{"rounded-br":re()}],"rounded-bl":[{"rounded-bl":re()}],"border-w":[{border:le()}],"border-w-x":[{"border-x":le()}],"border-w-y":[{"border-y":le()}],"border-w-s":[{"border-s":le()}],"border-w-e":[{"border-e":le()}],"border-w-t":[{"border-t":le()}],"border-w-r":[{"border-r":le()}],"border-w-b":[{"border-b":le()}],"border-w-l":[{"border-l":le()}],"divide-x":[{"divide-x":le()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":le()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ve(),"hidden","none"]}],"divide-style":[{divide:[...ve(),"hidden","none"]}],"border-color":[{border:k()}],"border-color-x":[{"border-x":k()}],"border-color-y":[{"border-y":k()}],"border-color-s":[{"border-s":k()}],"border-color-e":[{"border-e":k()}],"border-color-t":[{"border-t":k()}],"border-color-r":[{"border-r":k()}],"border-color-b":[{"border-b":k()}],"border-color-l":[{"border-l":k()}],"divide-color":[{divide:k()}],"outline-style":[{outline:[...ve(),"none","hidden"]}],"outline-offset":[{"outline-offset":[j,R,I]}],"outline-w":[{outline:["",j,Zt,ct]}],"outline-color":[{outline:k()}],shadow:[{shadow:["","none",l,fr,dr]}],"shadow-color":[{shadow:k()}],"inset-shadow":[{"inset-shadow":["none",d,fr,dr]}],"inset-shadow-color":[{"inset-shadow":k()}],"ring-w":[{ring:le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:k()}],"ring-offset-w":[{"ring-offset":[j,ct]}],"ring-offset-color":[{"ring-offset":k()}],"inset-ring-w":[{"inset-ring":le()}],"inset-ring-color":[{"inset-ring":k()}],"text-shadow":[{"text-shadow":["none",f,fr,dr]}],"text-shadow-color":[{"text-shadow":k()}],opacity:[{opacity:[j,R,I]}],"mix-blend":[{"mix-blend":[...Ve(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ve()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[j]}],"mask-image-linear-from-pos":[{"mask-linear-from":ne()}],"mask-image-linear-to-pos":[{"mask-linear-to":ne()}],"mask-image-linear-from-color":[{"mask-linear-from":k()}],"mask-image-linear-to-color":[{"mask-linear-to":k()}],"mask-image-t-from-pos":[{"mask-t-from":ne()}],"mask-image-t-to-pos":[{"mask-t-to":ne()}],"mask-image-t-from-color":[{"mask-t-from":k()}],"mask-image-t-to-color":[{"mask-t-to":k()}],"mask-image-r-from-pos":[{"mask-r-from":ne()}],"mask-image-r-to-pos":[{"mask-r-to":ne()}],"mask-image-r-from-color":[{"mask-r-from":k()}],"mask-image-r-to-color":[{"mask-r-to":k()}],"mask-image-b-from-pos":[{"mask-b-from":ne()}],"mask-image-b-to-pos":[{"mask-b-to":ne()}],"mask-image-b-from-color":[{"mask-b-from":k()}],"mask-image-b-to-color":[{"mask-b-to":k()}],"mask-image-l-from-pos":[{"mask-l-from":ne()}],"mask-image-l-to-pos":[{"mask-l-to":ne()}],"mask-image-l-from-color":[{"mask-l-from":k()}],"mask-image-l-to-color":[{"mask-l-to":k()}],"mask-image-x-from-pos":[{"mask-x-from":ne()}],"mask-image-x-to-pos":[{"mask-x-to":ne()}],"mask-image-x-from-color":[{"mask-x-from":k()}],"mask-image-x-to-color":[{"mask-x-to":k()}],"mask-image-y-from-pos":[{"mask-y-from":ne()}],"mask-image-y-to-pos":[{"mask-y-to":ne()}],"mask-image-y-from-color":[{"mask-y-from":k()}],"mask-image-y-to-color":[{"mask-y-to":k()}],"mask-image-radial":[{"mask-radial":[R,I]}],"mask-image-radial-from-pos":[{"mask-radial-from":ne()}],"mask-image-radial-to-pos":[{"mask-radial-to":ne()}],"mask-image-radial-from-color":[{"mask-radial-from":k()}],"mask-image-radial-to-color":[{"mask-radial-to":k()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":T()}],"mask-image-conic-pos":[{"mask-conic":[j]}],"mask-image-conic-from-pos":[{"mask-conic-from":ne()}],"mask-image-conic-to-pos":[{"mask-conic-to":ne()}],"mask-image-conic-from-color":[{"mask-conic-from":k()}],"mask-image-conic-to-color":[{"mask-conic-to":k()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:z()}],"mask-repeat":[{mask:te()}],"mask-size":[{mask:ie()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",R,I]}],filter:[{filter:["","none",R,I]}],blur:[{blur:Me()}],brightness:[{brightness:[j,R,I]}],contrast:[{contrast:[j,R,I]}],"drop-shadow":[{"drop-shadow":["","none",h,fr,dr]}],"drop-shadow-color":[{"drop-shadow":k()}],grayscale:[{grayscale:["",j,R,I]}],"hue-rotate":[{"hue-rotate":[j,R,I]}],invert:[{invert:["",j,R,I]}],saturate:[{saturate:[j,R,I]}],sepia:[{sepia:["",j,R,I]}],"backdrop-filter":[{"backdrop-filter":["","none",R,I]}],"backdrop-blur":[{"backdrop-blur":Me()}],"backdrop-brightness":[{"backdrop-brightness":[j,R,I]}],"backdrop-contrast":[{"backdrop-contrast":[j,R,I]}],"backdrop-grayscale":[{"backdrop-grayscale":["",j,R,I]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[j,R,I]}],"backdrop-invert":[{"backdrop-invert":["",j,R,I]}],"backdrop-opacity":[{"backdrop-opacity":[j,R,I]}],"backdrop-saturate":[{"backdrop-saturate":[j,R,I]}],"backdrop-sepia":[{"backdrop-sepia":["",j,R,I]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":S()}],"border-spacing-x":[{"border-spacing-x":S()}],"border-spacing-y":[{"border-spacing-y":S()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",R,I]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[j,"initial",R,I]}],ease:[{ease:["linear","initial",E,R,I]}],delay:[{delay:[j,R,I]}],animate:[{animate:["none",A,R,I]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,R,I]}],"perspective-origin":[{"perspective-origin":H()}],rotate:[{rotate:ke()}],"rotate-x":[{"rotate-x":ke()}],"rotate-y":[{"rotate-y":ke()}],"rotate-z":[{"rotate-z":ke()}],scale:[{scale:Xt()}],"scale-x":[{"scale-x":Xt()}],"scale-y":[{"scale-y":Xt()}],"scale-z":[{"scale-z":Xt()}],"scale-3d":["scale-3d"],skew:[{skew:Jr()}],"skew-x":[{"skew-x":Jr()}],"skew-y":[{"skew-y":Jr()}],transform:[{transform:[R,I,"","none","gpu","cpu"]}],"transform-origin":[{origin:H()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:er()}],"translate-x":[{"translate-x":er()}],"translate-y":[{"translate-y":er()}],"translate-z":[{"translate-z":er()}],"translate-none":["translate-none"],accent:[{accent:k()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:k()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",R,I]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",R,I]}],fill:[{fill:["none",...k()]}],"stroke-w":[{stroke:[j,Zt,ct,on]}],stroke:[{stroke:["none",...k()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},mw=Jy(hw);function gw(...e){return mw(Sc(e))}function Jo(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Nc(...e){return t=>{let r=!1;const n=e.map(o=>{const s=Jo(o,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let o=0;o<n.length;o++){const s=n[o];typeof s=="function"?s():Jo(e[o],null)}}}}function T_(...e){return fe.useCallback(Nc(...e),e)}function yw(e){const t=bw(e),r=fe.forwardRef((n,o)=>{const{children:s,...i}=n,a=fe.Children.toArray(s),c=a.find(_w);if(c){const u=c.props.children,l=a.map(d=>d===c?fe.Children.count(u)>1?fe.Children.only(null):fe.isValidElement(u)?u.props.children:null:d);return Ft.jsx(t,{...i,ref:o,children:fe.isValidElement(u)?fe.cloneElement(u,void 0,l):null})}return Ft.jsx(t,{...i,ref:o,children:s})});return r.displayName=`${e}.Slot`,r}var ww=yw("Slot");function bw(e){const t=fe.forwardRef((r,n)=>{const{children:o,...s}=r;if(fe.isValidElement(o)){const i=kw(o),a=vw(s,o.props);return o.type!==fe.Fragment&&(a.ref=n?Nc(n,i):i),fe.cloneElement(o,a)}return fe.Children.count(o)>1?fe.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Lc=Symbol("radix.slottable");function S_(e){const t=({children:r})=>Ft.jsx(Ft.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=Lc,t}function _w(e){return fe.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Lc}function vw(e,t){const r={...t};for(const n in t){const o=e[n],s=t[n];/^on[A-Z]/.test(n)?o&&s?r[n]=(...a)=>{const c=s(...a);return o(...a),c}:o&&(r[n]=o):n==="style"?r[n]={...o,...s}:n==="className"&&(r[n]=[o,s].filter(Boolean).join(" "))}return{...e,...r}}function kw(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const Go=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Qo=Sc,Aw=(e,t)=>r=>{var n;if(t?.variants==null)return Qo(e,r?.class,r?.className);const{variants:o,defaultVariants:s}=t,i=Object.keys(o).map(u=>{const l=r?.[u],d=s?.[u];if(l===null)return null;const f=Go(l)||Go(d);return o[u][f]}),a=r&&Object.entries(r).reduce((u,l)=>{let[d,f]=l;return f===void 0||(u[d]=f),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,l)=>{let{class:d,className:f,...h}=l;return Object.entries(h).every(m=>{let[w,_]=m;return Array.isArray(_)?_.includes({...s,...a}[w]):{...s,...a}[w]===_})?[...u,d,f]:u},[]);return Qo(e,i,c,r?.class,r?.className)},Ew=Aw("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function I_({className:e,variant:t,size:r,asChild:n=!1,...o}){const s=n?ww:"button";return Ft.jsx(s,{"data-slot":"button",className:gw(Ew({variant:t,size:r,className:e})),...o})}export{uf as $,Dl as A,Jl as B,jl as C,Nl as D,Ol as E,Pl as F,Gl as G,Hl as H,Ml as I,Ll as J,Kl as K,jr as L,Bl as M,_i as N,cf as O,Ed as P,Pd as Q,Jd as R,Ld as S,vd as T,td as U,nd as V,$n as W,Fd as X,ks as Y,qd as Z,of as _,os as a,Di as a$,Xl as a0,hd as a1,md as a2,dd as a3,ld as a4,pd as a5,fd as a6,Zd as a7,Ad as a8,ud as a9,Kd as aA,bi as aB,C as aC,ad as aD,rd as aE,ed as aF,Rd as aG,wi as aH,zd as aI,Od as aJ,cd as aK,Iw as aL,p as aM,Vw as aN,jw as aO,Ql as aP,Sw as aQ,Mw as aR,Of as aS,Yf as aT,Ni as aU,Li as aV,Sf as aW,Ef as aX,lb as aY,np as aZ,Ci as a_,af as aa,Bd as ab,Vd as ac,ef as ad,od as ae,$d as af,Qd as ag,Ud as ah,Hd as ai,pi as aj,Td as ak,Dd as al,Nd as am,Wd as an,tf as ao,Gd as ap,sf as aq,rf as ar,be as as,jd as at,Md as au,Vr as av,oe as aw,Yd as ax,Id as ay,nf as az,xd as b,yf as b$,If as b0,Tf as b1,Lf as b2,wf as b3,ff as b4,Ri as b5,Ui as b6,ep as b7,Nf as b8,Es as b9,mf as bA,ji as bB,$i as bC,hb as bD,Fi as bE,nb as bF,Mf as bG,Bt as bH,Qe as bI,Xw as bJ,Mi as bK,Vi as bL,Wf as bM,_r as bN,dn as bO,ln as bP,Zf as bQ,Ii as bR,rb as bS,Bw as bT,Cf as bU,Kw as bV,cb as bW,qw as bX,Hf as bY,$f as bZ,ib as b_,Ss as ba,ab as bb,Jw as bc,Zi as bd,vi as be,Si as bf,As as bg,Ts as bh,Kf as bi,tb as bj,Xf as bk,_f as bl,vf as bm,qt as bn,Ce as bo,un as bp,Bf as bq,bf as br,kf as bs,Rf as bt,Gw as bu,Oi as bv,Pi as bw,hf as bx,pf as by,gf as bz,Cd as c,lf as c$,sb as c0,Gt as c1,Dr as c2,Nr as c3,db as c4,Fw as c5,mb as c6,Ww as c7,fb as c8,Yw as c9,zf as cA,Hw as cB,Pf as cC,Ff as cD,Dn as cE,ki as cF,Ai as cG,Ei as cH,Ti as cI,Df as cJ,zi as cK,je as cL,Ze as cM,Ow as cN,Cw as cO,$w as cP,Pw as cQ,rl as cR,nl as cS,sn as cT,fi as cU,bd as cV,kd as cW,lo as cX,fo as cY,zw as cZ,$l as c_,tp as ca,Vf as cb,Rs as cc,xs as cd,Is as ce,Us as cf,Lr as cg,Zr as ch,eb as ci,jf as cj,qf as ck,df as cl,Mr as cm,op as cn,ub as co,rp as cp,xf as cq,pb as cr,Gf as cs,Qf as ct,ob as cu,Jf as cv,Qw as cw,Af as cx,Uf as cy,xi as cz,_t as d,_e as d$,Nw as d0,Zw as d1,Dw as d2,Lw as d3,sl as d4,il as d5,ol as d6,xw as d7,Uw as d8,Yl as d9,fn as dA,ca as dB,ua as dC,Ki as dD,Bi as dE,Gi as dF,Hi as dG,Ip as dH,ma as dI,aa as dJ,Jp as dK,Op as dL,zp as dM,qp as dN,ra as dO,Ap as dP,Aa as dQ,bp as dR,Dp as dS,jn as dT,Qt as dU,Fn as dV,ka as dW,Ea as dX,Zp as dY,Qp as dZ,Kp as d_,vp as da,Tp as db,fa as dc,pa as dd,Mn as de,ga as df,Vn as dg,la as dh,da as di,na as dj,oa as dk,Fp as dl,Ta as dm,Kn as dn,Fr as dp,wa as dq,Np as dr,Sp as ds,ha as dt,ea as du,ta as dv,vr as dw,yb as dx,Pp as dy,Yp as dz,wd as e,Zb as e$,_a as e0,$p as e1,Nn as e2,ae as e3,Mp as e4,yp as e5,Hp as e6,Cp as e7,Up as e8,V as e9,ge as eA,lp as eB,fp as eC,o_ as eD,Lb as eE,Ln as eF,Tb as eG,up as eH,dp as eI,It as eJ,l_ as eK,Bb as eL,qb as eM,wb as eN,Fb as eO,Mb as eP,Vb as eQ,Eb as eR,b_ as eS,Eo as eT,Kb as eU,Jb as eV,Rp as eW,$b as eX,Ob as eY,gb as eZ,v_ as e_,sa as ea,Zn as eb,Ge as ec,wp as ed,ba as ee,kp as ef,Ep as eg,ia as eh,Xi as ei,Lp as ej,y_ as ek,Xb as el,tt as em,Db as en,Nb as eo,Hb as ep,Ue as eq,Bp as er,w_ as es,Pb as et,Cb as eu,h_ as ev,A_ as ew,Ib as ex,Rb as ey,wt as ez,_d as f,ww as f$,t_ as f0,zb as f1,Gp as f2,u_ as f3,n_ as f4,i_ as f5,p_ as f6,Sb as f7,c_ as f8,ya as f9,jb as fA,__ as fB,f_ as fC,eh as fD,Qb as fE,m_ as fF,va as fG,xp as fH,Wb as fI,Gb as fJ,Ub as fK,Yb as fL,Bn as fM,St as fN,Ab as fO,bb as fP,_b as fQ,vb as fR,kb as fS,e_ as fT,xb as fU,gw as fV,I_ as fW,E_ as fX,T_ as fY,yw as fZ,S_ as f_,Vp as fa,_p as fb,pn as fc,d_ as fd,Tt as fe,F as ff,Rt as fg,sp as fh,ip as fi,s_ as fj,hn as fk,jp as fl,k_ as fm,g_ as fn,Wp as fo,qn as fp,Xp as fq,hp as fr,gp as fs,pp as ft,mp as fu,ap as fv,cp as fw,a_ as fx,r_ as fy,g as fz,cr as g,Aw as g0,mi as h,Sd as i,Mu as j,hi as k,gd as l,yd as m,sd as n,id as o,Xd as p,ue as q,Cl as r,cs as s,Wl as t,di as u,ql as v,Vl as w,li as x,Fl as y,Zl as z};
